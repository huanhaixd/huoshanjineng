
## 火山"视窗项目"系统类库模块: PComm串口访问

### 包: 火山.串口操作.PComm
* **描述:** 本类库封装了 PCOMM 串口操作库

---

#### 火山.串口操作.PComm.PCM波特率

* **类型:** `类`
* **名称:** `PCM波特率`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **文档分类:** `辅助类`
* **描述:** 提供常用波特率值

##### 火山.串口操作.PComm.PCM波特率.B50

* **类型:** `成员常量`
* **名称:** `B50`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B75

* **类型:** `成员常量`
* **名称:** `B75`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B110

* **类型:** `成员常量`
* **名称:** `B110`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B134

* **类型:** `成员常量`
* **名称:** `B134`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B150

* **类型:** `成员常量`
* **名称:** `B150`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B300

* **类型:** `成员常量`
* **名称:** `B300`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B600

* **类型:** `成员常量`
* **名称:** `B600`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B1200

* **类型:** `成员常量`
* **名称:** `B1200`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B1800

* **类型:** `成员常量`
* **名称:** `B1800`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B2400

* **类型:** `成员常量`
* **名称:** `B2400`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B4800

* **类型:** `成员常量`
* **名称:** `B4800`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B7200

* **类型:** `成员常量`
* **名称:** `B7200`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B9600

* **类型:** `成员常量`
* **名称:** `B9600`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B19200

* **类型:** `成员常量`
* **名称:** `B19200`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B38400

* **类型:** `成员常量`
* **名称:** `B38400`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B57600

* **类型:** `成员常量`
* **名称:** `B57600`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B115200

* **类型:** `成员常量`
* **名称:** `B115200`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B230400

* **类型:** `成员常量`
* **名称:** `B230400`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B460800

* **类型:** `成员常量`
* **名称:** `B460800`
* **数据类型:** `PCM波特率`

##### 火山.串口操作.PComm.PCM波特率.B921600

* **类型:** `成员常量`
* **名称:** `B921600`
* **数据类型:** `PCM波特率`

---

#### 火山.串口操作.PComm.PCM数据位数

* **类型:** `类`
* **名称:** `PCM数据位数`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **文档分类:** `辅助类`
* **描述:** 提供数据位的数目

##### 火山.串口操作.PComm.PCM数据位数.五位

* **类型:** `成员常量`
* **名称:** `五位`
* **数据类型:** `PCM数据位数`

##### 火山.串口操作.PComm.PCM数据位数.六位

* **类型:** `成员常量`
* **名称:** `六位`
* **数据类型:** `PCM数据位数`

##### 火山.串口操作.PComm.PCM数据位数.七位

* **类型:** `成员常量`
* **名称:** `七位`
* **数据类型:** `PCM数据位数`

##### 火山.串口操作.PComm.PCM数据位数.八位

* **类型:** `成员常量`
* **名称:** `八位`
* **数据类型:** `PCM数据位数`

---

#### 火山.串口操作.PComm.PCM停止位数

* **类型:** `类`
* **名称:** `PCM停止位数`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **文档分类:** `辅助类`
* **描述:** 提供停止位的数目

##### 火山.串口操作.PComm.PCM停止位数.一位

* **类型:** `成员常量`
* **名称:** `一位`
* **数据类型:** `PCM停止位数`

##### 火山.串口操作.PComm.PCM停止位数.两位

* **类型:** `成员常量`
* **名称:** `两位`
* **数据类型:** `PCM停止位数`

---

#### 火山.串口操作.PComm.PCM奇偶校验

* **类型:** `类`
* **名称:** `PCM奇偶校验`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **文档分类:** `辅助类`
* **描述:** 提供奇偶校验方式

##### 火山.串口操作.PComm.PCM奇偶校验.无

* **类型:** `成员常量`
* **名称:** `无`
* **数据类型:** `PCM奇偶校验`

##### 火山.串口操作.PComm.PCM奇偶校验.偶校验

* **类型:** `成员常量`
* **名称:** `偶校验`
* **数据类型:** `PCM奇偶校验`

##### 火山.串口操作.PComm.PCM奇偶校验.奇校验

* **类型:** `成员常量`
* **名称:** `奇校验`
* **数据类型:** `PCM奇偶校验`

##### 火山.串口操作.PComm.PCM奇偶校验.空白校验

* **类型:** `成员常量`
* **名称:** `空白校验`
* **数据类型:** `PCM奇偶校验`

##### 火山.串口操作.PComm.PCM奇偶校验.标记校验

* **类型:** `成员常量`
* **名称:** `标记校验`
* **数据类型:** `PCM奇偶校验`

---

#### 火山.串口操作.PComm.PCM线路状态

* **类型:** `类`
* **名称:** `PCM线路状态`
* **文档分类:** `辅助类`
* **描述:** 提供调制解调器的线路状态

##### 火山.串口操作.PComm.PCM线路状态.CTS

* **类型:** `成员常量`
* **名称:** `CTS`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM线路状态.DSR

* **类型:** `成员常量`
* **名称:** `DSR`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM线路状态.RI

* **类型:** `成员常量`
* **名称:** `RI`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM线路状态.CD

* **类型:** `成员常量`
* **名称:** `CD`
* **数据类型:** `整数`

---

#### 火山.串口操作.PComm.PCM流控制

* **类型:** `类`
* **名称:** `PCM流控制`
* **文档分类:** `辅助类`

##### 火山.串口操作.PComm.PCM流控制.TX硬件

* **类型:** `成员常量`
* **名称:** `TX硬件`
* **数据类型:** `整数`
* **初始值:** `1`
* **描述:** Tx硬件流控制模式(CTS)

##### 火山.串口操作.PComm.PCM流控制.RX硬件

* **类型:** `成员常量`
* **名称:** `RX硬件`
* **数据类型:** `整数`
* **初始值:** `2`
* **描述:** Rx硬件流控制模式(RTS)

##### 火山.串口操作.PComm.PCM流控制.TX软件

* **类型:** `成员常量`
* **名称:** `TX软件`
* **数据类型:** `整数`
* **初始值:** `4`
* **描述:** Tx软件流控制模式(Xon/Xoff)

##### 火山.串口操作.PComm.PCM流控制.RX软件

* **类型:** `成员常量`
* **名称:** `RX软件`
* **数据类型:** `整数`
* **初始值:** `8`
* **描述:** Rx软件流控制模式(Xon/Xoff)

---

#### 火山.串口操作.PComm.PCM结果码

* **类型:** `类`
* **名称:** `PCM结果码`
* **文档分类:** `辅助类`
* **描述:** 提供操作的结果码. "PCM结果码.成功"值等于0,其它所有结果码值均小于0.

##### 火山.串口操作.PComm.PCM结果码.成功

* **类型:** `成员常量`
* **名称:** `成功`
* **数据类型:** `整数`
* **描述:** 本常量值等于0

##### 火山.串口操作.PComm.PCM结果码.失败

* **类型:** `成员常量`
* **名称:** `失败`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM结果码.无效端口

* **类型:** `成员常量`
* **名称:** `无效端口`
* **数据类型:** `整数`
* **描述:** 所指定端口不存在或尚未打开

##### 火山.串口操作.PComm.PCM结果码.控制失败

* **类型:** `成员常量`
* **名称:** `控制失败`
* **数据类型:** `整数`
* **描述:** 不能控制端口(不是 MOXA 兼容的智能端口)

##### 火山.串口操作.PComm.PCM结果码.无数据

* **类型:** `成员常量`
* **名称:** `无数据`
* **数据类型:** `整数`
* **描述:** 读入时无数据或写出时无缓冲区

##### 火山.串口操作.PComm.PCM结果码.打开失败

* **类型:** `成员常量`
* **名称:** `打开失败`
* **数据类型:** `整数`
* **描述:** 所指定端口不存在或该端口已经被其它程序打开

##### 火山.串口操作.PComm.PCM结果码.无法设置RTS

* **类型:** `成员常量`
* **名称:** `无法设置RTS`
* **数据类型:** `整数`
* **描述:** 由于调用"流控制"方法设置了H/W自动流控制而导致RTS无法被设置

##### 火山.串口操作.PComm.PCM结果码.无效参数

* **类型:** `成员常量`
* **名称:** `无效参数`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM结果码.视窗错误

* **类型:** `成员常量`
* **名称:** `视窗错误`
* **数据类型:** `整数`
* **描述:** 调用视窗函数时出错,调用"取最后错误"全局方法以获得具体错误值.

##### 火山.串口操作.PComm.PCM结果码.端口不支持

* **类型:** `成员常量`
* **名称:** `端口不支持`
* **数据类型:** `整数`
* **描述:** 当前COM端口不支持本方法调用

##### 火山.串口操作.PComm.PCM结果码.写中止

* **类型:** `成员常量`
* **名称:** `写中止`
* **数据类型:** `整数`
* **描述:** 阻塞性写操作被用户在另一线程中的"中止写"方法调用强制中止

##### 火山.串口操作.PComm.PCM结果码.写超时

* **类型:** `成员常量`
* **名称:** `写超时`
* **数据类型:** `整数`
* **描述:** 写操作超时

##### 火山.串口操作.PComm.PCM结果码.是否成功

* **类型:** `方法`
* **名称:** `是否成功`
* **返回值数据类型:** `逻辑型`
* **参数:**
	* `结果码值` (`整数`)
* **特性:**
	* `静态`
* **描述:** 返回所指定的结果码值是否为成功操作结果码

---

#### 火山.串口操作.PComm.PCM传输结果码

* **类型:** `类`
* **名称:** `PCM传输结果码`
* **文档分类:** `辅助类`
* **描述:** 提供基于X/Y/Zmodem等协议进行文件传输操作时的结果码. "PCM传输结果码.成功"值等于0,其它所有结果码值均小于0.

##### 火山.串口操作.PComm.PCM传输结果码.成功

* **类型:** `成员常量`
* **名称:** `成功`
* **数据类型:** `整数`
* **描述:** 本常量值等于0

##### 火山.串口操作.PComm.PCM传输结果码.无效端口

* **类型:** `成员常量`
* **名称:** `无效端口`
* **数据类型:** `整数`
* **描述:** 所指定端口不存在或尚未打开

##### 火山.串口操作.PComm.PCM传输结果码.超时

* **类型:** `成员常量`
* **名称:** `超时`
* **数据类型:** `整数`

##### 火山.串口操作.PComm.PCM传输结果码.中止

* **类型:** `成员常量`
* **名称:** `中止`
* **数据类型:** `整数`
* **描述:** 用户强行中止

##### 火山.串口操作.PComm.PCM传输结果码.函数中止

* **类型:** `成员常量`
* **名称:** `函数中止`
* **数据类型:** `整数`
* **描述:** 进度处理函数返回中止传输

##### 火山.串口操作.PComm.PCM传输结果码.打开文件失败

* **类型:** `成员常量`
* **名称:** `打开文件失败`
* **数据类型:** `整数`
* **描述:** 打开文件进行读/写失败

##### 火山.串口操作.PComm.PCM传输结果码.CAN中止

* **类型:** `成员常量`
* **名称:** `CAN中止`
* **数据类型:** `整数`
* **描述:** Ymodem协议的CAN信号中止

##### 火山.串口操作.PComm.PCM传输结果码.协议出错

* **类型:** `成员常量`
* **名称:** `协议出错`
* **数据类型:** `整数`
* **描述:** 协议检查出错导致中止

##### 火山.串口操作.PComm.PCM传输结果码.跳过

* **类型:** `成员常量`
* **名称:** `跳过`
* **数据类型:** `整数`
* **描述:** Zmodem协议远程跳过了本次文件发送

##### 火山.串口操作.PComm.PCM传输结果码.缓冲区过小

* **类型:** `成员常量`
* **名称:** `缓冲区过小`
* **数据类型:** `整数`
* **描述:** Zmodem接收缓冲区尺寸小于 2K 字节

##### 火山.串口操作.PComm.PCM传输结果码.视窗错误

* **类型:** `成员常量`
* **名称:** `视窗错误`
* **数据类型:** `整数`
* **描述:** 调用视窗函数时出错

##### 火山.串口操作.PComm.PCM传输结果码.端口不支持

* **类型:** `成员常量`
* **名称:** `端口不支持`
* **数据类型:** `整数`
* **描述:** 当前COM端口不支持本方法调用

##### 火山.串口操作.PComm.PCM传输结果码.无效参数

* **类型:** `成员常量`
* **名称:** `无效参数`
* **数据类型:** `整数`
* **初始值:** `-1000`

##### 火山.串口操作.PComm.PCM传输结果码.是否成功

* **类型:** `方法`
* **名称:** `是否成功`
* **返回值数据类型:** `逻辑型`
* **参数:**
	* `结果码值` (`整数`)
* **特性:**
	* `静态`
* **描述:** 返回所指定的结果码值是否为成功操作结果码

---

#### 火山.串口操作.PComm.PCM文件传输协议

* **类型:** `类`
* **名称:** `PCM文件传输协议`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **文档分类:** `辅助类`
* **描述:** 提供基于文件进行串口数据传输时的相关协议类型

##### 火山.串口操作.PComm.PCM文件传输协议.ASCII

* **类型:** `成员常量`
* **名称:** `ASCII`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `1`
* **描述:** ASCII协议

##### 火山.串口操作.PComm.PCM文件传输协议.XmodemCheckSum

* **类型:** `成员常量`
* **名称:** `XmodemCheckSum`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `2`
* **描述:** 使用"校验和"算法对所传输数据进行完整性校验的Xmodem协议

##### 火山.串口操作.PComm.PCM文件传输协议.XmodemCRC

* **类型:** `成员常量`
* **名称:** `XmodemCRC`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `3`
* **描述:** 使用"16位循环冗余码(crc)"算法对所传输数据进行完整性校验的Xmodem协议

##### 火山.串口操作.PComm.PCM文件传输协议.Xmodem1KCRC

* **类型:** `成员常量`
* **名称:** `Xmodem1KCRC`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `4`
* **描述:** 基于 1 KB 数据块尺寸,使用"16位循环冗余码(crc)"算法对所传输数据进行完整性校验的Xmodem协议

##### 火山.串口操作.PComm.PCM文件传输协议.Ymodem

* **类型:** `成员常量`
* **名称:** `Ymodem`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `5`
* **描述:** Ymodem协议

##### 火山.串口操作.PComm.PCM文件传输协议.Zmodem

* **类型:** `成员常量`
* **名称:** `Zmodem`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `6`
* **描述:** Zmodem协议

##### 火山.串口操作.PComm.PCM文件传输协议.Kermit

* **类型:** `成员常量`
* **名称:** `Kermit`
* **数据类型:** `PCM文件传输协议`
* **初始值:** `7`
* **描述:** Kermit协议

---

#### 火山.串口操作.PComm.PCM串口类

* **类型:** `类`
* **名称:** `PCM串口类`
* **描述:** 本类封装了 PCOMM 串口操作库功能. PCOMM 串口操作库为 moxa 公司开发的一款工业级通用串口通讯支持库. 注意: 由于版权限制,本封装类库无法直接携带 PCOMM 库,请按如下步骤进行操作: 1. 到 https://cdn-cms.azureedge.net/getmedia/188a99a0-fff8-4c18-ae0c-90768d10a90f/moxa-pcomm-lite-utility-v1.6.zip(此为其官网链接,可以直接在火山程序编辑窗口中使用"Ctrl+鼠标左键"单击打开)下载 moxa 公司的 pcomm-lite 库; 2. 执行压缩包内的 setup_pcommlite_1.6_12041917.exe 进行安装; 3. 将其安装目录(如果未更改一般为"C:\Program Files\Moxa\PCommLite 1.6")下的 Include 和 Lib 子目录拷贝到本类库文件所处目录的 moxa 子目录下即可,具体为: 火山平台安装根目录下的 plugins\vprj_win\classlib\sys\pcomm\moxa 目录.

##### 火山.串口操作.PComm.PCM串口类.端口

* **类型:** `成员变量`
* **名称:** `端口`
* **数据类型:** `整数`
* **描述:** 提供当前调用"打开"方法成功打开的端口号,如果当前尚未成功打开端口或已经被关闭,则为0.

##### 火山.串口操作.PComm.PCM串口类.打开

* **类型:** `方法`
* **名称:** `打开`
* **返回值数据类型:** `整数`
* **参数:**
	* `所欲打开端口` (`整数`)
* **描述:** 打开所指定COM端口用作数据传送或接收,当端口成功打开后,端口的初始状态如下: 波特率: 38400;  流控制: 无;  数据位数: 8;  DTR状态: 置位;  RTS状态: 置位;  停止位数: 1;  奇偶校验: 无. 在执行本类中的其它方法之前,必须已经成功调用本方法打开端口.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.端口是否已打开

* **类型:** `方法`
* **名称:** `端口是否已打开`
* **返回值数据类型:** `逻辑型`
* **描述:** 返回当前是否已经打开了端口

##### 火山.串口操作.PComm.PCM串口类.关闭

* **类型:** `方法`
* **名称:** `关闭`
* **返回值数据类型:** `整数`
* **描述:** 关闭所已经打开的端口. 注意: 当执行本方法时,所实际执行的关闭操作依据以下情况决定: 1. 如果当前输出缓冲区内没有剩余等待发送的数据,端口立即被实际关闭; 2. 如果当前输出缓冲区内还有等待发送的数据,本方法将最多等待 3 秒钟以让该数据发送完毕, 3 秒钟之后清空输出缓冲区然后将端口实际关闭.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.打开失败", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置传输控制模式

* **类型:** `方法`
* **名称:** `置传输控制模式`
* **返回值数据类型:** `整数`
* **参数:**
	* `波特率` (`PCM波特率`)
	* `数据位` (`PCM数据位数`)
	* `停止位` (`PCM停止位数`)
	* `奇偶校验` (`PCM奇偶校验`)
* **描述:** 配置通讯传输时使用的相关控制模式
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置流控制模式

* **类型:** `方法`
* **名称:** `置流控制模式`
* **返回值数据类型:** `整数`
* **参数:**
	* `所欲设置模式` (`整数`): 为"PCM流控制"类中的各整数常量的组合值(使用"或"操作符组合)
* **描述:** 设置流控制为硬件或软件模式
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.清空

* **类型:** `方法`
* **名称:** `清空`
* **返回值数据类型:** `整数`
* **参数:**
	* `清空输入缓冲区` (`逻辑型`): 指定是否清空数据输入缓冲区
	* `清空输出缓冲区` (`逻辑型`): 指定是否清空数据输出缓冲区
* **描述:** 清空设备输入/输出缓冲区中的所有数据
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置DTR状态

* **类型:** `方法`
* **名称:** `置DTR状态`
* **返回值数据类型:** `整数`
* **参数:**
	* `是否置位` (`逻辑型`): 为真开启DTR状态,为假关闭DTR状态.
* **描述:** 设置COM端口的DTR状态
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置RTS状态

* **类型:** `方法`
* **名称:** `置RTS状态`
* **返回值数据类型:** `整数`
* **参数:**
	* `是否置位` (`逻辑型`): 为真开启RTS状态,为假关闭RTS状态.
* **描述:** 设置COM端口的RTS状态
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.无法设置RTS", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置DTR和RTS状态

* **类型:** `方法`
* **名称:** `置DTR和RTS状态`
* **返回值数据类型:** `整数`
* **参数:**
	* `置位DTR` (`逻辑型`): 为真开启DTR状态,为假关闭DTR状态.
	* `置位RTS` (`逻辑型`): 为真开启RTS状态,为假关闭RTS状态.
* **描述:** 同时设置COM端口的DTR和RTS状态
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.无法设置RTS", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置波特率

* **类型:** `方法`
* **名称:** `置波特率`
* **返回值数据类型:** `整数`
* **参数:**
	* `实际波特率` (`整数`): 提供所实际使用的波特率,譬如 200, 1200, 9600, 19200 等等.
* **描述:** 设置所实际使用的波特率
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.读字符

* **类型:** `方法`
* **名称:** `读字符`
* **返回值数据类型:** `整数`
* **描述:** 从设备输入缓冲区中读入并返回一个字符. "置读超时时间"方法能够用来设置本方法的最大读入超时等待时间,"中止读"方法可以用来中止本方法的一直等待读入状态.
* **返回值描述:** 成功返回所读入的 0 到 255 之间的一个字符值,如果当前尚无可读入数据返回"PCM结果码.无数据". 失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.读数据

* **类型:** `方法`
* **名称:** `读数据`
* **返回值数据类型:** `整数`
* **参数:**
	* `欲读入数据尺寸` (`整数`): 提供所欲读入的数据尺寸,必须大于等于0.
	* `结果数据` (`字节集类`): 用作保存所读入的数据
* **描述:** 从设备输入缓冲区中读入并返回一段数据. "置读超时时间"方法能够用来设置本方法的最大读入超时等待时间,"中止读"方法可以用来中止本方法的一直等待读入状态.
* **返回值描述:** 成功返回大于等于0的实际读入数据尺寸(等于"结果数据"参数中所返回数据的尺寸),失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.读多字节文本

* **类型:** `方法`
* **名称:** `读多字节文本`
* **返回值数据类型:** `文本型`
* **参数:**
	* `欲读入数据尺寸` (`整数`): 提供所欲读入的数据尺寸(如果欲读入文本内容均为ASCII字符,则等于欲读入文本的长度),必须大于等于0.
* **描述:** 从设备输入缓冲区中读入并返回一段多字节编码的文本. "置读超时时间"方法能够用来设置本方法的最大读入超时等待时间,"中止读"方法可以用来中止本方法的一直等待读入状态.
* **返回值描述:** 成功返回所读入的文本内容,失败返回空文本(注意正常情况下也可能返回空文本).

##### 火山.串口操作.PComm.PCM串口类.置读超时时间

* **类型:** `方法`
* **名称:** `置读超时时间`
* **返回值数据类型:** `整数`
* **参数:**
	* `总共超时时间` (`整数`, 默认值: `-1`): 单位毫秒,为-1表示不等待. 如果未调用本方法设置,系统默认值为-1.
	* `区间超时时间` (`整数`, 默认值: `0`): 单位毫秒. 如果未调用本方法设置,系统默认值为0.
* **描述:** 设置"读字符"/"读数据"/"读多字节文本"方法的超时等待时间. "总共超时时间"与"区间超时时间"参数设置值对读操作的共同影响表如下: --------------+--------------+-------------------------------------------------------------------- 总共超时时间 | 区间超时时间 |  效果--------------+--------------+-------------------------------------------------------------------- -1 (默认值) |  被忽略      |  读操作立即返回 > 0         |  0 (默认值)  |  所有读操作最大等待"总共超时时间"参数所指定时间值 0           |  > 0         |  读下一个字符时最大等待"区间超时时间"参数所指定时间值 > 0         |  > 0         |  所有读操作最大等待"总共超时时间"或"区间超时时间"参数(取较小值)所指定时间值 0           |  0           |  所有读操作一直阻塞等待,直到指定尺寸的数据读入完毕.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取读超时时间

* **类型:** `方法`
* **名称:** `取读超时时间`
* **返回值数据类型:** `整数`
* **参数:**
	* `总共超时时间` (`整数类`): 用作填写所返回的总共超时时间
	* `区间超时时间` (`整数类`): 用作填写所返回的区间超时时间
* **描述:** 返回通过"置读超时时间"方法所设置的读操作超时等待时间
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口"

##### 火山.串口操作.PComm.PCM串口类.中止读

* **类型:** `方法`
* **名称:** `中止读`
* **返回值数据类型:** `整数`
* **描述:** 强行中止正在阻塞等待读入数据的"读字符"和"读数据"方法调用. 本方法应该在串口读数据线程的另外一个线程中调用.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.读到中止符

* **类型:** `方法`
* **名称:** `读到中止符`
* **返回值数据类型:** `整数`
* **参数:**
	* `欲读入数据尺寸` (`整数`): 提供所欲读入的数据尺寸,必须大于等于0.
	* `中止字符` (`整数`): 提供具体的中止字符
	* `结果数据` (`字节集类`): 用作保存所读入的数据
* **描述:** 从设备输入缓冲区中读入数据. 注意: 1. 本方法只能在 MOXA 多串口主板上使用,不能在标准的 PC COM1/2 串口上使用; 2. 本方法不受"置读超时时间"方法所置入的超时等待时间的影响; 3. 如果设备输入缓冲区中的已有数据尺寸大于等于调用本方法时所指定的欲读入数据尺寸,本方法将一直读入数据直到中途遇到了所指定的中止字符或所指定尺寸的数据读入完毕; 4. 如果设备输入缓冲区中的已有数据尺寸小于调用本方法时所指定的欲读入数据尺寸且其中存在所指定的中止字符,本方法将一直读入到中止字符处; 5. 如果设备输入缓冲区中的已有数据尺寸小于调用本方法时所指定的欲读入数据尺寸且其中不存在所指定的中止字符,本方法将立即返回0不读入任何数据.
* **返回值描述:** 成功返回大于等于0的已读入数据尺寸(等于"结果数据"参数中所返回数据的尺寸),失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数","PCM结果码.视窗错误", "PCM结果码.端口不支持".

##### 火山.串口操作.PComm.PCM串口类.写字符

* **类型:** `方法`
* **名称:** `写字符`
* **返回值数据类型:** `整数`
* **参数:**
	* `所欲写出字符` (`整数`): 提供所欲写出的字符值,必须大于等于0小于等于255.
* **描述:** 写出一个字符到设备输出缓冲区. "置写超时时间"方法能够用来设置本方法的最大写出超时等待时间,"中止写"方法可以用来中止本方法的一直等待写出状态.
* **返回值描述:** 成功返回大于等于0的实际写出数据尺寸,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.写中止", "PCM结果码.写超时".

##### 火山.串口操作.PComm.PCM串口类.写数据

* **类型:** `方法`
* **名称:** `写数据`
* **返回值数据类型:** `整数`
* **参数:**
	* `待写出数据` (`字节集类`)
* **描述:** 写出所指定的数据到设备输出缓冲区,所实际写出数据的尺寸依赖当前设备输出缓冲区的空闲空间尺寸. "置写超时时间"方法能够用来设置本方法的最大写出超时等待时间,"中止写"方法可以用来中止本方法的一直等待写出状态.
* **返回值描述:** 成功返回大于等于0的实际写出数据尺寸,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.写中止", "PCM结果码.写超时".

##### 火山.串口操作.PComm.PCM串口类.写多字节文本

* **类型:** `方法`
* **名称:** `写多字节文本`
* **返回值数据类型:** `整数`
* **参数:**
	* `待写出文本` (`文本型`)
* **描述:** 将所指定的文本内容转换为多字节编码格式后写出到设备输出缓冲区,所实际写出数据的尺寸依赖当前设备输出缓冲区的空闲空间尺寸. "置写超时时间"方法能够用来设置本方法的最大写出超时等待时间,"中止写"方法可以用来中止本方法的一直等待写出状态.
* **返回值描述:** 成功返回大于等于0的实际写出数据尺寸,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.写中止", "PCM结果码.写超时".

##### 火山.串口操作.PComm.PCM串口类.置写超时时间

* **类型:** `方法`
* **名称:** `置写超时时间`
* **返回值数据类型:** `整数`
* **参数:**
	* `总共超时时间` (`整数`, 默认值: `0`): 单位毫秒. 参数值意义如下: -1: 不等待立即返回(注意Windows95/98不支持本值); 大于0: 最多等待所指定的时间来写出数据,如果超出所指定时间"写字符"和"写数据"方法将返回"PCM结果码.写超时"; 0(未设置时的默认值): 一直阻塞等待,直到指定尺寸的数据写出完毕.
* **描述:** 设置"写字符"/"写数据"/"写多字节文本"方法的超时等待时间
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取写超时时间

* **类型:** `方法`
* **名称:** `取写超时时间`
* **返回值数据类型:** `整数`
* **参数:**
	* `总共超时时间` (`整数类`): 用作填写所返回的总共超时时间
* **描述:** 返回通过"置写超时时间"方法所设置的写操作超时等待时间
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口"

##### 火山.串口操作.PComm.PCM串口类.中止写

* **类型:** `方法`
* **名称:** `中止写`
* **返回值数据类型:** `整数`
* **描述:** 强行中止正在阻塞等待写出数据的"写字符"和"写数据"方法调用. 本方法应该在串口写数据线程的另外一个线程中调用,调用本方法将导致正被阻塞的"写字符"和"写数据"方法调用立即退出并返回"PCM结果码.写中止".
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.写数据2

* **类型:** `方法`
* **名称:** `写数据2`
* **返回值数据类型:** `整数`
* **参数:**
	* `待写出数据` (`字节集类`)
	* `等待时间` (`整数`): 指定传输完毕后的等待时间,注意单位为"滴答"(1"滴答"等于55毫秒).
* **描述:** 写出一段数据,需要 RS-485 双线传输 RTS 控制设备的支持. 具体操作步骤如下: 1. 开启 RTS 状态; 2. 将欲写出数据置入传输缓冲区并等待其输出完毕; 3. 数据输出完毕后等待所指定的时间(由"需等待时间"参数指定); 4. 返回.
* **返回值描述:** 成功返回大于等于0的实际写出数据尺寸,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.写中止", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.写数据3

* **类型:** `方法`
* **名称:** `写数据3`
* **返回值数据类型:** `整数`
* **参数:**
	* `待写出数据` (`字节集类`)
	* `等待时间` (`整数`): 指定传输完毕后的等待时间,单位毫秒.
* **描述:** 写出一段数据到 Tx 缓冲区. 本方法将首先开启 RTS 状态,然后将数据置入 Tx 缓冲区,然后关闭 RTS 状态. 本方法与"写数据X"相同,不同之处在于"等待时间"的单位是毫秒.
* **返回值描述:** 成功返回大于等于0的实际写出数据尺寸,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.写中止", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取线路状态

* **类型:** `方法`
* **名称:** `取线路状态`
* **返回值数据类型:** `整数`
* **描述:** 返回当前线路状态. 将所返回的状态值与"PCM线路状态"类中的各常量值进行"位与"操作即可得知对应线路状态的置位情况.
* **返回值描述:** 成功返回大于等于0的当前线路状态值,失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取已输入数据尺寸

* **类型:** `方法`
* **名称:** `取已输入数据尺寸`
* **返回值数据类型:** `整数`
* **描述:** 返回输入缓冲区中当前已累积尚未读取的数据尺寸. 注意: 1. 如果本方法返回0,也有可能有几个字节的输入数据被保存在 FIFO 接收缓冲区的 UART 通用异步收发器里面; 2. 本方法将在内部调用Windows API函数"ClearCommError",从而导致串口的数据出错状态被清除. 如果想获得此出错状态,推荐在调用本方法首先调用"取数据接收错误状态"方法获取.
* **返回值描述:** 成功返回大于等于0的已有数据尺寸值(单位字节),失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取待输出数据尺寸

* **类型:** `方法`
* **名称:** `取待输出数据尺寸`
* **返回值数据类型:** `整数`
* **描述:** 返回输出缓冲区中尚未发送的剩余数据尺寸. 注意: 1. 如果本方法返回0,也有可能有几个字节的输出数据被保存在 FIFO 传输缓冲区的 UART 通用异步收发器里面; 2. 本方法将在内部调用Windows API函数"ClearCommError",从而导致串口的数据出错状态被清除. 如果想获得此出错状态,推荐在调用本方法前首先调用"取数据接收错误状态"方法获取.
* **返回值描述:** 成功返回大于等于0的已有数据尺寸值(单位字节),失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取数据无法传输原因

* **类型:** `方法`
* **名称:** `取数据无法传输原因`
* **返回值数据类型:** `整数`
* **描述:** 检查并获取导致数据不能传输的原因. 注意: 本方法将在内部调用Windows API函数"ClearCommError",从而导致串口的数据出错状态被清除. 如果想获得此出错状态,推荐在调用本方法首先调用"取数据接收错误状态"方法获取.
* **返回值描述:** 成功返回大于等于0的具体原因位(bit)组合值: 位 0 / "位与 (本方法返回值, 1)": CTS 状态为低; 位 1 / "位与 (本方法返回值, 2)": 接收到了 XOFF 字符. 可以使用"位与"操作符来判断对应位的状态. 失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.取波特率

* **类型:** `方法`
* **名称:** `取波特率`
* **返回值数据类型:** `整数`
* **描述:** 返回串口所实际使用的波特率值
* **返回值描述:** 成功返回大于0的具体波特率值,失败返回小于0的以下结果码之一: "PCM结果码.无效端口"

##### 火山.串口操作.PComm.PCM串口类.取传输控制模式

* **类型:** `方法`
* **名称:** `取传输控制模式`
* **返回值数据类型:** `整数`
* **描述:** 返回串口的当前传输控制模式
* **返回值描述:** 成功返回大于等于0的模式位组合值,通过以下操作可以获得具体各类模式值: 1. "位与 (本方法返回值, 3)": "PCM数据位数"类中的各常量值; 2. "位与 (本方法返回值, 4)": "PCM停止位数"类中的各常量值; 3. "位与 (本方法返回值, 56)": "PCM奇偶校验"类中的各常量值. 失败返回小于0的以下结果码之一: "PCM结果码.无效端口"

##### 火山.串口操作.PComm.PCM串口类.取流控制模式

* **类型:** `方法`
* **名称:** `取流控制模式`
* **返回值数据类型:** `整数`
* **描述:** 返回串口的当前硬件/软件流控制模式
* **返回值描述:** 成功返回大于等于0的模式位组合值,通过与"PCM流控制"类中的各个常量值进行"位与"操作即可获取具体的流控制状态. 失败返回小于0的以下结果码之一: "PCM结果码.无效端口"

##### 火山.串口操作.PComm.PCM串口类.取数据接收错误状态

* **类型:** `方法`
* **名称:** `取数据接收错误状态`
* **返回值数据类型:** `整数`
* **描述:** 检查并返回接收数据时的错误状态.
* **返回值描述:** 成功返回大于等于0的具体错误状态位(bit)组合值,等于0表示无错误. 具体各位对应的错误信息如下: 位 0 / "位与 (本方法返回值, 1)": 奇偶校验出错; 位 1 / "位与 (本方法返回值, 2)": 帧误差; 位 2 / "位与 (本方法返回值, 4)": 超限(overrun); 位 3 / "位与 (本方法返回值, 8)": 溢出(overflow). 可以使用"位与"操作符来判断对应位的状态. 失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.事件处理模板方法

* **类型:** `方法`
* **名称:** `事件处理模板方法`
* **参数:**
	* `端口号` (`整数`): 提供触发所监听事件的具体端口号
* **特性:**
	* `静态`
* **描述:** 提供所监听串口事件触发后被调用静态方法的模板

##### 火山.串口操作.PComm.PCM串口类.开始监听中止字符到达

* **类型:** `方法`
* **名称:** `开始监听中止字符到达`
* **返回值数据类型:** `整数`
* **参数:**
	* `中止字符` (`整数`): 提供所欲监听其是否到达的中止字符,当接收到该中止字符后,将自动调用"处理方法"参数提供的静态方法.
	* `处理方法` (`事件处理模板方法(指定格式方法)`): 提供当接收到中止字符后被自动调用的静态方法.多个端口可以使用同一个静态方法,因为触发处理方法时提供了具体的端口号.
* **描述:** 开始对所指定中止字符到达进行监听. 当输入缓冲区中接收到该中止字符后,所指定的处理方法被自动调用. 注意: 1. 在Windows系统下,事件(通常由中断引起)在每次中断发生时将设置一个事件标志,并调用事件处理程序.如果使用这种处理机制,系统负载将很重,因为经常会触发几个连续的中断. 当前处理方式是为这些中断设置相同的事件标志,从而一系列连续事件只会被处理一次; 2. 由于上述事件处理方案的不确定性,所指定的处理方法可能不会在中断发生的第一时间被精确调用; 3. 在调用处理方法的时候,不存在重入问题.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.停止监听中止字符到达

* **类型:** `方法`
* **名称:** `停止监听中止字符到达`
* **返回值数据类型:** `整数`
* **描述:** 停止先前调用"开始监听中止字符到达"启动的中止字符到达监听
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.开始监听数据到达

* **类型:** `方法`
* **名称:** `开始监听数据到达`
* **返回值数据类型:** `整数`
* **参数:**
	* `处理方法` (`事件处理模板方法(指定格式方法)`): 提供当输入缓冲区中到达一个字符后被自动调用的静态方法.多个端口可以使用同一个静态方法,因为触发处理方法时提供了具体的端口号.
* **描述:** 开始对数据到达进行监听. 当输入缓冲区中到达一个字符后,所指定的处理方法被自动调用. 注意: 1. 在Windows系统下,事件(通常由中断引起)在每次中断发生时将设置一个事件标志,并调用事件处理程序.如果使用这种处理机制,系统负载将很重,因为经常会触发几个连续的中断. 当前处理方式是为这些中断设置相同的事件标志,从而一系列连续事件只会被处理一次; 2. 由于上述事件处理方案的不确定性,所指定的处理方法可能不会在中断发生的第一时间被精确调用; 3. 在调用处理方法的时候,不存在重入问题.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.停止监听数据到达

* **类型:** `方法`
* **名称:** `停止监听数据到达`
* **返回值数据类型:** `整数`
* **描述:** 停止先前调用"开始监听数据到达"启动的数据到达监听
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.开始监听线路状态

* **类型:** `方法`
* **名称:** `开始监听线路状态`
* **返回值数据类型:** `整数`
* **参数:**
	* `处理方法` (`事件处理模板方法(指定格式方法)`): 提供当线路状态发生改变后被自动调用的静态方法.多个端口可以使用同一个静态方法,因为触发处理方法时提供了具体的端口号.
* **描述:** 开始对线路状态进行监听. 当线路状态(见"PCM线路状态"类,即: CTS, DSR, CD, RI)发生改变时,所指定的处理方法被自动调用. 注意: 1. 在Windows系统下,事件(通常由中断引起)在每次中断发生时将设置一个事件标志,并调用事件处理程序.如果使用这种处理机制,系统负载将很重,因为经常会触发几个连续的中断. 当前处理方式是为这些中断设置相同的事件标志,从而一系列连续事件只会被处理一次; 2. 由于上述事件处理方案的不确定性,所指定的处理方法可能不会在中断发生的第一时间被精确调用; 3. 在调用处理方法的时候,不存在重入问题.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.停止监听线路状态

* **类型:** `方法`
* **名称:** `停止监听线路状态`
* **返回值数据类型:** `整数`
* **描述:** 停止先前调用"开始监听线路状态"启动的线路状态监听
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.开始监听中断信号

* **类型:** `方法`
* **名称:** `开始监听中断信号`
* **返回值数据类型:** `整数`
* **参数:**
	* `处理方法` (`事件处理模板方法(指定格式方法)`): 提供当接收到中断信号后被自动调用的静态方法.多个端口可以使用同一个静态方法,因为触发处理方法时提供了具体的端口号.
* **描述:** 开始对中断信号进行监听. 当接收到中断信号("BREAK")时,所指定的处理方法被自动调用. 注意: 1. 在Windows系统下,事件(通常由中断引起)在每次中断发生时将设置一个事件标志,并调用事件处理程序.如果使用这种处理机制,系统负载将很重,因为经常会触发几个连续的中断. 当前处理方式是为这些中断设置相同的事件标志,从而一系列连续事件只会被处理一次; 2. 由于上述事件处理方案的不确定性,所指定的处理方法可能不会在中断发生的第一时间被精确调用; 3. 在调用处理方法的时候,不存在重入问题.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.停止监听中断信号

* **类型:** `方法`
* **名称:** `停止监听中断信号`
* **返回值数据类型:** `整数`
* **描述:** 停止先前调用"开始监听中断信号"启动的中断信号监听
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.开始监听数据发送完毕

* **类型:** `方法`
* **名称:** `开始监听数据发送完毕`
* **返回值数据类型:** `整数`
* **参数:**
	* `处理方法` (`事件处理模板方法(指定格式方法)`): 提供当所有数据均已经发送完毕后被自动调用的静态方法.多个端口可以使用同一个静态方法,因为触发处理方法时提供了具体的端口号.
* **描述:** 开始对数据发送完毕进行监听. 当输出缓冲区中的所有内容均已经被发送后(将触发Tx缓冲区已空信号),所指定的处理方法被自动调用. 注意: 1. 在Windows系统下,事件(通常由中断引起)在每次中断发生时将设置一个事件标志,并调用事件处理程序.如果使用这种处理机制,系统负载将很重,因为经常会触发几个连续的中断. 当前处理方式是为这些中断设置相同的事件标志,从而一系列连续事件只会被处理一次; 2. 由于上述事件处理方案的不确定性,所指定的处理方法可能不会在中断发生的第一时间被精确调用; 3. 在调用处理方法的时候,不存在重入问题.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.停止监听数据发送完毕

* **类型:** `方法`
* **名称:** `停止监听数据发送完毕`
* **返回值数据类型:** `整数`
* **描述:** 停止先前调用"开始监听数据发送完毕"启动的数据发送完毕监听
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.传输进度模板方法

* **类型:** `方法`
* **名称:** `传输进度模板方法`
* **返回值数据类型:** `整数`
* **参数:**
	* `已传输数据尺寸` (`整数`): 提供当前已经接收或发送完毕的数据尺寸,单位字节.
	* `保留参数1` (`整数`): 仅在调试时使用
	* `保留参数2` (`变整数`): 仅在调试时使用
	* `全部数据尺寸` (`整数`): 提供需要接收或发送的全部数据尺寸,单位字节.
* **特性:**
	* `静态`
* **描述:** 提供当文件数据接收或发送进度发生改变后被调用静态方法的模板. 本静态方法一般用作给最终用户提供一个友好的传输进度显示界面.
* **返回值描述:** 返回值大于等于0继续传输,小于0立即停止传输,所有文件传输方法将返回"PCM传输结果码.函数中止".

##### 火山.串口操作.PComm.PCM串口类.发送文件

* **类型:** `方法`
* **名称:** `发送文件`
* **返回值数据类型:** `整数`
* **参数:**
	* `所使用协议` (`PCM文件传输协议`): 指定所使用的文件传输协议类型
	* `所欲传输文件名` (`文本型`): 提供所欲传输文件的名称
	* `进度反馈方法` (`传输进度模板方法(指定格式方法)`): 当文件数据发送进度发生改变后,本静态方法被自动调用,一般用作给最终用户提供一个友好的传输进度显示界面. 具体函数解释参见"传输进度模板方法".
* **描述:** 基于所指定的协议传输一个文件数据
* **返回值描述:** 大于等于0表示发送成功,失败返回小于0的以下结果码之一: 1. "PCM传输结果码.无效参数", 所提供协议类型值无效; 2. "PCM传输结果码.无效端口", 所有协议均可能返回; 3. "PCM传输结果码.函数中止", 所有协议均可能返回; 4. "PCM传输结果码.打开文件失败", 所有协议均可能返回; 5. "PCM传输结果码.视窗错误", 所有协议均可能返回; 6. "PCM传输结果码.超时", 以下协议可能返回: ASCII Ymodem Zmodem Xmodem1KCRC XmodemCheckSum XmodemCRC; 7. "PCM传输结果码.CAN中止", 以下协议可能返回: Ymodem Zmodem Xmodem1KCRC XmodemCheckSum XmodemCRC; 8. "PCM传输结果码.协议出错", 以下协议可能返回: Zmodem; 9. "PCM传输结果码.跳过", 以下协议可能返回: Zmodem.

##### 火山.串口操作.PComm.PCM串口类.接收文件

* **类型:** `方法`
* **名称:** `接收文件`
* **返回值数据类型:** `整数`
* **参数:**
	* `所使用协议` (`PCM文件传输协议`): 指定所使用的文件传输协议类型
	* `文件名` (`文本型`): 用作提供和返回所接收到数据存放到的本地文件名. 注意: 所接收到的文件将存放到程序现行目录(可在接收文件前使用"改变目录"全局方法设置)下.
	* `进度反馈方法` (`传输进度模板方法(指定格式方法)`): 当文件数据接收进度发生改变后,本静态方法被自动调用,一般用作给最终用户提供一个友好的传输进度显示界面. 具体函数解释参见"传输进度模板方法".
	* `超时时间` (`整数`, 默认值: `5`): 提供一个具体的接收数据超时时间(单位秒),仅当协议类型为 ASCII 时有效.
* **描述:** 基于所指定的协议接收一个文件数据
* **返回值描述:** 大于等于0表示接收成功(提供所具体接收到文件的数目),失败返回小于0的以下结果码之一: 1. "PCM传输结果码.无效参数", 所提供协议类型值无效; 2. "PCM传输结果码.无效端口", 所有协议均可能返回; 3. "PCM传输结果码.函数中止", 所有协议均可能返回; 4. "PCM传输结果码.打开文件失败", 所有协议均可能返回; 5. "PCM传输结果码.视窗错误", 所有协议均可能返回; 6. "PCM传输结果码.超时", 以下协议可能返回; 7. "PCM传输结果码.CAN中止", 以下协议可能返回: Xmodem1KCRC XmodemCheckSum XmodemCRC.

##### 火山.串口操作.PComm.PCM串口类.接收一批文件

* **类型:** `方法`
* **名称:** `接收一批文件`
* **返回值数据类型:** `整数`
* **参数:**
	* `所使用协议` (`PCM文件传输协议`): 指定所使用的文件传输协议类型. 注意仅支持以下几种协议: Kermit, Ymodem, Zmodem.
	* `最多接收文件数目` (`整数`): 指定最多可以接收文件的数目
	* `所接收到文件名列表` (`文本数组类`): 用作返回所有被接收到文件的本地文件名列表. 注意: 所接收到的文件将存放到程序现行目录(可在接收文件前使用"改变目录"全局方法设置)下.
	* `进度反馈方法` (`传输进度模板方法(指定格式方法)`): 当文件数据接收进度发生改变后,本静态方法被自动调用,一般用作给最终用户提供一个友好的传输进度显示界面. 具体函数解释参见"传输进度模板方法".
* **描述:** 基于所指定的协议接收一批文件数据
* **返回值描述:** 大于等于0表示接收成功(提供所具体接收到文件的数目),失败返回小于0的以下结果码之一: 1. "PCM传输结果码.无效参数", 所提供协议类型值无效或所提供参数值无效; 2. "PCM传输结果码.无效端口", 所有协议均可能返回; 3. "PCM传输结果码.超时", 所有协议均可能返回; 4. "PCM传输结果码.函数中止", 所有协议均可能返回; 5. "PCM传输结果码.打开文件失败", 所有协议均可能返回; 6. "PCM传输结果码.视窗错误", 所有协议均可能返回; 7. "PCM传输结果码.CAN中止", 以下协议可能返回: Ymodem Zmodem; 8. "PCM传输结果码.协议出错", 以下协议可能返回: Zmodem.

##### 火山.串口操作.PComm.PCM串口类.发送中断信号

* **类型:** `方法`
* **名称:** `发送中断信号`
* **返回值数据类型:** `整数`
* **参数:**
	* `等待时间` (`整数`): 指定开始发送中断信号后一直阻塞等待的时间,单位为"滴答"(1"滴答"等于55毫秒).
* **描述:** 发送中断信号并等待所指定时间
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.发送中断信号2

* **类型:** `方法`
* **名称:** `发送中断信号2`
* **返回值数据类型:** `整数`
* **参数:**
	* `等待时间` (`整数`): 指定开始发送中断信号后一直阻塞等待的时间,单位为毫秒.
* **描述:** 发送中断信号并等待所指定时间. 本方法与"发送中断信号"方法唯一的区别是等待时间单位为毫秒.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.无效参数", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.查看数据

* **类型:** `方法`
* **名称:** `查看数据`
* **返回值数据类型:** `整数`
* **参数:**
	* `欲读入数据尺寸` (`整数`): 提供所欲读入的数据尺寸,必须大于等于0.
	* `结果数据` (`字节集类`): 用作保存所读入的数据
* **描述:** 从设备输入缓冲区中查看读入并返回一段数据. 本方法与"读数据"方法的区别在于: 本方法仅仅只查看在输入缓冲区中的数据,而并不将所读入数据从输入缓冲区中删除,该数据将仍旧保存在输入缓冲区中以供下次读入. 注意: 本方法仅当设备为 MOXA 多串口主板时有效.
* **返回值描述:** 成功返回大于等于0的实际读入数据尺寸(等于"结果数据"参数中所返回数据的尺寸),失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.端口不支持", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.置低水平线

* **类型:** `方法`
* **名称:** `置低水平线`
* **返回值数据类型:** `整数`
* **参数:**
	* `低水平线值` (`整数`): 提供设备Tx缓冲区的低水平线值,有效值范围在0到1024字节之间.
* **描述:** 设置设备Tx缓冲区的低水平线阀值,有效值范围在0到1024字节之间. 当缓冲区中的已有数据尺寸小于等于此低水平线阀值时,设备将发送一个"Tx缓冲区空"事件从而触发下一次数据写操作. 注意: 本方法仅当设备为 MOXA 多串口主板时有效.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.控制失败", "PCM结果码.无效参数", "PCM结果码.视窗错误", "PCM结果码.端口不支持".

##### 火山.串口操作.PComm.PCM串口类.伪接收Xon字符

* **类型:** `方法`
* **名称:** `伪接收Xon字符`
* **返回值数据类型:** `整数`
* **描述:** 假装接收到了一个 XON 字符,从而触发相应的传输操作.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".

##### 火山.串口操作.PComm.PCM串口类.伪接收Xoff字符

* **类型:** `方法`
* **名称:** `伪接收Xoff字符`
* **返回值数据类型:** `整数`
* **描述:** 假装接收到了一个 XOFF 字符,从而触发相应的传输操作.
* **返回值描述:** 成功返回"PCM结果码.成功",失败返回小于0的以下结果码之一: "PCM结果码.无效端口", "PCM结果码.视窗错误".
