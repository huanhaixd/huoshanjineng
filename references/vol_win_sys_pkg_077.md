
## 火山"视窗项目"系统类库模块: 电子邮件接收

### 包: 火山.视窗.网络

---

#### 火山.视窗.网络.邮件接收类

* **类型:** `类`
* **名称:** `邮件接收类`
* **描述:** 支持基于pop3协议接收邮件. 电子邮件发送请使用"Curl网络传输"类库中的"邮件发送类".
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.收信服务器

* **类型:** `属性成员变量`
* **名称:** `收信服务器`
* **数据类型:** `文本型`
* **描述:** 提供所使用的POP3服务器地址,如"pop3://pop.qq.com".
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.端口号

* **类型:** `属性成员变量`
* **名称:** `端口号`
* **数据类型:** `整数`
* **初始值:** `110`
* **描述:** 指定欲连接到POP3邮件服务器上的端口号(默认110)
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.用户名

* **类型:** `属性成员变量`
* **名称:** `用户名`
* **数据类型:** `文本型`
* **描述:** 提供登录收信服务器的用户名,如无则为空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.密码

* **类型:** `属性成员变量`
* **名称:** `密码`
* **数据类型:** `文本型`
* **描述:** 提供登录收信服务器的密码,如无则为空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.传输对象

* **类型:** `属性读方法`
* **名称:** `传输对象`
* **返回值数据类型:** `网络传输类`
* **描述:** 提供所使用的网络传输对象,用户可以修改此对象的各种属性值以指定相关网络传输参数.

##### 火山.视窗.网络.邮件接收类.超时时间

* **类型:** `属性写方法`
* **名称:** `超时时间`
* **参数:**
	* `最大允许时间` (`整数`): 单位:毫秒. 小于等于0表示不限制,默认值为0.
* **描述:** 指定向POP3服务器发送完命令并等待其返回数据限定的超时时间
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.服务器响应超时

* **类型:** `属性写方法`
* **名称:** `服务器响应超时`
* **参数:**
	* `最大允许时间` (`整数`): 单位:毫秒. 小于等于0表示未设置,默认值为0.
* **描述:** 设置当发送命令到POP3服务器后等待服务器响应的超时时间. 一般情况下,可以将本属性值设置为小于"超时时间"属性的值.

##### 火山.视窗.网络.邮件接收类.发送命令

* **类型:** `方法`
* **名称:** `发送命令`
* **返回值数据类型:** `整数`
* **参数:**
	* `所欲发送的命令` (`文本型`): 提供所欲发送的命令文本
	* `结果存放文本` (`文本型`, 默认值: `空对象`): 用作存放所发送命令被POP3服务器处理后的结果文本,如果为空对象,则表明不需要结果文本. 注意: 如果所发送命令被邮件服务器处理后没有返回结果文本而此处参数提供的又不是空对象(需要结果文本),则本方法将一直等待所指定的超时时间(由"超时时间"属性指定)才会返回,如果"超时时间"属性值小于等于0(无限等待),则本方法将卡死.
* **描述:** 连接所指定的POP3服务器,发送命令文本并获取其返回结果文本. POP3协议所支持的常用命令如下: STAT      获取邮箱统计资料,如邮件数/邮件总字节数等. (QQ邮件服务器无返回数据) UIDL n    返回用于该指定邮件的唯一标识ID,如果没有指定 n ,返回所有的. (指定 n 时QQ邮件服务器无返回数据) LIST n    返回指定邮件的大小等,如果没有指定 n ,返回所有的. (指定 n 时QQ邮件服务器无返回数据) RETR n    返回邮件的全部内容文本,如果没有指定 n ,返回所有的. (QQ邮件服务器必须指定 n) DELE n    标记删除, 退出与 POP3 服务器连接时才真正删除. (QQ邮件服务器必须指定 n) RSET      撤消所有先前发出的 DELE 命令 (无返回数据,QQ邮件服务器不支持) TOP n m   返回 n 号邮件的前 m 行内容, m 如果为0则仅取出邮件头信息. (不指定 m 时QQ邮件服务器返回邮件全部内容) NOOP      返回一个肯定的响应 (无返回数据)
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).

##### 火山.视窗.网络.邮件接收类.取邮件ID表

* **类型:** `方法`
* **名称:** `取邮件ID表`
* **返回值数据类型:** `整数`
* **参数:**
	* `结果存放文本` (`文本型`): 用作存放所发送命令被POP3服务器处理后的结果文本
* **描述:** 获取POP3服务器上所有邮件的ID列表信息. QQ邮件服务器的返回文本格式范例: 1 ZC0007_C2_N~mGMCDkuY2MADyMvgc9 2 ZC0007_FHDNTNeMBzYuY2MAi9rQic9
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.取邮件信息表

* **类型:** `方法`
* **名称:** `取邮件信息表`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID表` (`整数数组类`): 用作存放所获取到所有邮件的ID值
	* `邮件尺寸表` (`整数数组类`): 用作存放所获取到所有邮件的尺寸,该数组中的成员数目必定与邮件ID表一致.
* **描述:** 获取POP3服务器上所有邮件的列表信息(ID+尺寸). QQ邮件服务器的返回文本格式范例: 1 4263 2 18414
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.取邮件内容

* **类型:** `方法`
* **名称:** `取邮件内容`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID` (`整数`): 提供邮件的ID值,必须位于"取邮件信息表"方法返回的"邮件ID表"数组中.
	* `结果存放文本` (`文本型`): 用作存放所获取到的邮件内容
* **描述:** 获取POP3服务器上指定邮件的全部内容文本
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).

##### 火山.视窗.网络.邮件接收类.取邮件头

* **类型:** `方法`
* **名称:** `取邮件头`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID` (`整数`): 提供邮件的ID值,必须位于"取邮件信息表"方法返回的"邮件ID表"数组中.
	* `结果存放文本` (`文本型`): 用作存放所获取到的邮件头部内容
* **描述:** 获取POP3服务器上指定邮件的头部内容(一般用作快速获取邮件概要信息)
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).

##### 火山.视窗.网络.邮件接收类.取邮件内容并解析

* **类型:** `方法`
* **名称:** `取邮件内容并解析`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID` (`整数`): 提供邮件的ID值,必须位于"取邮件信息表"方法返回的"邮件ID表"数组中.
	* `结果存放对象` (`邮件解析类`): 用作存放所获取并解析到的邮件内容
* **描述:** 获取POP3服务器上指定邮件的全部内容文本并将其进行解析
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.取邮件头并解析

* **类型:** `方法`
* **名称:** `取邮件头并解析`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID` (`整数`): 提供邮件的ID值,必须位于"取邮件信息表"方法返回的"邮件ID表"数组中.
	* `结果存放对象` (`邮件解析类`): 用作存放所获取并解析到的邮件内容
* **描述:** 获取POP3服务器上指定邮件的头部内容(一般用作快速获取邮件概要信息)并将其进行解析
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.删除邮件

* **类型:** `方法`
* **名称:** `删除邮件`
* **返回值数据类型:** `整数`
* **参数:**
	* `邮件ID` (`整数`): 提供邮件的ID值,必须位于"取邮件信息表"方法返回的"邮件ID表"数组中.
* **描述:** 删除POP3服务器上的指定邮件. 注意: 1. 所指定邮件只是被标记删除,真实删除需要等到与POP3服务器断开连接时才会进行,之前如果调用"恢复邮件"可以取消所有先前被标记删除的邮件(QQ邮件服务器不支持恢复); 2. 删除操作对其它命令"邮件ID"参数的正确匹配会有影响,因此本次所有邮件删除操作执行完毕后,请重新执行"取邮件信息表"获取最新的邮件ID值列表,并基于该最新邮件ID值进行后续操作.
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件接收类.恢复邮件

* **类型:** `方法`
* **名称:** `恢复邮件`
* **返回值数据类型:** `整数`
* **描述:** 取消所有先前调用"删除邮件"方法标记删除过的邮件的删除标志,让其恢复正常状态. 注意: QQ邮件服务器不支持本方法.
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).

##### 火山.视窗.网络.邮件接收类.连接检测

* **类型:** `方法`
* **名称:** `连接检测`
* **返回值数据类型:** `整数`
* **描述:** 检测服务器的连接. 除了检测与服务器的连接是否正常,还可以防止客户端长时间未操作导致服务端自动关闭连接,类似于心跳包.
* **返回值描述:** 成功返回0,失败返回非0值(请参考"Curl网络传输"类库中"执行状态码"类内所提供的常量定义).

##### 火山.视窗.网络.邮件接收类.清理

* **类型:** `方法`
* **名称:** `清理`
* **描述:** 为了最大限度地支持资源重用和提高邮件批量接收速度,邮件接收完毕后并不会立即释放相关资源及与POP3服务器断开连接,因此当本批次所有邮件均接收完毕暂时不会再接收邮件时,最好手动调用本方法释放相关资源并通知所连接的POP3服务器断开连接,以避免由于连接空闲太长时间而导致POP3服务器主动超时出错断开. 注意: 1. 本方法调用不是必需的,本类对象被销毁时会自动进行清理; 2. 调用本方法后,所有先前对"传输对象"进行过的属性设置需要重新设置; 3. 所有被指定删除的邮件仅当本方法被调用或本类对象被销毁时才会真正从POP3服务器上被删除.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

---

#### 火山.视窗.网络.邮件解析类

* **类型:** `类`
* **名称:** `邮件解析类`
* **基础类:** `扩展对象类`
* **描述:** 用作支持从POP3服务器中接收到的原始邮件内容中解析出其具体信息
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取展示内容

* **类型:** `方法`
* **名称:** `取展示内容`
* **参数:**
	* `展示内容` (`文本型`): 用作填入本对象中所有数据的展示文本
	* `最大展示数据尺寸` (`整数`): 提供用户所指定的最大允许展示数据尺寸,小于0表示全部展示,等于0表示展示默认尺寸数据.
* **特性:**
	* `虚拟方法`(可在继承类中覆盖)
* **描述:** 将本对象中的所有数据用文本方式填入到所提供的文本参数中,用作调试或其它场合展示时使用.

##### 火山.视窗.网络.邮件解析类.解析

* **类型:** `方法`
* **名称:** `解析`
* **参数:**
	* `邮件原始内容` (`文本型`): 提供所欲解析邮件原始内容(由"邮件接收类"的"取邮件内容"或"取邮件头"方法取得)
* **描述:** 解析所指定邮件原始内容(由"邮件接收类"的"取邮件内容"或"取邮件头"方法取得),然后填写进本对象中.

##### 火山.视窗.网络.邮件解析类.清理

* **类型:** `方法`
* **名称:** `清理`
* **描述:** 清除本对象中的所有已解析内容
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取属性值

* **类型:** `方法`
* **名称:** `取属性值`
* **返回值数据类型:** `文本型`
* **参数:**
	* `属性名称` (`文本型`): 提供所欲查找其属性值的属性名称
* **描述:** 返回所指定名称属性对应的属性值,如不存在则返回空文本.

##### 火山.视窗.网络.邮件解析类.取子属性表

* **类型:** `方法`
* **名称:** `取子属性表`
* **返回值数据类型:** `文本型`
* **参数:**
	* `属性名称` (`文本型`): 提供所欲查找其属性值的属性名称
	* `子属性名数组` (`文本数组类`): 用作存储所获取到的所有子属性名称. 本数组内成员的数目必定与"子属性值数组"中的一致且一一对应.
	* `子属性值数组` (`文本数组类`): 用作存储所获取到的所有子属性值. 本数组内成员的数目必定与"子属性名数组"中的一致且一一对应.
* **描述:** 获取所指定名称属性的主属性值及其中的所有子属性列表. 所指定属性的值必须为以下格式,否则将解析错误: 主属性值[; 子属性名 = 子属性值;] ... 如"Content-type"属性示例: Content-type: multipart/mixed; boundary="####MAIL_PART_BOUNDARY####"其主属性值为"multipart/mixed",具有一个名为"boundary"值为"####MAIL_PART_BOUNDARY####"子属性.
* **返回值描述:** 返回所指定名称属性的主属性值,如所指定属性不存在或无主属性值则返回空文本.

##### 火山.视窗.网络.邮件解析类.取邮件地址表

* **类型:** `方法`
* **名称:** `取邮件地址表`
* **返回值数据类型:** `整数`
* **参数:**
	* `地址属性名` (`文本型`): 应该是类似"from","to","cc"等属性值为邮件地址列表的属性名称
	* `邮件地址数组` (`文本数组类`): 用作存储所获取的所有邮件地址. 本数组内成员的数目必定与"友好名称数组"中的一致且一一对应.
	* `友好名称数组` (`文本数组类`, 默认值: `空对象`): 用作存储所获取的所有邮件地址的友好名称,如某地址无则对应位置成员为空文本. 本数组内成员的数目必定与"邮件地址数组"中的一致且一一对应. 如果参数值为空对象,则表示不需要返回友好名称.
* **描述:** 返回所指定地址属性对应的邮件地址列表
* **返回值描述:** 返回所找到的邮件地址数目(即邮件地址数组和友好名称数组参数数组的成员数)

##### 火山.视窗.网络.邮件解析类.取首邮件地址

* **类型:** `方法`
* **名称:** `取首邮件地址`
* **返回值数据类型:** `文本型`
* **参数:**
	* `地址属性名` (`文本型`): 应该是类似"from","to","cc"等属性值为邮件地址列表的属性名称
	* `友好名称` (`文本型`, 默认值: `空对象`): 如果不为空对象,则在其中返回首邮件地址对应的友好名称(如无则返回空文本).
* **描述:** 返回所指定地址属性对应的邮件地址列表中的首地址,如不存在则返回空文本.

##### 火山.视窗.网络.邮件解析类.取发信人地址

* **类型:** `方法`
* **名称:** `取发信人地址`
* **返回值数据类型:** `文本型`
* **参数:**
	* `友好名称` (`文本型`, 默认值: `空对象`): 如果不为空对象,则在其中返回发信人的友好名称(如无则返回空文本).
* **描述:** 返回邮件发信人的地址,如无则返回空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取回复地址

* **类型:** `方法`
* **名称:** `取回复地址`
* **返回值数据类型:** `文本型`
* **参数:**
	* `友好名称` (`文本型`, 默认值: `空对象`): 如果不为空对象,则在其中返回回复地址对应的友好名称(如无则返回空文本).
* **描述:** 返回邮件的回复地址,如无则返回空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取邮件标题

* **类型:** `方法`
* **名称:** `取邮件标题`
* **返回值数据类型:** `文本型`
* **描述:** 返回邮件标题
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取邮件发送时间

* **类型:** `方法`
* **名称:** `取邮件发送时间`
* **返回值数据类型:** `文本型`
* **描述:** 返回邮件发送时间文本
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取附件数目

* **类型:** `方法`
* **名称:** `取附件数目`
* **返回值数据类型:** `整数`
* **描述:** 返回邮件中附件的数目
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取附件名称

* **类型:** `方法`
* **名称:** `取附件名称`
* **返回值数据类型:** `文本型`
* **参数:**
	* `附件索引` (`整数`): 指定所欲访问的附件,必须大于等于0且小于等于"取附件数目"方法返回值.
* **描述:** 返回所指定索引位置处附件的名称,为空返回空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.取附件文件名

* **类型:** `方法`
* **名称:** `取附件文件名`
* **返回值数据类型:** `文本型`
* **参数:**
	* `附件索引` (`整数`): 指定所欲访问的附件,必须大于等于0且小于等于"取附件数目"方法返回值.
* **描述:** 返回所指定索引位置处附件的文件名称,为空返回空文本.

##### 火山.视窗.网络.邮件解析类.取附件类型

* **类型:** `方法`
* **名称:** `取附件类型`
* **返回值数据类型:** `文本型`
* **参数:**
	* `附件索引` (`整数`): 指定所欲访问的附件,必须大于等于0且小于等于"取附件数目"方法返回值.
* **描述:** 返回所指定索引位置处附件的内容类型(为附件的"Content-Type"主属性值,必定全小写),为空返回空文本.

##### 火山.视窗.网络.邮件解析类.取附件数据

* **类型:** `方法`
* **名称:** `取附件数据`
* **返回值数据类型:** `字节集类`
* **参数:**
	* `附件索引` (`整数`): 指定所欲访问的附件,必须大于等于0且小于等于"取附件数目"方法返回值.
* **描述:** 返回所指定索引位置处附件的数据
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)

##### 火山.视窗.网络.邮件解析类.保存附件

* **类型:** `方法`
* **名称:** `保存附件`
* **返回值数据类型:** `文本型`
* **参数:**
	* `附件索引` (`整数`): 指定所欲访问的附件,必须大于等于0且小于等于"取附件数目"方法返回值.
	* `所保存到目录` (`文本型`): 提供所欲保存到的目录路径,不能为空.
* **描述:** 将所指定索引位置处的附件保存到所指定目录中
* **返回值描述:** 成功返回所保存到的全路径文件名,失败返回空文本.

##### 火山.视窗.网络.邮件解析类.保存所有附件

* **类型:** `方法`
* **名称:** `保存所有附件`
* **返回值数据类型:** `整数`
* **参数:**
	* `所保存到目录` (`文本型`): 提供所欲保存到的目录路径,不能为空.
	* `保存到文件名数组` (`文本数组类`, 默认值: `空对象`): 用作存储所有附件保存到的全路径文件名,为空对象表示不需要.
* **描述:** 将所有附件保存到指定目录中
* **返回值描述:** 返回所成功保存的附件数目(等于"保存到文件名数组"参数数组中返回成员的数目)

##### 火山.视窗.网络.邮件解析类.取正文段数目

* **类型:** `方法`
* **名称:** `取正文段数目`
* **返回值数据类型:** `整数`
* **描述:** 返回邮件中正文段的数目

##### 火山.视窗.网络.邮件解析类.取正文段名称

* **类型:** `方法`
* **名称:** `取正文段名称`
* **返回值数据类型:** `文本型`
* **参数:**
	* `正文段索引` (`整数`): 指定所欲访问的正文段,必须大于等于0且小于等于"取正文段数目"方法返回值.
* **描述:** 返回所指定索引位置处正文段的名称,为空返回空文本.

##### 火山.视窗.网络.邮件解析类.取正文段类型

* **类型:** `方法`
* **名称:** `取正文段类型`
* **返回值数据类型:** `文本型`
* **参数:**
	* `正文段索引` (`整数`): 指定所欲访问的正文段,必须大于等于0且小于等于"取正文段数目"方法返回值.
* **描述:** 返回所指定索引位置处正文段的内容类型(为正文段的"Content-Type"主属性值,必定全小写),为空返回空文本. 常见正文段类型有: "text/plain"(纯文本), "text/html"(html文本)

##### 火山.视窗.网络.邮件解析类.取正文段内容

* **类型:** `方法`
* **名称:** `取正文段内容`
* **返回值数据类型:** `文本型`
* **参数:**
	* `正文段索引` (`整数`): 指定所欲访问的正文段,必须大于等于0且小于等于"取正文段数目"方法返回值.
* **描述:** 返回所指定索引位置处正文段的内容

##### 火山.视窗.网络.邮件解析类.取首正文段内容

* **类型:** `方法`
* **名称:** `取首正文段内容`
* **返回值数据类型:** `文本型`
* **参数:**
	* `正文段类型` (`文本型`, 默认值: `空对象`): 如果不为空对象,则在其中返回所获取首正文段的类型. 常见正文段类型有: "text/plain"(纯文本), "text/html"(html文本)
* **描述:** 返回第一个纯文本或html文本正文段的内容,如果不存在则返回空文本.
* **相关例程:** [vol-邮件接收-receive_email-main](#vol-邮件接收-receive_email-main)
