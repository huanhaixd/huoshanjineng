
## 火山"视窗项目"系统类库模块: RAR文件解压缩支持

### 包: 火山.视窗.文件解压

---

#### 火山.视窗.文件解压.RAR文件解压类

* **类型:** `类`
* **名称:** `RAR文件解压类`
* **描述:** 基于Unrar实现对RAR压缩格式文件的访问处理
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR文件解压类.正在解压数据

* **类型:** `事件定义方法`
* **名称:** `正在解压数据`
* **返回值数据类型:** `整数`
* **参数:**
	* `数据` (`字节集类`): 解压出的数据内容,最大尺寸不会超过最大字典大小(RAR3.0中为4MB).
* **描述:** 在解压过程中本事件将被触发

##### 火山.视窗.文件解压.RAR文件解压类.提供下一个分卷

* **类型:** `事件定义方法`
* **名称:** `提供下一个分卷`
* **返回值数据类型:** `整数`
* **参数:**
	* `下一分卷文件名` (`文本型`): 在该参数中写入下一个分卷文件的完整路径
* **描述:** 如果所操作的文件存在多个分卷,需要在该事件中提供多个分卷文件路径
* **返回值描述:** 返回0表示忽略,返回1表示重试,返回-1表示终止操作.

##### 火山.视窗.文件解压.RAR文件解压类.所需分卷已打开

* **类型:** `事件定义方法`
* **名称:** `所需分卷已打开`
* **返回值数据类型:** `整数`
* **参数:**
	* `分卷文件名` (`文本型`): 所成功打开的分卷文件
* **描述:** 如果所需的分卷已成功打开本事件将被发送
* **返回值描述:** 返回非0表示终止操作

##### 火山.视窗.文件解压.RAR文件解压类.取库版本号

* **类型:** `方法`
* **名称:** `取库版本号`
* **返回值数据类型:** `整数`
* **特性:**
	* `静态`
* **描述:** 返回所使用库的版本号
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR文件解压类.打开文件

* **类型:** `方法`
* **名称:** `打开文件`
* **返回值数据类型:** `RAR操作结果码`
* **参数:**
	* `文件路径` (`文本型`): 提供文件所处的路径,例如"C:\\abc.rar"
	* `解压密码` (`文本型`, 默认值: `空对象`): 如果所提供压缩文件需要解压密码请提供
* **描述:** 打开指定的压缩文件
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR文件解压类.关闭文件

* **类型:** `方法`
* **名称:** `关闭文件`
* **描述:** 如果已经打开压缩文件,则将其关闭.

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件名

* **类型:** `方法`
* **名称:** `取当前文件名`
* **返回值数据类型:** `文本型`
* **描述:** 获取当前压缩包中所指向的文件名称

##### 火山.视窗.文件解压.RAR文件解压类.取当前卷名称

* **类型:** `方法`
* **名称:** `取当前卷名称`
* **返回值数据类型:** `文本型`
* **描述:** 获取当前文件所处的卷名称

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件标志

* **类型:** `方法`
* **名称:** `取当前文件标志`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件所包含的标志位
* **返回值描述:** 请参考"RAR文件标志位"所提供的常量值

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件压缩尺寸

* **类型:** `方法`
* **名称:** `取当前文件压缩尺寸`
* **返回值数据类型:** `长整数`
* **描述:** 获取当前压缩包中所指向文件尺寸

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件压缩前尺寸

* **类型:** `方法`
* **名称:** `取当前文件压缩前尺寸`
* **返回值数据类型:** `长整数`
* **描述:** 获取当前压缩包中所指向文件被压缩之前尺寸

##### 火山.视窗.文件解压.RAR文件解压类.取操作系统类型

* **类型:** `方法`
* **名称:** `取操作系统类型`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件在哪种系统下进行的压缩
* **返回值描述:** 0:MS DOS1:OS/22:Windows3:Unix

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件CRC32

* **类型:** `方法`
* **名称:** `取当前文件CRC32`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件的CRC校验

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件日期

* **类型:** `方法`
* **名称:** `取当前文件日期`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件的文件日期

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件压缩版本号

* **类型:** `方法`
* **名称:** `取当前文件压缩版本号`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件的压缩版本号

##### 火山.视窗.文件解压.RAR文件解压类.取压缩方法

* **类型:** `方法`
* **名称:** `取压缩方法`
* **返回值数据类型:** `整数`
* **描述:** 获取所使用的压缩方法
* **返回值描述:** 0x30:存储0x31:最快的压缩速度0x32:快速压缩0x33:正常压缩0x34:良好的压缩0x35:最佳压缩

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件属性

* **类型:** `方法`
* **名称:** `取当前文件属性`
* **返回值数据类型:** `整数`
* **描述:** 获取当前压缩包中所指向文件的属性

##### 火山.视窗.文件解压.RAR文件解压类.取当前字典尺寸

* **类型:** `方法`
* **名称:** `取当前字典尺寸`
* **返回值数据类型:** `整数`
* **描述:** 获取压缩字典的尺寸
* **返回值描述:** 单位:kb

##### 火山.视窗.文件解压.RAR文件解压类.取当前哈希算法类型

* **类型:** `方法`
* **名称:** `取当前哈希算法类型`
* **返回值数据类型:** `整数`
* **描述:** 获取用于保护文件数据完整性的哈希函数的类型
* **返回值描述:** 0:RAR_HASH_NONE1:CRC322:BLAKE2sp

##### 火山.视窗.文件解压.RAR文件解压类.取当前文件哈希值

* **类型:** `方法`
* **名称:** `取当前文件哈希值`
* **返回值数据类型:** `文本型`
* **描述:** 获取当前压缩包中所指向文件的哈希值

##### 火山.视窗.文件解压.RAR文件解压类.取文件系统重定向类型

* **类型:** `方法`
* **名称:** `取文件系统重定向类型`
* **返回值数据类型:** `整数`
* **描述:** 获取文件系统重定向的类型
* **返回值描述:** 0:没有重定向,通常的文件. 1:Unix符号链接2:Windows符号链接3:Windows软连接4:硬链接5:使用-oi开关保存的文件引用

##### 火山.视窗.文件解压.RAR文件解压类.取文件系统重定向目标

* **类型:** `方法`
* **名称:** `取文件系统重定向目标`
* **返回值数据类型:** `文本型`
* **描述:** 获取文件系统重定向目标名称

##### 火山.视窗.文件解压.RAR文件解压类.移动到下一文件

* **类型:** `方法`
* **名称:** `移动到下一文件`
* **返回值数据类型:** `RAR操作结果码`
* **描述:** 移动到压缩包中的下一个文件
* **返回值描述:** 返回移动的结果

##### 火山.视窗.文件解压.RAR文件解压类.测试当前文件

* **类型:** `方法`
* **名称:** `测试当前文件`
* **返回值数据类型:** `RAR操作结果码`
* **描述:** 测试当前压缩包中所指向文件是否正常,该方法执行后将会移动到下一个文件.

##### 火山.视窗.文件解压.RAR文件解压类.解压当前文件

* **类型:** `方法`
* **名称:** `解压当前文件`
* **返回值数据类型:** `RAR操作结果码`
* **参数:**
	* `存放目录` (`文本型`, 默认值: `空对象`): 解压缩后释放文件的目录,留空则使用压缩文件当前所处目录.
* **描述:** 解压当前压缩包中所指向文件到指定目录,该方法执行后将会移动到下一个文件.

##### 火山.视窗.文件解压.RAR文件解压类.测试所有文件

* **类型:** `方法`
* **名称:** `测试所有文件`
* **返回值数据类型:** `逻辑型`
* **描述:** 测试当前所打开压缩包中的所有文件
* **返回值描述:** 如果所有文件都测试成功则返回真,有文件失败将返回假.
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR文件解压类.解压所有文件

* **类型:** `方法`
* **名称:** `解压所有文件`
* **返回值数据类型:** `逻辑型`
* **参数:**
	* `存放目录` (`文本型`, 默认值: `空对象`): 解压缩后释放文件的目录,留空则使用压缩文件当前所处目录.
* **描述:** 解压当前所打开压缩包中的所有文件到指定目录
* **返回值描述:** 如果所有文件都解压成功则返回真,有文件失败将返回假.
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

---

#### 火山.视窗.文件解压.RAR操作结果码

* **类型:** `类`
* **名称:** `RAR操作结果码`
* **特性:**
	* `常量类`(对应数据类型: `整数`)
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR操作结果码.成功

* **类型:** `成员常量`
* **名称:** `成功`
* **数据类型:** `RAR操作结果码`
* **相关例程:** [vol-rar文件解压-unrar-main](#vol-rar文件解压-unrar-main)

##### 火山.视窗.文件解压.RAR操作结果码.文档结束

* **类型:** `成员常量`
* **名称:** `文档结束`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.内存不足

* **类型:** `成员常量`
* **名称:** `内存不足`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.CRC验证错误

* **类型:** `成员常量`
* **名称:** `CRC验证错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.无效归档

* **类型:** `成员常量`
* **名称:** `无效归档`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.未知格式

* **类型:** `成员常量`
* **名称:** `未知格式`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.卷打开错误

* **类型:** `成员常量`
* **名称:** `卷打开错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.创建失败

* **类型:** `成员常量`
* **名称:** `创建失败`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.关闭失败

* **类型:** `成员常量`
* **名称:** `关闭失败`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.读取错误

* **类型:** `成员常量`
* **名称:** `读取错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.写入错误

* **类型:** `成员常量`
* **名称:** `写入错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.缓冲区不足

* **类型:** `成员常量`
* **名称:** `缓冲区不足`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.未知错误

* **类型:** `成员常量`
* **名称:** `未知错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.未提供密码

* **类型:** `成员常量`
* **名称:** `未提供密码`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.引用错误

* **类型:** `成员常量`
* **名称:** `引用错误`
* **数据类型:** `RAR操作结果码`

##### 火山.视窗.文件解压.RAR操作结果码.密码错误

* **类型:** `成员常量`
* **名称:** `密码错误`
* **数据类型:** `RAR操作结果码`

---

#### 火山.视窗.文件解压.RAR文件标志位

* **类型:** `类`
* **名称:** `RAR文件标志位`

##### 火山.视窗.文件解压.RAR文件标志位.上一卷继续

* **类型:** `成员常量`
* **名称:** `上一卷继续`
* **数据类型:** `整数`

##### 火山.视窗.文件解压.RAR文件标志位.下一卷继续

* **类型:** `成员常量`
* **名称:** `下一卷继续`
* **数据类型:** `整数`

##### 火山.视窗.文件解压.RAR文件标志位.密码加密

* **类型:** `成员常量`
* **名称:** `密码加密`
* **数据类型:** `整数`

##### 火山.视窗.文件解压.RAR文件标志位.老文件数据

* **类型:** `成员常量`
* **名称:** `老文件数据`
* **数据类型:** `整数`

##### 火山.视窗.文件解压.RAR文件标志位.目录条目

* **类型:** `成员常量`
* **名称:** `目录条目`
* **数据类型:** `整数`
