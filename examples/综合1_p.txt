
###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.无名.菜鸟驿站 <注释 = "火山菜鸟驿站：http://www.vowm.cn">

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口 <公开 类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数 注释 = "火山菜鸟驿站：http://www.vowm.cn">
    {
        主窗口.创建主窗口 ()
        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 注释 = "火山菜鸟驿站：http://www.vowm.cn" 标题 = "表格演示" @视窗.布局 = "client_size = \"700, 438\""
        最大化按钮 = 真 最小化按钮 = 真 窗口边框 = 镜框式可调边框>
{
    变量 表格1 <公开 类型 = 表格 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"-3, 16, 400, 184\"" 行数 = 20 列数 = 9
            是否可编辑 = 真 允许选择块 = 真 回车键功能 = 跳到下一行 表格线颜色 = 颜色类.浅灰色 背景颜色 = 颜色类.白色 文字颜色 = 颜色类.黑色 点燃色 = 颜色类.黑色
            选择区背景颜色 = 颜色类.蓝灰色 客户区背景颜色 = 颜色类.白色 表头背景颜色 = 0xD8E9EC 行高 = 30 列宽 = 60 表头行数 = 1 表头列数 = 1 打印页码 = 右边
            打印日期 = 左边 显示打印对话框 = 真 显示打印按钮 = 真>
    变量 窗口菜单 <类型 = 主窗口菜单>

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "火山菜鸟驿站：http://www.vowm.cn">
    参数 来源对象 <类型 = 我的主窗口>
    参数 标记值 <类型 = 整数>
    {
        写表头序号 ()
        写测试数据 ()
        置实例菜单 (窗口菜单)
        返回 (0)
    }

    方法 我的主窗口_尺寸被改变 <接收事件 类型 = 整数 折叠>
    参数 来源对象 <类型 = 我的主窗口>
    参数 标记值 <类型 = 整数>
    {
        表格1.移动 (0, 0, 取用户区宽度 (), 取用户区高度 ())
        返回 (0)
    }

    方法 写表头序号 <注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠>
    {
        变量 计次 <类型 = 整数>
        循环 (, 表格1.行数, 计次)  // 设置序号
        {
            表格1.置数据 (计次, 0, 表格常量.文本值型, 到文本 (计次 + 1))
        }
    }

    方法 写测试数据 <注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠>
    {
        常量 列头 <类型 = "文本型 []" 值 = {"序号","客户名称","商品名称","数量","单价","总金额","日期","图片","审核"}>
        变量 计次 <类型 = 整数>
        循环 (, 表格1.列数, 计次)
        {
            表格1.置数据 (0, 计次, 表格常量.文本值型, 列头 [计次])
        }
        常量 下拉内容 <类型 = "文本型 []" 值 = {"递归软件","阿里战投","小米战投"}>
        循环 (, 取数组成员数 (下拉内容), 计次)  // 设置下拉表项
        {
            表格1.添加下拉列表内容 (下拉内容 [计次])
        }
        表格1.置列类型 (1, 表格常量.列表型)
        表格1.插入下拉列表项 (1, "插入公司")
        表格1.置数据 (1, 1, 表格常量.文本值型, "递归软件")  // 选中
        常量 剩余数据 <类型 = "文本型 []" 值 = {"火山视窗","10","888","8880","2017-8-3","","真"}>
        循环 (, 取数组成员数 (剩余数据), 计次)  // 填充剩余表项
        {
            表格1.置数据 (1, 2 + 计次, 表格常量.文本值型, 剩余数据 [计次])
        }
        常量 列宽设置 <类型 = "整数 []" 值 = {40,120,100,50,60,90,100,80,35}>
        循环 (, 取数组成员数 (列宽设置), 计次)  // 设置列宽
        {
            表格1.置列宽 (计次, 列宽设置 [计次])
        }
        // 设置类型
        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.数值型)
        表格1.置列类型 (5, 表格常量.货币型)
        表格1.置单元格小数位数 (5, 2)
        表格1.置列类型 (6, 表格常量.日期型)
        表格1.置列类型 (7, 表格常量.图片型)
        表格1.置列类型 (8, 表格常量.选择型)
        表格1.置数据 (1, 8, 表格常量.选择型, 选择 (表格1.取文本数据 (1, 8) == "真", 真, 假))  // 设置选择
        表格1.置计算公式 (3, 4, 表格常量.乘, 5)
    }

    变量 窗口设置打印表头 <类型 = 窗口_设置打印表头>
    变量 输入结果 <类型 = 文本型>

    方法 我的主窗口_接收到命令 <接收事件 类型 = 整数 注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 来源对象 <类型 = 我的主窗口>
    参数 标记值 <类型 = 整数>
    参数 命令代码 <类型 = 整数>
    {
        如果 (命令代码 > 主窗口菜单._最小值 && 命令代码 <= 主窗口菜单._最大值)
        {
            如果 (命令代码 == 主窗口菜单.置打印表头)
            {
                窗口设置打印表头.创建对话框 (真)
            }
            否则 (命令代码 == 主窗口菜单.显示打印按钮)
            {
                表格1.显示打印按钮 = 取反 (窗口菜单.是否被选中 (主窗口菜单.显示打印按钮))
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.显示打印按钮)
            }
            否则 (命令代码 == 主窗口菜单.显示打印对话框)
            {
                表格1.显示打印对话框 = 取反 (窗口菜单.是否被选中 (主窗口菜单.显示打印对话框))
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.显示打印对话框)
            }
            否则 (命令代码 == 主窗口菜单.打印缩放至页宽)
            {
                表格1.打印缩放至页宽 = 取反 (窗口菜单.是否被选中 (主窗口菜单.打印缩放至页宽))
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.打印缩放至页宽)
            }
            否则 (命令代码 == 主窗口菜单.打印)
            {
                表格1.打印 ()
            }
            否则 (命令代码 == 主窗口菜单.打印预览)
            {
                表格1.打印预览 ()
            }
            否则 (命令代码 == 主窗口菜单.退出)
            {
                关闭窗口 ()
            }
            否则 (命令代码 == 主窗口菜单.剪切)
            {
                表格1.剪切选定文本 ()
            }
            否则 (命令代码 == 主窗口菜单.复制)
            {
                表格1.复制选定文本 ()
            }
            否则 (命令代码 == 主窗口菜单.粘贴)
            {
                表格1.粘贴 ()
            }
            否则 (命令代码 == 主窗口菜单.合并)
            {
                表格1.合并 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 ())
            }
            否则 (命令代码 == 主窗口菜单.拆分)
            {
                如果 (表格1.取光标行号 () == -1)
                {
                    信息框 ("没有选中任何单元格")
                }
                否则
                {
                    表格1.分解 (表格1.取光标行号 (), 表格1.取光标列号 ())
                }
            }
            否则 (命令代码 == 主窗口菜单.置表头行数)
            {
                如果真 (输入框 (输入结果, "请输入表头行数：", , "20", 输入框输入方式.输入整数))
                {
                    表格1.表头行数 = 文本到整数 (输入结果)
                }
            }
            否则 (命令代码 == 主窗口菜单.置表头列数)
            {
                如果真 (输入框 (输入结果, "请输入表头列数：", , "20", 输入框输入方式.输入整数))
                {
                    表格1.表头列数 = 文本到整数 (输入结果)
                }
            }
            否则 (命令代码 == 主窗口菜单.置表格行数)
            {
                如果真 (输入框 (输入结果, "请输入行数：", , "20", 输入框输入方式.输入整数))
                {
                    表格1.行数 = 文本到整数 (输入结果)
                    写表头序号 ()
                }
            }
            否则 (命令代码 == 主窗口菜单.置表格列数)
            {
                如果真 (输入框 (输入结果, "请输入列数：", , "20", 输入框输入方式.输入整数))
                {
                    表格1.列数 = 文本到整数 (输入结果)
                }
            }
            否则 (命令代码 == 主窗口菜单.置行高)
            {
                如果 (表格1.取光标行号 () == -1)
                {
                    信息框 ("没有选中任何单元格")
                }
                否则
                {
                    如果真 (输入框 (输入结果, "请输入行高：", "确认后将修改光标所处位置行的行高", "20", 输入框输入方式.输入整数))
                    {
                        表格1.置行高 (表格1.取光标行号 (), 文本到整数 (输入结果))
                    }
                }
            }
            否则 (命令代码 == 主窗口菜单.置列宽)
            {
                如果真 (输入框 (输入结果, "请输入列数：", "确认后将修改光标所处位置列的列宽", "20", 输入框输入方式.输入整数))
                {
                    表格1.置列宽 (表格1.取光标列号 (), 文本到整数 (输入结果))
                }
            }
            否则 (命令代码 == 主窗口菜单.取行高)
            {
                如果 (表格1.取光标行号 () == -1)
                {
                    信息框 ("没有选中任何单元格，无法取出行高。")
                }
                否则
                {
                    信息框 ("第" + 到文本 (表格1.取光标行号 ()) + "行高：" + 到文本 (表格1.取行高 (表格1.取光标行号 ())))
                }
            }
            否则 (命令代码 == 主窗口菜单.取列宽)
            {
                如果 (表格1.取光标列号 () == -1)
                {
                    信息框 ("没有选中任何单元格，无法取出。")
                }
                否则
                {
                    信息框 ("第" + 到文本 (表格1.取光标列号 ()) + "列宽：" + 到文本 (表格1.取列宽 (表格1.取光标列号 ())))
                }
            }
            否则 (命令代码 == 主窗口菜单.表格属性)
            {
                变量 窗口表格 <类型 = 窗口_表格属性>
                窗口表格.创建对话框 ()
            }
            否则 (命令代码 == 主窗口菜单.取选择区域)
            {
                信息框 ("起始行:" + 到文本 (表格1.取选择起始行 ()) + "\r\n起始列：" + 到文本 (表格1.取选择起始列 ()) + "\r\n结束行：" + 到文本 (表格1.取选择终止行 ()) + "\r\n结束列：" + 到文本 (表格1.取选择终止列 ()), , "表格多选才有效果")
            }
            否则 (命令代码 == 主窗口菜单.跳转)
            {
                如果真 (输入框 (输入结果, "请输入要跳转的行号列号,中间用'-'分割\r\n例如：3-5，表示3行5列。", "输入行列", "3-2"))
                {
                    如果 (寻找文本 (输入结果, "-") == -1)
                    {
                        信息框 ("输入格式不准确")
                    }
                    否则
                    {
                        变量 结果数组 <类型 = 文本数组类>
                        分割文本 (输入结果, "-", 结果数组)
                        表格1.置光标 (文本到整数 (结果数组.取成员 (0)), 文本到整数 (结果数组.取成员 (1)))
                    }
                }
            }
            否则 (命令代码 == 主窗口菜单.删除当前行)
            {
                表格1.删除行 (表格1.取光标行号 ())
                写表头序号 ()
            }
            否则 (命令代码 == 主窗口菜单.删除当前行)
            {
                表格1.删除列 (表格1.取光标列号 ())
            }
            否则 (命令代码 == 主窗口菜单.插入行)
            {
                表格1.插入行 ("新行", 表格1.取光标行号 ())
            }
            否则 (命令代码 == 主窗口菜单.插入列)
            {
                表格1.插入列 ("新列", 表格1.取光标列号 ())
            }
            否则 (命令代码 == 主窗口菜单.全选)
            {
                表格1.全部选择 ()
            }
            否则 (命令代码 == 主窗口菜单.文本类型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.文本值型)
            }
            否则 (命令代码 == 主窗口菜单.数值型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.数值型)
            }
            否则 (命令代码 == 主窗口菜单.日期型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.日期型)
            }
            否则 (命令代码 == 主窗口菜单.列表型)
            {
                表格1.清空下拉列表 ()
                表格1.添加下拉列表内容 ("火山")
                表格1.添加下拉列表内容 ("软件")
                表格1.添加下拉列表内容 ("开发")
                表格1.添加下拉列表内容 ("平台")
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.列表型)
            }
            否则 (命令代码 == 主窗口菜单.选择型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.选择型)
            }
            否则 (命令代码 == 主窗口菜单.图片型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.图片型)
            }
            否则 (命令代码 == 主窗口菜单.货币型)
            {
                表格1.置列类型 (表格1.取光标列号 (), 表格常量.货币型)
            }
            否则 (命令代码 == 主窗口菜单.取单元格类型)
            {
                变量 类型 <类型 = 文本型>
                如果 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.文本值型)
                {
                    类型 = "文本型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.数值型)
                {
                    类型 = "数值型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.日期型)
                {
                    类型 = "日期型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.列表型)
                {
                    类型 = "列表型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.选择型)
                {
                    类型 = "选择型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.图片型)
                {
                    类型 = "图片型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.货币型)
                {
                    类型 = "货币型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 表格常量.不可编辑列表型)
                {
                    类型 = "不可编辑列表型"
                }
                否则 (表格1.取列类型 (表格1.取光标列号 ()) == 0)
                {
                    类型 = "获取失败，可能是没有选择任何列"
                }
                信息框 ("第" + 到文本 (表格1.取光标列号 ()) + "列的类型是:" + 类型)
            }
            否则 (命令代码 == 主窗口菜单.取单元格字体信息)
            {
                变量 窗口_字体信息 <类型 = 窗口字体信息>
                窗口_字体信息.创建对话框 ()
            }
            否则 (命令代码 == 主窗口菜单.取单元格行高列宽)
            {
                信息框 ("行" + 到文本 (表格1.取光标行号 ()) + "高度是：" + 到文本 (表格1.取单元格行高 ()) + "\r\n列" + 到文本 (表格1.取光标列号 ()) + "宽度是：" + 到文本 (表格1.取单元格列宽 ()))
            }
            否则 (命令代码 == 主窗口菜单.单元格颜色设置)
            {
                变量 窗口颜色 <类型 = 窗口_单元格颜色>
                窗口颜色.创建对话框 ()
            }
            否则 (命令代码 == 主窗口菜单.字体)
            {
                变量 对话框1 <类型 = 通用对话框 "类型" = 字体选择>
                如果真 (对话框1.打开 (本对象))
                {
                    变量 字体属性 <类型 = 整数>
                    如果真 (对话框1.加粗)
                    {
                        字体属性 = 字体属性 + 表格常量.粗体
                    }
                    如果真 (对话框1.倾斜)
                    {
                        字体属性 = 字体属性 + 表格常量.斜体
                    }
                    如果真 (对话框1.删除线)
                    {
                        字体属性 = 字体属性 + 表格常量.删除线
                    }
                    如果真 (对话框1.下划线)
                    {
                        字体属性 = 字体属性 + 表格常量.下划线
                    }
                    表格1.置字体属性 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 字体属性)
                    表格1.置字体名 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 对话框1.字体名称)
                    表格1.置字体尺寸 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 对话框1.字体大小)
                    表格1.置单元格文字颜色 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 对话框1.字体颜色)
                }
            }
            否则 (命令代码 == 主窗口菜单.边距)
            {
                如果真 (输入框 (输入结果, "请输入边距(单位: 0.1毫米):", , "9", 输入框输入方式.输入整数))
                {
                    表格1.置边距 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 文本到整数 (输入结果))
                }
            }
            否则 (命令代码 == 主窗口菜单.取边距)
            {
                信息框 ("行" + 到文本 (表格1.取光标行号 ()) + "列：" + 到文本 (表格1.取光标列号 ()) + "\r\n边距：" + 到文本 (表格1.取边距 (表格1.取光标行号 (), 表格1.取光标列号 ())))
            }
            否则 (命令代码 == 主窗口菜单.左对齐)
            {
                表格1.置对齐方式 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 表格常量.左对齐)
            }
            否则 (命令代码 == 主窗口菜单.居中对齐)
            {
                表格1.置对齐方式 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 表格常量.居中对齐)
            }
            否则 (命令代码 == 主窗口菜单.右对齐)
            {
                表格1.置对齐方式 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 表格常量.右对齐)
            }
            否则 (命令代码 == 主窗口菜单.添加单斜线)
            {
                表格1.加线条 (表格1.取光标行号 (), 表格1.取光标列号 (), 表格常量.单斜线)
            }
            否则 (命令代码 == 主窗口菜单.添加双斜线)
            {
                表格1.加线条 (表格1.取光标行号 (), 表格1.取光标列号 (), 表格常量.双斜线)
            }
            否则 (命令代码 == 主窗口菜单.添加交叉线)
            {
                表格1.加线条 (表格1.取光标行号 (), 表格1.取光标列号 (), 表格常量.交叉线)
            }
            否则 (命令代码 == 主窗口菜单.清除线条)
            {
                表格1.删线条 (表格1.取光标行号 (), 表格1.取光标列号 ())
            }
            否则 (命令代码 == 主窗口菜单.长日期格式)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.长日期格式)
            }
            否则 (命令代码 == 主窗口菜单.短格式1)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.短日期格式1)
            }
            否则 (命令代码 == 主窗口菜单.短格式2)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.短日期格式2)
            }
            否则 (命令代码 == 主窗口菜单.短格式3)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.短日期格式3)
            }
            否则 (命令代码 == 主窗口菜单.美式格式1)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.美式格式1)
            }
            否则 (命令代码 == 主窗口菜单.美式格式2)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.美式格式2)
            }
            否则 (命令代码 == 主窗口菜单.美式格式3)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.美式格式3)
            }
            否则 (命令代码 == 主窗口菜单.美式格式4)
            {
                表格1.置日期格式 (表格1.取光标列号 (), 表格常量.美式格式4)
            }
            否则 (命令代码 == 主窗口菜单.人民币)
            {
                表格1.置货币前缀 (表格1.取光标列号 (), 表格常量.人民币, )
            }
            否则 (命令代码 == 主窗口菜单.美元)
            {
                表格1.置货币前缀 (表格1.取光标列号 (), 表格常量.美元, )
            }
            否则 (命令代码 == 主窗口菜单.欧元)
            {
                表格1.置货币前缀 (表格1.取光标列号 (), 表格常量.斜体, )
            }
            否则 (命令代码 == 主窗口菜单.英镑)
            {
                表格1.置货币前缀 (表格1.取光标列号 (), 表格常量.英镑, )
            }
            否则 (命令代码 == 主窗口菜单.自定义)
            {
                如果真 (输入框 (输入结果, "请输入货币前缀:"))
                {
                    表格1.置货币前缀 (表格1.取光标列号 (), 表格常量.自定义货币, 输入结果)
                }
            }
            否则 (命令代码 == 主窗口菜单.平铺)
            {
                表格1.置图片显示方式 (表格1.取光标列号 (), 表格常量.自定义货币)
            }
            否则 (命令代码 == 主窗口菜单.拉伸)
            {
                表格1.置图片显示方式 (表格1.取光标列号 (), 表格常量.平铺)
            }
            否则 (命令代码 == 主窗口菜单.居中)
            {
                表格1.置图片显示方式 (表格1.取光标列号 (), 表格常量.拉伸)
            }
            否则 (命令代码 == 主窗口菜单.左上角)
            {
                表格1.置图片显示方式 (表格1.取光标列号 (), 表格常量.居中)
            }
            否则 (命令代码 == 主窗口菜单.自适应)
            {
                表格1.置图片显示方式 (表格1.取光标列号 (), 表格常量.左上角)
            }
            否则 (命令代码 == 主窗口菜单.小数位数)
            {
                如果真 (输入框 (输入结果, "请输入小数位数：", , "0", 输入框输入方式.输入整数))
                {
                    表格1.置单元格小数位数 (表格1.取光标列号 (), 文本到整数 (输入结果))
                }
            }
            否则 (命令代码 == 主窗口菜单.单行显示)
            {
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.单行显示)
                表格1.置自动换行 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 取反 (窗口菜单.是否被选中 (主窗口菜单.单行显示)))
            }
            否则 (命令代码 == 主窗口菜单.置为只读)
            {
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.置为只读)
                表格1.置只读方式 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 窗口菜单.是否被选中 (主窗口菜单.置为只读))
            }
            否则 (命令代码 == 主窗口菜单.密码输入)
            {
                窗口菜单.翻转菜单项选中状态 (主窗口菜单.密码输入)
                表格1.置密码方式 (表格1.取选择起始行 (), 表格1.取选择起始列 (), 表格1.取选择终止行 (), 表格1.取选择终止列 (), 窗口菜单.是否被选中 (主窗口菜单.密码输入))
            }
        }
        返回 (0)
    }
}

类 窗口_单元格颜色 <公开 基础类 = 窗口 注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠 隐藏值属性 = "0"
        @视窗.布局 = "client_size = \"363, 180\"" 最小化按钮 = 假 标题 = "颜色设置">
{
    变量 按钮_设置 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"189, 127, 128, 39\"" 标题 = "设置">
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"173, 48, 66, 24\"" 标题 = "背景颜色：">
    变量 标签6 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"173, 80, 66, 24\"" 标题 = "文本颜色：">
    变量 颜色_文本颜色 <类型 = 颜色选择器 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"253, 80, 80, 24\"">
    变量 颜色_背景颜色 <类型 = 颜色选择器 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"253, 48, 80, 24\"">
    变量 编辑框_结束列 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"77, 144, 72, 24\"" 输入方式 = 输入整数
            禁止 = 真 内容 = "10">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"13, 144, 56, 24\"" 标题 = "结束列：">
    变量 编辑框_结束行 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"77, 112, 72, 24\"" 输入方式 = 输入整数
            禁止 = 真 内容 = "10">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"13, 112, 56, 24\"" 标题 = "结束行：">
    变量 编辑框_起始列 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"77, 80, 72, 24\"" 输入方式 = 输入整数 禁止 = 真
            内容 = "0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"13, 80, 56, 24\"" 标题 = "起始列：">
    变量 编辑框_起始行 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"77, 48, 72, 24\"" 输入方式 = 输入整数 禁止 = 真
            内容 = "0">
    变量 选择框_自定义范围 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"13, 8, 336, 24\""
            标题 = "自定义范围,取消选中后将使用表格选择范围">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"13, 48, 56, 24\"" 标题 = "起始行：">

    方法 选择框_被单击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 选择框>
    参数 标记值 <类型 = 整数>
    {
        如果 (选择框_自定义范围.选中)
        {
            编辑框_结束列.禁止 = 取反 (选择框_自定义范围.选中)
            编辑框_结束行.禁止 = 取反 (选择框_自定义范围.选中)
            编辑框_起始列.禁止 = 取反 (选择框_自定义范围.选中)
            编辑框_起始行.禁止 = 取反 (选择框_自定义范围.选中)
        }
        返回 (0)
    }

    方法 按钮_被单击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 按钮>
    参数 标记值 <类型 = 整数>
    {
        如果 (来源对象 == 按钮_设置)
        {
            变量 表格组件 <类型 = 表格>
            表格组件 = 取程序 ().主窗口.表格1
            如果 (选择框_自定义范围.选中)
            {
                如果真 (编辑框_起始行.内容 == "" || 编辑框_起始列.内容 == "" || 编辑框_结束行.内容 == "" || 编辑框_结束列.内容 == "")
                {
                    信息框 ("不能为空")
                    返回 (0)
                }
                表格组件.置单元格文字颜色 (文本到整数 (编辑框_起始行.内容), 文本到整数 (编辑框_起始列.内容), 文本到整数 (编辑框_结束行.内容), 文本到整数 (编辑框_结束列.内容), 颜色_文本颜色.颜色)
                表格组件.置单元格背景颜色 (文本到整数 (编辑框_起始行.内容), 文本到整数 (编辑框_起始列.内容), 文本到整数 (编辑框_结束行.内容), 文本到整数 (编辑框_结束列.内容), 颜色_背景颜色.颜色)
            }
            否则
            {
                表格组件.置单元格文字颜色 (表格组件.取选择起始行 (), 表格组件.取选择起始列 (), 表格组件.取选择终止行 (), 表格组件.取选择终止列 (), 颜色_文本颜色.颜色)
                表格组件.置单元格背景颜色 (表格组件.取选择起始行 (), 表格组件.取选择起始列 (), 表格组件.取选择终止行 (), 表格组件.取选择终止列 (), 颜色_背景颜色.颜色)
            }
        }
        返回 (0)
    }
}

类 窗口字体信息 <公开 基础类 = 窗口 注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠 隐藏值属性 = "0"
        @视窗.布局 = "client_size = \"260, 179\"" 最小化按钮 = 假>
{
    变量 标签_背景色块 <类型 = 标签 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"102, 138, 56, 32\"">
    变量 标签_文本色块 <类型 = 标签 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"102, 104, 56, 32\"">
    变量 标签_背景颜色 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"12, 136, 80, 32\"" 标题 = "背景颜色：">
    变量 标签_文本颜色 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"12, 104, 79, 32\"" 标题 = "文本颜色：">
    变量 标签_字体属性 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"12, 72, 168, 32\"" 标题 = "字体属性：">
    变量 标签_字体尺寸 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"12, 40, 168, 32\"" 标题 = "字体尺寸：">
    变量 标签_字体名称 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"12, 8, 168, 32\"" 标题 = "字体名称：">

    方法 窗口字体信息_创建完毕 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 窗口字体信息>
    参数 标记值 <类型 = 整数>
    {
        变量 表格组件 <类型 = 表格>
        表格组件 = 取程序 ().主窗口.表格1
        标题 = "行：" + 到文本 (表格组件.取光标行号 ()) + "列：" + 到文本 (表格组件.取光标列号 ())
        标签_字体名称.标题 = "字体名称：" + 到文本 (表格组件.取字体名 (表格组件.取光标行号 (), 表格组件.取光标列号 ()))
        标签_字体尺寸.标题 = "字体尺寸：" + 到文本 (表格组件.取字体尺寸 (表格组件.取光标行号 (), 表格组件.取光标列号 ()))
        如果 (表格组件.取字体属性 (表格组件.取光标行号 (), 表格组件.取光标列号 ()) == 表格常量.粗体)
        {
            标签_字体属性.标题 = "字体属性：粗体"
        }
        否则 (表格组件.取字体属性 (表格组件.取光标行号 (), 表格组件.取光标列号 ()) == 表格常量.斜体)
        {
            标签_字体属性.标题 = "字体属性：斜体"
        }
        否则 (表格组件.取字体属性 (表格组件.取光标行号 (), 表格组件.取光标列号 ()) == 表格常量.下划线)
        {
            标签_字体属性.标题 = "字体属性：下划线"
        }
        否则 (表格组件.取字体属性 (表格组件.取光标行号 (), 表格组件.取光标列号 ()) == 表格常量.删除线)
        {
            标签_字体属性.标题 = "字体属性：删除线"
        }
        否则
        {
            标签_字体属性.标题 = "字体属性：常规"
        }
        标签_背景色块.背景颜色 = 表格组件.取单元格背景颜色 (表格组件.取光标行号 (), 表格组件.取光标列号 ())
        标签_文本色块.背景颜色 = 表格组件.取单元格文字颜色 (表格组件.取光标行号 (), 表格组件.取光标列号 ())
        返回 (0)
    }
}

类 窗口_表格属性 <基础类 = 窗口 注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠 隐藏值属性 = "0"
        @视窗.布局 = "client_size = \"345, 231\"" 最小化按钮 = 假 标题 = "设置表格属性">
{
    变量 按钮_取消 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"116, 184, 88, 40\"" 标题 = "&C取消">
    变量 按钮_确定 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"13, 184, 88, 40\"" 标题 = "&O确定">
    变量 选择框_选择整行 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"221, 168, 115, 24\"" 标题 = "选择整行">
    变量 选择框_表头可点击 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"221, 199, 115, 24\"" 标题 = "表头可点击">
    变量 选择框_允许选择块 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"221, 136, 115, 24\"" 标题 = "允许选择块">
    变量 选择框_允许编辑 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"221, 105, 115, 24\"" 标题 = "允许编辑">
    变量 选择框_调整列宽 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"221, 74, 115, 24\"" 标题 = "允许调整列宽">
    变量 选择框_允许调整行高 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"221, 43, 115, 24\"" 标题 = "允许调整行高">
    变量 选择框_显示斑马线 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"221, 12, 115, 24\"" 标题 = "显示斑马线">
    变量 组合框1 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"132, 136, 75, 24\"" "类型" = 不可编辑下拉式
            列表项目 = "不显示\n0\n横线\n0\n纵线\n0\n表格线\n0" 现行选中项 = 0>
    变量 颜色_选择颜色 <类型 = 颜色选择器 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"132, 105, 75, 24\"" 颜色 = 0xFFFFFF>
    变量 颜色_斑马线颜色2 <类型 = 颜色选择器 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"132, 75, 75, 24\"" 颜色 = 0xFFFFFF>
    变量 颜色_斑马线颜色1 <类型 = 颜色选择器 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"132, 45, 75, 24\"" 颜色 = 0xFFFFFF>
    变量 颜色_表格颜色 <类型 = 颜色选择器 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"132, 15, 75, 24\"">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"13, 48, 112, 24\"" 标题 = "斑马线颜色(奇):">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"13, 16, 104, 24\"" 标题 = "表格线颜色：">
    变量 标签3 <类型 = 标签 标题 = "斑马线颜色(偶)：">
    变量 标签4 <类型 = 标签 标题 = "选择区背景色：">
    变量 标签5 <类型 = 标签 标题 = "显示表格线：">

    方法 窗口_表格属性_创建完毕 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 窗口_表格属性>
    参数 标记值 <类型 = 整数>
    {
        标签3.创建组件 (本对象, 标签2.左边, 颜色_斑马线颜色2.顶边, 标签2.宽度, 标签2.高度)
        标签4.创建组件 (本对象, 标签2.左边, 颜色_选择颜色.顶边, 标签2.宽度, 标签2.高度)
        标签5.创建组件 (本对象, 标签2.左边, 组合框1.顶边, 标签2.宽度, 标签2.高度)
        颜色_表格颜色.颜色 = 取程序 ().主窗口.表格1.表格线颜色
        颜色_选择颜色.颜色 = 取程序 ().主窗口.表格1.选择区背景颜色
        组合框1.现行选中项 = (整数)取程序 ().主窗口.表格1.显示表格线
        选择框_允许调整行高.选中 = 取程序 ().主窗口.表格1.允许调整行高
        选择框_调整列宽.选中 = 取程序 ().主窗口.表格1.允许调整列宽
        选择框_显示斑马线.选中 = 真
        选择框_允许编辑.选中 = 取程序 ().主窗口.表格1.是否可编辑
        选择框_选择整行.选中 = 取程序 ().主窗口.表格1.选择整行
        如果 (选择框_选择整行.选中)
        {
            选择框_允许选择块.选中 = 真
            选择框_允许选择块.禁止 = 真
        }
        否则
        {
            选择框_允许选择块.选中 = 取程序 ().主窗口.表格1.允许选择块
        }
        选择框_表头可点击.选中 = 取程序 ().主窗口.表格1.响应表头被单击
        返回 (0)
    }

    方法 按钮_被单击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 按钮>
    参数 标记值 <类型 = 整数>
    {
        如果 (来源对象 == 按钮_确定)  // 取消按钮可以省略判断,因为两个按钮最终都是要关闭的。
        {
            取程序 ().主窗口.表格1.表格线颜色 = 颜色_表格颜色.颜色
            取程序 ().主窗口.表格1.选择区背景颜色 = 颜色_选择颜色.颜色
            如果 (组合框1.现行选中项 == 0)
            {
                取程序 ().主窗口.表格1.显示表格线 = 表格线显示类型.不显示
            }
            否则 (组合框1.现行选中项 == 1)
            {
                取程序 ().主窗口.表格1.显示表格线 = 表格线显示类型.横线
            }
            否则 (组合框1.现行选中项 == 2)
            {
                取程序 ().主窗口.表格1.显示表格线 = 表格线显示类型.纵线
            }
            否则 (组合框1.现行选中项 == 3)
            {
                取程序 ().主窗口.表格1.显示表格线 = 表格线显示类型.横纵线
            }
            取程序 ().主窗口.表格1.允许调整行高 = 选择框_允许调整行高.选中
            取程序 ().主窗口.表格1.允许调整列宽 = 选择框_调整列宽.选中
            取程序 ().主窗口.表格1.是否可编辑 = 选择框_允许编辑.选中
            取程序 ().主窗口.表格1.允许选择块 = 选择框_允许选择块.选中
            取程序 ().主窗口.表格1.选择整行 = 选择框_选择整行.选中
            取程序 ().主窗口.表格1.响应表头被单击 = 选择框_表头可点击.选中
            如果 (选择框_显示斑马线.选中)
            {
                取程序 ().主窗口.表格1.显示斑马线 (表格常量.行斑马线, 颜色_斑马线颜色1.颜色, 颜色_斑马线颜色2.颜色)
            }
            否则
            {
                取程序 ().主窗口.表格1.显示斑马线 (表格常量.列斑马线, 颜色_斑马线颜色1.颜色, 颜色_斑马线颜色2.颜色)
            }
        }
        关闭窗口 ()
        返回 (0)
    }

    方法 选择框_被单击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 选择框>
    参数 标记值 <类型 = 整数>
    {
        如果 (来源对象 == 选择框_选择整行)
        {
            如果 (选择框_选择整行.选中)
            {
                选择框_允许选择块.选中 = 真
                选择框_允许选择块.禁止 = 真
            }
            否则
            {
                选择框_允许选择块.禁止 = 选择 (选择框_允许选择块.禁止, 假, 真)
            }
        }
        返回 (0)
    }
}

类 窗口_设置打印表头 <公开 基础类 = 窗口 注释 = "" 注释 = "火山菜鸟驿站：http://www.vowm.cn" 折叠 隐藏值属性 = "0"
        @视窗.布局 = "client_size = \"344, 230\"" 最小化按钮 = 假 标题 = "设置打印表头">
{
    变量 按钮_设置 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"96, 180, 151, 40\"" 标题 = "设置">
    变量 按钮_选择字体 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"304, 46, 32, 24\"" 标题 = "...">
    变量 组合框_对齐方式 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"119, 137, 214, 24\"" "类型" = 不可编辑下拉式
            列表项目 = "左对齐\n0\n居中对齐\n0\n右对齐\n0" 现行选中项 = 0>
    变量 选择框_加粗 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"117, 110, 64, 24\"" 标题 = "加粗">
    变量 编辑框_字体尺寸 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"117, 78, 200, 26\"" 调节器方式 = 自动调节器
            调节器底限值 = 20 调节器上限值 = 100 内容 = "20" 输入方式 = 输入整数>
    变量 编辑框_字体名称 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"117, 46, 184, 24\"">
    变量 编辑框_表头名称 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"117, 14, 216, 24\"">
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"10, 142, 104, 24\"" 标题 = "对齐方式：">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"10, 110, 104, 24\"" 标题 = "是否加粗：">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"10, 78, 104, 24\"" 标题 = "字体尺寸：">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"10, 46, 104, 24\"" 标题 = "选择字体名称：">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"10, 14, 104, 24\"" 标题 = "打印表头名称：">
    变量 通用对话框1 <类型 = 通用对话框 "">

    方法 按钮_被单击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 按钮>
    参数 标记值 <类型 = 整数>
    {
        如果 (来源对象 == 按钮_设置)
        {
            如果 (编辑框_表头名称.内容 == "")
            {
                信息框 ("表头名称不能为空")
                返回 (0)
            }
            如果 (取程序 ().主窗口.表格1.置打印表头 (编辑框_表头名称.内容, 选择 (编辑框_字体名称.内容 == "", "宋体", 编辑框_字体名称.内容), 文本到整数 (编辑框_字体尺寸.内容), 选择框_加粗.选中, 组合框_对齐方式.现行选中项 + 1))
            {
                信息框 ("设置打印表头成功")
            }
            否则
            {
                信息框 ("设置失败", 信息框按钮.错误图标, "错误：")
            }
        }
        否则 (来源对象 == 按钮_选择字体)
        {
            通用对话框1.类型 = 通用对话框类型.字体选择
            如果 (通用对话框1.打开 (本对象))
            {
                编辑框_字体名称.内容 = 通用对话框1.字体名称
            }
            否则
            {
                信息框 ("字体选择失败", 信息框按钮.错误图标, "错误")
            }
        }
        返回 (0)
    }
}

类 主窗口菜单 <公开 基础类 = 菜单类 注释 = "火山菜鸟驿站：http://www.vowm.cn" 隐藏值属性 = "0"
        @设计内容 = "1\n0\n文件(&F)\n文件\n20000\n文件\n\n0\n0\n0\n0\n0\n1\n置打印表头\n置打印表头\n20001\n设置打印表头\n\n0\n0\n0\n0\n0\n1\n显示打印按钮\n显示打印按钮\n20002\n显示打印按钮\n\n0\n0\n0\n1\n0\n1\n显示打印对话框\n显示打印对话框\n20003\n显示打印对话框\n\n0\n0\n0\n0\n0\n1\n打印缩放至页宽\n打印缩放至页宽\n20004\n\n\n0\n0\n0\n0\n0\n1\n打印\n打印\n20005\n\n\n0\n0\n0\n0\n0\n1\n打印预览\n打印预览\n20007\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n退出(&X)\n退出\n20009\n\n\n0\n0\n0\n0\n0\n0\n编辑(&E)\n编辑\n20010\n\n\n0\n0\n0\n0\n0\n1\n剪切(&X)\n剪切\n20011\n剪切\nX\n1\n0\n0\n0\n0\n1\n复制(&C)\n复制\n20012\n\nC\n1\n0\n0\n0\n0\n1\n粘贴(&V)\n粘贴\n20013\n\nV\n1\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n合并\n合并\n20014\n\n\n0\n0\n0\n0\n0\n1\n拆分\n拆分\n20015\n\n\n0\n0\n0\n0\n0\n1\n置表头行数\n置表头行数\n20016\n\n\n0\n0\n0\n0\n0\n1\n置表头列数\n置表头列数\n20017\n\n\n0\n0\n0\n0\n0\n1\n置表格行数\n置表格行数\n20018\n\n\n0\n0\n0\n0\n0\n1\n置表格列数\n置表格列数\n20019\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n置行高\n置行高\n20020\n\n\n0\n0\n0\n0\n0\n1\n置列宽\n置列宽\n20021\n\n\n0\n0\n0\n0\n0\n1\n取行高\n取行高\n20022\n\n\n0\n0\n0\n0\n0\n1\n取列宽\n取列宽\n20023\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n表格属性\n表格属性\n20024\n\n\n0\n0\n0\n0\n0\n1\n取选择区域\n取选择区域\n20028\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n跳转\n跳转\n20029\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n删除当前行\n删除当前行\n20030\n\n\n0\n0\n0\n0\n0\n1\n删除当前列\n删除当前列\n20031\n\n\n0\n0\n0\n0\n0\n1\n插入行\n插入行\n20032\n\n\n0\n0\n0\n0\n0\n1\n插入列\n插入列\n20033\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n全选(&A)\n全选\n20034\n\nA\n1\n0\n0\n0\n0\n0\n单元格(&C)\n单元格\n40000\n\n\n0\n0\n0\n0\n0\n1\n设置单元格类型\n设置单元格类型\n40001\n\n\n0\n0\n0\n0\n0\n2\n文本类型\n文本类型\n40002\n\n\n0\n0\n0\n0\n0\n2\n数值型\n数值型\n40003\n\n\n0\n0\n0\n0\n0\n2\n日期型\n日期型\n40004\n\n\n0\n0\n0\n0\n0\n2\n列表型\n列表型\n40005\n\n\n0\n0\n0\n0\n0\n2\n选择型\n选择型\n40006\n\n\n0\n0\n0\n0\n0\n2\n图片型\n图片型\n40007\n\n\n0\n0\n0\n0\n0\n2\n货币型\n货币型\n40008\n\n\n0\n0\n0\n0\n0\n1\n取单元格类型\n取单元格类型\n40009\n\n\n0\n0\n0\n0\n0\n1\n取单元格字体信息\n取单元格字体信息\n40010\n\n\n0\n0\n0\n0\n0\n1\n取单元格行高/列宽\n取单元格行高列宽\n40016\n\n\n0\n0\n0\n0\n0\n1\n单元格颜色设置\n单元格颜色设置\n40018\n\n\n0\n0\n0\n0\n0\n1\n字体\n字体\n40020\n\n\n0\n0\n0\n0\n0\n1\n边距\n边距\n40021\n\n\n0\n0\n0\n0\n0\n1\n取边距\n取边距\n40022\n\n\n0\n0\n0\n0\n0\n1\n对齐方式\n对齐方式\n40023\n\n\n0\n0\n0\n0\n0\n2\n左对齐\n左对齐\n40024\n\n\n0\n0\n0\n0\n0\n2\n居中对齐\n居中对齐\n40025\n\n\n0\n0\n0\n0\n0\n2\n右对齐\n右对齐\n40026\n\n\n0\n0\n0\n0\n0\n1\n线条\n线条\n40027\n\n\n0\n0\n0\n0\n0\n2\n添加单斜线\n添加单斜线\n40028\n\n\n0\n0\n0\n0\n0\n2\n添加双斜线\n添加双斜线\n40029\n\n\n0\n0\n0\n0\n0\n2\n添加交叉线\n添加交叉线\n40030\n\n\n0\n0\n0\n0\n0\n2\n\n\n0\n\n\n0\n0\n1\n0\n0\n2\n清除线条\n清除线条\n40032\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n日期格式\n日期格式\n40034\n\n\n0\n0\n0\n0\n0\n2\n长日期格式\n长日期格式\n40035\n\n\n0\n0\n0\n0\n0\n2\n短格式1\n短格式1\n40036\n\n\n0\n0\n0\n0\n0\n2\n短格式2\n短格式2\n40037\n\n\n0\n0\n0\n0\n0\n2\n短格式3\n短格式3\n40038\n\n\n0\n0\n0\n0\n0\n2\n美式格式1\n美式格式1\n40039\n\n\n0\n0\n0\n0\n0\n2\n美式格式2\n美式格式2\n40040\n\n\n0\n0\n0\n0\n0\n2\n美式格式3\n美式格式3\n40041\n\n\n0\n0\n0\n0\n0\n2\n美式格式4\n美式格式4\n40042\n\n\n0\n0\n0\n0\n0\n1\n货币前缀\n货币前缀\n40043\n\n\n0\n0\n0\n0\n0\n2\n人民币\n人民币\n40044\n\n\n0\n0\n0\n0\n0\n2\n美元\n美元\n40045\n\n\n0\n0\n0\n0\n0\n2\n欧元\n欧元\n40046\n\n\n0\n0\n0\n0\n0\n2\n英镑\n英镑\n40047\n\n\n0\n0\n0\n0\n0\n2\n自定义\n自定义\n40048\n\n\n0\n0\n0\n0\n0\n1\n图片显示方式\n图片显示方式\n40049\n\n\n0\n0\n0\n0\n0\n2\n平铺\n平铺\n40050\n\n\n0\n0\n0\n0\n0\n2\n拉伸\n拉伸\n40051\n\n\n0\n0\n0\n0\n0\n2\n居中\n居中\n40052\n\n\n0\n0\n0\n0\n0\n2\n左上角\n左上角\n40053\n\n\n0\n0\n0\n0\n0\n2\n自适应\n自适应\n40054\n\n\n0\n0\n0\n0\n0\n1\n小数位数\n小数位数\n40055\n\n\n0\n0\n0\n0\n0\n1\n\n\n0\n\n\n0\n0\n1\n0\n0\n1\n单行显示\n单行显示\n40058\n\n\n0\n0\n0\n1\n0\n1\n置为只读\n置为只读\n40059\n\n\n0\n0\n0\n0\n0\n1\n密码输入\n密码输入\n40062\n\n\n0\n0\n0\n0\n0">
{
    常量 文件 <公开 类型 = 整数 值 = 20000 注释 = "文件(&F)" @自动生成 = "mfc">
    常量 置打印表头 <公开 类型 = 整数 值 = 20001 注释 = "置打印表头" @自动生成 = "mfc">
    常量 显示打印按钮 <公开 类型 = 整数 值 = 20002 注释 = "显示打印按钮" @自动生成 = "mfc">
    常量 显示打印对话框 <公开 类型 = 整数 值 = 20003 注释 = "显示打印对话框" @自动生成 = "mfc">
    常量 打印缩放至页宽 <公开 类型 = 整数 值 = 20004 注释 = "打印缩放至页宽" @自动生成 = "mfc">
    常量 打印 <公开 类型 = 整数 值 = 20005 注释 = "打印" @自动生成 = "mfc">
    常量 打印预览 <公开 类型 = 整数 值 = 20007 注释 = "打印预览" @自动生成 = "mfc">
    常量 退出 <公开 类型 = 整数 值 = 20009 注释 = "退出(&X)" @自动生成 = "mfc">
    常量 编辑 <公开 类型 = 整数 值 = 20010 注释 = "编辑(&E)" @自动生成 = "mfc">
    常量 剪切 <公开 类型 = 整数 值 = 20011 注释 = "剪切(&X)" @自动生成 = "mfc">
    常量 复制 <公开 类型 = 整数 值 = 20012 注释 = "复制(&C)" @自动生成 = "mfc">
    常量 粘贴 <公开 类型 = 整数 值 = 20013 注释 = "粘贴(&V)" @自动生成 = "mfc">
    常量 合并 <公开 类型 = 整数 值 = 20014 注释 = "合并" @自动生成 = "mfc">
    常量 拆分 <公开 类型 = 整数 值 = 20015 注释 = "拆分" @自动生成 = "mfc">
    常量 置表头行数 <公开 类型 = 整数 值 = 20016 注释 = "置表头行数" @自动生成 = "mfc">
    常量 置表头列数 <公开 类型 = 整数 值 = 20017 注释 = "置表头列数" @自动生成 = "mfc">
    常量 置表格行数 <公开 类型 = 整数 值 = 20018 注释 = "置表格行数" @自动生成 = "mfc">
    常量 置表格列数 <公开 类型 = 整数 值 = 20019 注释 = "置表格列数" @自动生成 = "mfc">
    常量 置行高 <公开 类型 = 整数 值 = 20020 注释 = "置行高" @自动生成 = "mfc">
    常量 置列宽 <公开 类型 = 整数 值 = 20021 注释 = "置列宽" @自动生成 = "mfc">
    常量 取行高 <公开 类型 = 整数 值 = 20022 注释 = "取行高" @自动生成 = "mfc">
    常量 取列宽 <公开 类型 = 整数 值 = 20023 注释 = "取列宽" @自动生成 = "mfc">
    常量 表格属性 <公开 类型 = 整数 值 = 20024 注释 = "表格属性" @自动生成 = "mfc">
    常量 取选择区域 <公开 类型 = 整数 值 = 20028 注释 = "取选择区域" @自动生成 = "mfc">
    常量 跳转 <公开 类型 = 整数 值 = 20029 注释 = "跳转" @自动生成 = "mfc">
    常量 删除当前行 <公开 类型 = 整数 值 = 20030 注释 = "删除当前行" @自动生成 = "mfc">
    常量 删除当前列 <公开 类型 = 整数 值 = 20031 注释 = "删除当前列" @自动生成 = "mfc">
    常量 插入行 <公开 类型 = 整数 值 = 20032 注释 = "插入行" @自动生成 = "mfc">
    常量 插入列 <公开 类型 = 整数 值 = 20033 注释 = "插入列" @自动生成 = "mfc">
    常量 全选 <公开 类型 = 整数 值 = 20034 注释 = "全选(&A)" @自动生成 = "mfc">
    常量 单元格 <公开 类型 = 整数 值 = 40000 注释 = "单元格(&C)" @自动生成 = "mfc">
    常量 设置单元格类型 <公开 类型 = 整数 值 = 40001 注释 = "设置单元格类型" @自动生成 = "mfc">
    常量 文本类型 <公开 类型 = 整数 值 = 40002 注释 = "文本类型" @自动生成 = "mfc">
    常量 数值型 <公开 类型 = 整数 值 = 40003 注释 = "数值型" @自动生成 = "mfc">
    常量 日期型 <公开 类型 = 整数 值 = 40004 注释 = "日期型" @自动生成 = "mfc">
    常量 列表型 <公开 类型 = 整数 值 = 40005 注释 = "列表型" @自动生成 = "mfc">
    常量 选择型 <公开 类型 = 整数 值 = 40006 注释 = "选择型" @自动生成 = "mfc">
    常量 图片型 <公开 类型 = 整数 值 = 40007 注释 = "图片型" @自动生成 = "mfc">
    常量 货币型 <公开 类型 = 整数 值 = 40008 注释 = "货币型" @自动生成 = "mfc">
    常量 取单元格类型 <公开 类型 = 整数 值 = 40009 注释 = "取单元格类型" @自动生成 = "mfc">
    常量 取单元格字体信息 <公开 类型 = 整数 值 = 40010 注释 = "取单元格字体信息" @自动生成 = "mfc">
    常量 取单元格行高列宽 <公开 类型 = 整数 值 = 40016 注释 = "取单元格行高/列宽" @自动生成 = "mfc">
    常量 单元格颜色设置 <公开 类型 = 整数 值 = 40018 注释 = "单元格颜色设置" @自动生成 = "mfc">
    常量 字体 <公开 类型 = 整数 值 = 40020 注释 = "字体" @自动生成 = "mfc">
    常量 边距 <公开 类型 = 整数 值 = 40021 注释 = "边距" @自动生成 = "mfc">
    常量 取边距 <公开 类型 = 整数 值 = 40022 注释 = "取边距" @自动生成 = "mfc">
    常量 对齐方式 <公开 类型 = 整数 值 = 40023 注释 = "对齐方式" @自动生成 = "mfc">
    常量 左对齐 <公开 类型 = 整数 值 = 40024 注释 = "左对齐" @自动生成 = "mfc">
    常量 居中对齐 <公开 类型 = 整数 值 = 40025 注释 = "居中对齐" @自动生成 = "mfc">
    常量 右对齐 <公开 类型 = 整数 值 = 40026 注释 = "右对齐" @自动生成 = "mfc">
    常量 线条 <公开 类型 = 整数 值 = 40027 注释 = "线条" @自动生成 = "mfc">
    常量 添加单斜线 <公开 类型 = 整数 值 = 40028 注释 = "添加单斜线" @自动生成 = "mfc">
    常量 添加双斜线 <公开 类型 = 整数 值 = 40029 注释 = "添加双斜线" @自动生成 = "mfc">
    常量 添加交叉线 <公开 类型 = 整数 值 = 40030 注释 = "添加交叉线" @自动生成 = "mfc">
    常量 清除线条 <公开 类型 = 整数 值 = 40032 注释 = "清除线条" @自动生成 = "mfc">
    常量 日期格式 <公开 类型 = 整数 值 = 40034 注释 = "日期格式" @自动生成 = "mfc">
    常量 长日期格式 <公开 类型 = 整数 值 = 40035 注释 = "长日期格式" @自动生成 = "mfc">
    常量 短格式1 <公开 类型 = 整数 值 = 40036 注释 = "短格式1" @自动生成 = "mfc">
    常量 短格式2 <公开 类型 = 整数 值 = 40037 注释 = "短格式2" @自动生成 = "mfc">
    常量 短格式3 <公开 类型 = 整数 值 = 40038 注释 = "短格式3" @自动生成 = "mfc">
    常量 美式格式1 <公开 类型 = 整数 值 = 40039 注释 = "美式格式1" @自动生成 = "mfc">
    常量 美式格式2 <公开 类型 = 整数 值 = 40040 注释 = "美式格式2" @自动生成 = "mfc">
    常量 美式格式3 <公开 类型 = 整数 值 = 40041 注释 = "美式格式3" @自动生成 = "mfc">
    常量 美式格式4 <公开 类型 = 整数 值 = 40042 注释 = "美式格式4" @自动生成 = "mfc">
    常量 货币前缀 <公开 类型 = 整数 值 = 40043 注释 = "货币前缀" @自动生成 = "mfc">
    常量 人民币 <公开 类型 = 整数 值 = 40044 注释 = "人民币" @自动生成 = "mfc">
    常量 美元 <公开 类型 = 整数 值 = 40045 注释 = "美元" @自动生成 = "mfc">
    常量 欧元 <公开 类型 = 整数 值 = 40046 注释 = "欧元" @自动生成 = "mfc">
    常量 英镑 <公开 类型 = 整数 值 = 40047 注释 = "英镑" @自动生成 = "mfc">
    常量 自定义 <公开 类型 = 整数 值 = 40048 注释 = "自定义" @自动生成 = "mfc">
    常量 图片显示方式 <公开 类型 = 整数 值 = 40049 注释 = "图片显示方式" @自动生成 = "mfc">
    常量 平铺 <公开 类型 = 整数 值 = 40050 注释 = "平铺" @自动生成 = "mfc">
    常量 拉伸 <公开 类型 = 整数 值 = 40051 注释 = "拉伸" @自动生成 = "mfc">
    常量 居中 <公开 类型 = 整数 值 = 40052 注释 = "居中" @自动生成 = "mfc">
    常量 左上角 <公开 类型 = 整数 值 = 40053 注释 = "左上角" @自动生成 = "mfc">
    常量 自适应 <公开 类型 = 整数 值 = 40054 注释 = "自适应" @自动生成 = "mfc">
    常量 小数位数 <公开 类型 = 整数 值 = 40055 注释 = "小数位数" @自动生成 = "mfc">
    常量 单行显示 <公开 类型 = 整数 值 = 40058 注释 = "单行显示" @自动生成 = "mfc">
    常量 置为只读 <公开 类型 = 整数 值 = 40059 注释 = "置为只读" @自动生成 = "mfc">
    常量 密码输入 <公开 类型 = 整数 值 = 40062 注释 = "密码输入" @自动生成 = "mfc">
    常量 _最小值 <公开 类型 = 整数 值 = 20000 注释 = "所有ID值中的最小值" @自动生成 = "mfc">
    常量 _最大值 <公开 类型 = 整数 值 = 40062 注释 = "所有ID值中的最大值" @自动生成 = "mfc">
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序 <"">

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <公开 类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"416, 429\"" "">
{
    变量 增强树形框1 <类型 = 增强树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"5, 62, 168, 352\"" 显示连线 = 真 显示根部线 = 真
            始终显示选择项 = 真
            项目 = "根项目1\n0\n-1\n0\n0\n1\n0\n1\n子项目1\n0\n-1\n0\n0\n1\n0\n2\n子子项目1\n0\n-1\n0\n0\n0\n0\n3\n子子项目2\n0\n-1\n0\n0\n0\n0\n3\n子子项目3\n0\n-1\n0\n0\n0\n0\n3\n子子项目4\n0\n-1\n0\n0\n0\n0\n3\n子项目2\n0\n-1\n0\n0\n1\n0\n2\n子子项目5\n0\n-1\n0\n0\n0\n0\n3\n子子项目6\n0\n-1\n0\n0\n0\n0\n3\n根项目2\n0\n-1\n0\n0\n1\n0\n1\n子项目3\n0\n-1\n0\n0\n0\n0\n2\n子项目4\n0\n-1\n0\n0\n1\n0\n2\n子项目5\n0\n-1\n0\n0\n1\n0\n3\n子项目6\n0\n-1\n0\n0\n0\n0\n4">
    变量 按钮1 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"21, 6, 128, 40\"" 标题 = "枚举">
    变量 编辑框1 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"189, 62, 200, 352\"" 是否允许多行 = 真
            滚动条 = 纵向滚动条>

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮1)
        {
            变量 根项目 <类型 = 变整数>
            根项目 = 增强树形框1.取根项目 ()
            枚举项目 (根项目)
        }
        返回 (0)
    }

    方法 取兄弟项目 <类型 = 逻辑型 折叠>
    参数 兄弟索引 <类型 = 变整数>
    {
        变量 兄弟项目 <类型 = 变整数>
        兄弟项目 = 增强树形框1.取后兄弟项目 (兄弟索引)
        如果 (兄弟项目 == 0)
        {
            返回 (假)
        }
        判断循环 (兄弟项目 != 0)
        {
            如果 (枚举项目 (兄弟项目) == 0)
            {
                返回 (假)
            }
            兄弟项目 = 增强树形框1.取后兄弟项目 (兄弟项目)
            如果 (兄弟项目 == 0)
            {
                返回 (假)
            }
        }
        返回 (真)
    }

    方法 枚举项目 <类型 = 变整数>
    参数 项目句柄 <类型 = 变整数>
    {
        变量 子项目句柄 <类型 = 变整数>
        变量 缩进层次 <类型 = 整数>
        缩进层次 = 增强树形框1.取缩进层次 (项目句柄)
        编辑框1.加入文本行 (选择 (缩进层次 == 1, "", 取空白文本 (缩进层次 * 2)) + 增强树形框1.取项目文本 (项目句柄))
        子项目句柄 = 项目句柄
        如果 (增强树形框1.是否有子项目 (子项目句柄))
        {
            子项目句柄 = 枚举项目 (增强树形框1.取首子项目 (子项目句柄))
        }
        否则
        {
            子项目句柄 = 项目句柄
        }
        如果 (取兄弟项目 (项目句柄))
        {
            返回 (子项目句柄)
        }
        返回 (0)


    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 注释 = "客户端和服务器通讯发送列表框内容并接收" 注释 = "" 注释 = "注意：这个操作其实不正规，仅供参考演示，请勿用于实际项目中。" 注释 = ""
        注释 = "正规操作：服务器从数据库获取数据发送给客户端，而不是从组件中获取数据发送。" @视窗.布局 = "client_size = \"629, 501\"" 标题 = "我的主窗口">
{
    变量 超级列表框1 <类型 = 超级列表框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"21, 38, 584, 408\""
            报表列 = "0\n-1\n0\n100\n姓名\n0\n-1\n0\n80\n年龄\n0\n-1\n0\n80\n成绩" "类型" = 报表列表框
            表项 = "0\n-1\n-1\n0\n0\n小明\n\n1\n-1\n-1\n0\n0\n19\n\n1\n-1\n-1\n0\n0\n100\n\n0\n-1\n-1\n0\n0\n小红\n\n1\n-1\n-1\n0\n0\n19\n\n1\n-1\n-1\n0\n0\n98\n">
    变量 服务器1 <类型 = HP_PACK服务器>

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (服务器1.启动 ("127.0.0.1", 6666))
        {
            标题 = "服务器启动成功"
        }
        返回 (0)
    }

    方法 HP_PACK服务器_客户进入 <接收事件 类型 = 整数 注释 = "  当客户连接到服务器后,将会触发本事件,请注意,本事件下的连接并非是正式连接,"
            注释 = "只有该连接通过\"完成握手\"事件,才可以与服务器建立正式连接,本事件返回值拥有具体意义,请参考返回值说明." 返回值注释 = "可选返回值:"
            返回值注释 = "  0 = 本次操作成功, 将触发\"完成握手\"事件." 返回值注释 = "  1 = 忽略本次操作, 将触发\"完成握手\"事件."
            返回值注释 = "  2 = 本次操作错误, 服务器主动与当前连接ID断开连接." 折叠2>
    参数 来源对象 <类型 = HP_PACK服务器 注释 = "提供事件产生的具体来源对象" 折叠>
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数>
    {
        如果 (来源对象 == 服务器1)
        {
            服务器1.发送数据 (连接ID, 超级列表框到json (超级列表框1).到字节集 ())
        }
        返回 (0)
    }

    方法 超级列表框到json <类型 = JSON数组类>
    参数 参列表框 <类型 = 超级列表框>
    {
        变量 数组 <类型 = JSON数组类>
        计次循环 (参列表框.取表项数 ())
        {
            变量 表项索引 <类型 = 整数>
            表项索引 = 取循环索引 ()
            变量 对象 <类型 = JSON对象类>
            计次循环 (参列表框.取列数 ())
            {
                对象.置入文本值 (参列表框.取列标题 (取循环索引 ()), 参列表框.取标题 (表项索引, 取循环索引 ()))
            }
            数组.置入对象值 (对象)
        }
        调试输出 (数组.到可读文本 ())
        返回 (数组)

    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "客户端和服务器通讯发送列表框内容并接收" 注释 = "" 注释 = "注意：这个操作其实不正规，仅供参考演示，请勿用于实际项目中。" 注释 = ""
        注释 = "正规操作：服务器从数据库获取数据发送给客户端，而不是从组件中获取数据发送。" @视窗.布局 = "client_size = \"641, 510\"" 标题 = "我的主窗口">
{
    变量 超级列表框1 <类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"21, 38, 584, 408\""
            报表列 = "0\n-1\n0\n100\n姓名\n0\n-1\n0\n80\n年龄\n0\n-1\n0\n80\n成绩" "类型" = 报表列表框>
    变量 客户端1 <类型 = HP_PACK客户端>

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        客户端1.启动 ("127.0.0.1", 6666)
        返回 (0)
    }

    方法 HP_PACK客户端_数据进入 <接收事件 类型 = 整数 注释 = "当通信组件成功接收数据后将触发本事件." 注释 = "注意:仅在当前组件接收完整个数据包本事件才会触发(PACK模型)."
            返回值注释 = "可选返回值:" 返回值注释 = "  0 = 本次操作成功, 继续执行." 返回值注释 = "  1 = 忽略本次操作."
            返回值注释 = "  2 = 本次操作错误, 服务器主动与当前连接ID断开连接并触发关闭事件." 折叠2>
    参数 来源对象 <类型 = HP_PACK客户端 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数 注释 = "接收到的数据由该连接ID发过来.">
    参数 数据 <类型 = 字节集类 注释 = "所接收到的完整数据.">
    参数 数据长度 <类型 = 整数 注释 = "所接收完整数据的长度.">
    {
        如果 (来源对象 == 客户端1)
        {
            变量 数组 <类型 = JSON数组类>
            数组.创建自字节集 (数据)
            计次循环 (数组.成员数)
            {
                变量 对象 <类型 = JSON对象类>
                数组.取对象值 (取循环索引 (), 对象)
                变量 表项 <类型 = 整数>
                表项 = 超级列表框1.插入表项 (, 对象.取文本值 ("姓名"))
                超级列表框1.置标题 (表项, 1, 对象.取文本值 ("年龄"))
                超级列表框1.置标题 (表项, 2, 对象.取文本值 ("成绩"))

            }

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 标题 = "TCP客户端" @视窗.布局 = "client_size = \"563, 361\"">
{
    变量 按钮_发送文件 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"413, 288, 112, 32\"" 横向对齐方式 = 居中
            纵向对齐方式 = 居中 "类型" = 通常 标题 = "发送文件">
    变量 编辑框_接收数据 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"269, 33, 264, 130\"" 是否允许多行 = 真
            滚动条 = 纵向滚动条 输入方式 = 只读方式>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"269, 9, 136, 24\"" 横向对齐方式 = 左边
            纵向对齐方式 = 居中 标题 = "已接收数据文本：">
    变量 编辑框_要发送的数据 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"269, 195, 264, 80\"" 是否允许多行 = 真>
    变量 按钮_发送文本 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"277, 288, 112, 32\"" 横向对齐方式 = 居中
            纵向对齐方式 = 居中 "类型" = 通常 标题 = "发送内容">
    变量 标签6 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"269, 171, 152, 24\"" 横向对齐方式 = 左边
            纵向对齐方式 = 居中 标题 = "待发送文本数据：">
    变量 分组框1 <类型 = 分组框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"13, 16, 232, 280\"" 标题 = "连接服务器">
    变量 编辑框_端口 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\nparent_id = 107\r\npos = \"56, 88, 160, 32\""
            输入方式 = 输入短整数 内容 = "999">
    变量 按钮_连接 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\nparent_id = 107\r\npos = \"64, 136, 112, 40\""
            标题 = "连接服务器">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\nparent_id = 107\r\npos = \"12, 43, 40, 32\""
            标题 = "地址：">
    变量 编辑框_IP地址 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\nparent_id = 107\r\npos = \"56, 45, 160, 32\""
            内容 = "192.168.2.193">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\nparent_id = 107\r\npos = \"12, 88, 40, 32\""
            标题 = "端口：">
    变量 进度条1 <类型 = 进度条 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"6, 332, 552, 22\"" 方向 = 横向 显示方式 = 连续>
    变量 ""
    变量 客户端1 <类型 = HP_TCP客户端>

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        创建目录 (取运行目录 () + "文件接收")
        返回 (0)
    }

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮_连接)
        {
            如果 (客户端1.启动 (编辑框_IP地址.内容, (短整数)文本到整数 (编辑框_端口.内容)) == 假)
            {
                信息框 ("连接失败", 信息框按钮.错误图标, "提示")
            }
        }
        否则 (来源对象 == 按钮_发送文件)
        {
            如果 (客户端1.是否已启动)
            {
                变量 浏览文件 <类型 = 通用对话框 "类型" = 打开文件>
                如果真 (浏览文件.打开 (本对象))
                {
                    如果真 (浏览文件.文件名 != "")
                    {
                        发送文件 = 真
                        累积数据长度 = 0
                        要发送的文件字节 = 生成要发送的文件 (浏览文件.文件名)
                        客户端1.发送数据 (要发送的文件字节)
                    }
                }
            }
            否则
            {
                信息框 ("需要先连接服务器")
            }
        }
        否则 (来源对象 == 按钮_发送文本)
        {
            发送文件 = 假
            如果 (客户端1.是否已启动)
            {
                如果 (文本是否为空 (编辑框_要发送的数据.内容))
                {
                    信息框 ("发送的内容不能为空！")
                }
                否则
                {
                    调试输出 ("正在给服务器发送数据")
                    客户端1.发送数据 (生成要发送的文本数据 (编辑框_要发送的数据.内容))
                }
            }
            否则
            {
                信息框 ("需要先连接服务器")
            }
        }
        返回 (0)
    }

    方法 HP_TCP客户端_连接完成 <接收事件 类型 = 整数 注释 = "与服务端成功建立连接时本事件将被触发." 返回值注释 = "可选返回值:"
            返回值注释 = "  0 = 本次操作成功, 继续执行." 返回值注释 = "  1 = 忽略本次操作, 继续执行."
            返回值注释 = "  2 = 本次操作错误, 如果为同步连接将终止启动通信客户端,为异步则会关闭连接." 折叠>
    参数 来源对象 <类型 = HP_TCP客户端 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数>
    {
        调试输出 ("连接完毕")
        返回 (0)
    }

    变量 发送文件 <类型 = 逻辑型>
    变量 要发送的文件字节 <类型 = 字节集类>
    变量 累积数据长度 <类型 = 整数>

    方法 HP_TCP客户端_发送完毕 <接收事件 类型 = 整数 注释 = "当客户端向当前连接发送数据成功后,将触发本事件.">
    参数 来源对象 <类型 = HP_TCP客户端 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数 注释 = "接收本次发送所对应的连接ID.">
    参数 数据 <类型 = 字节集类 注释 = "本次所发送的数据.">
    参数 数据长度 <类型 = 整数 注释 = "所发送数据的长度.">
    {
        如果 (发送文件)
        {
            累积数据长度 = 累积数据长度 + 数据长度
            进度条1.位置 = 100 * 累积数据长度 / 要发送的文件字节.取字节集长度 ()
            编辑框_接收数据.加入文本行 ("正在发送：" + 到文本 (四舍五入 (100.00 * (小数)累积数据长度 / (小数)要发送的文件字节.取字节集长度 (), 2)))
            调试输出 (要发送的文件字节.取字节集长度 (), 累积数据长度)
            如果 (累积数据长度 == 要发送的文件字节.取字节集长度 ())
            {
                进度条1.位置 = 100
            }
        }
        返回 (0)
    }

    变量 数据总字节 <类型 = 字节集类>

    方法 HP_TCP客户端_数据进入 <接收事件 类型 = 整数 注释 = "当客户端成功接收数据后将触发本事件." 返回值注释 = "可选返回值:"
            返回值注释 = "  0 = 本次操作成功, 继续执行." 返回值注释 = "  1 = 忽略本次操作."
            返回值注释 = "  2 = 本次操作错误, 服务器主动与当前连接ID断开连接并触发关闭事件." 折叠>
    参数 来源对象 <类型 = HP_TCP客户端 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数 注释 = "接收到的数据由该连接ID发过来.">
    参数 已接收数据 <类型 = 字节集类 注释 = "所接收到的数据.">
    参数 已接收长度 <类型 = 整数 注释 = "已接收数据长度.">
    {
        数据总字节.插入字节集 (数据总字节.取字节集长度 (), 已接收数据)
        变量 标记头 <类型 = 整数>
        标记头 = 取字节集数据 (数据总字节, , 整数)
        如果 (标记头 == 发送类型_文本)
        {
            // 文件头类型 + 要发送的数据长度 +  实际文本内容
            变量 文本数据长度 <类型 = 整数 编辑时信息 = "34B48, 0, 0, 0">
            文本数据长度 = 取字节集数据 (数据总字节, 4, 整数)
            变量 字节内容 <类型 = 字节集类>
            字节内容 = 取字节集右边 (数据总字节, 数据总字节.取字节集长度 () - 8)
            如果 (文本数据长度 == 字节内容.取字节集长度 ())
            {
                编辑框_接收数据.加入文本行 ("数据内容 -- >  " + 字节集到文本 (字节内容))
                数据总字节.清空字节集 ()
            }
        }
        否则 (标记头 == 发送类型_文件)
        {
            // 文件头  要发送的数据长度(后面3个长度)  实际文件尺寸   文件名    实际文件
            变量 实际接收长度 <类型 = 整数>
            实际接收长度 = 取字节集数据 (数据总字节, 4, 整数)

            进度条1.位置 = 100 * 数据总字节.取字节集长度 () / 实际接收长度
            编辑框_接收数据.加入文本行 ("正在接收：" + 到文本 (四舍五入 (100.00 * (小数)数据总字节.取字节集长度 () / (小数)实际接收长度, 2)))
            // 设置接收进度

            如果 (实际接收长度 == 数据总字节.取字节集长度 () - 8 || 实际接收长度 == 数据总字节.取字节集长度 () - 12)
            {
                进度条1.位置 = 100
                // -8是因为发送的小文件没有带hp自己的头,-12是因为hp带自己的头了。
                变量 文件名 <类型 = 文本型>
                变量 实际文件长度 <类型 = 整数>
                变量 结果数组 <类型 = 文本数组类>
                分割文本 (取字节集数据 (数据总字节, 12, 文本型), "\n", 结果数组)
                文件名 = 结果数组.取成员 (0)
                实际文件长度 = 取字节集数据 (数据总字节, 8, 整数)
                调试输出 (" --> 接收完毕：" + 文件名)
                如果 (文件是否存在 (取运行目录 () + "文件接收\\" + 文件名))
                {
                    写到文件 (取运行目录 () + "文件接收\\" + 到文本 (取时间戳 (取现行时间 ())) + 文件名, 取字节集右边 (数据总字节, 实际文件长度))
                }
                否则
                {
                    写到文件 (取运行目录 () + "文件接收\\" + 文件名, 取字节集右边 (数据总字节, 实际文件长度))
                }
                浏览选中文件 (取运行目录 () + "文件接收\\" + 文件名)
                数据总字节.清空字节集 ()
            }
        }
        返回 (0)
    }

    方法 生成要发送的文件 <类型 = 字节集类>
    参数 文件路径 <类型 = 文本型>
    {
        // 文件头  要发送的数据长度(后面3个长度)  实际文件尺寸   文件名    实际文件
        变量 要发送的字节集 <类型 = 字节集类>
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (发送类型_文件))

        变量 要发送的文件 <类型 = 字节集类>
        要发送的文件 = 读入文件 (文件路径)
        变量 文件长度 <类型 = 整数>
        文件长度 = 取字节集长度 (要发送的文件)

        变量 文件名 <类型 = 字节集类>
        文件名 = 到字节集 (取文件名无路径部分 (文件路径) + "\n")

        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (文件长度 + 文件名.取字节集长度 () + 4))
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (文件长度))
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 文件名)
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 要发送的文件)

        返回 (要发送的字节集)

    }

    常量 发送类型_文本 <类型 = 整数 值 = 1111>
    常量 发送类型_文件 <类型 = 整数 值 = 2222>

    方法 生成要发送的文本数据 <类型 = 字节集类 注释 = "火山无名菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 待发送数据 <类型 = 文本型>
    {
        // 文件头类型 + 要发送的数据长度 +  实际文本内容
        变量 文本字节集 <类型 = 字节集类>
        文本字节集 = 到字节集 (待发送数据)
        变量 要发的数据 <类型 = 字节集类>
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 到字节集 (发送类型_文本))
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 到字节集 (取字节集长度 (文本字节集)))
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 文本字节集)
        返回 (要发的数据)
    }

    方法 我的主窗口_将被销毁 <接收事件 类型 = 整数 注释 = "当本组件被销毁前发送此事件">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        客户端1.停止 ()
        返回 (0)
    }

    方法 HP_TCP客户端_通信发生错误 <接收事件 类型 = 整数 注释 = "当客户端主动或被动与服务器断开后将触发本事件.">
    参数 来源对象 <类型 = HP_TCP客户端 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 连接ID <类型 = 变整数 注释 = "触发该事件的连接ID.">
    参数 关闭原因 <类型 = HP操作类型 注释 = "返回导致连接被关闭的操作.">
    参数 错误码 <类型 = HP错误码 注释 = "如果客户端为非正常退出,此参数为错误代码.">
    {
        调试输出 ("通讯错误")
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.无名.菜鸟驿站 <注释 = "火山无名菜鸟驿站：http://www.vowm.cn">

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = TCP服务器窗口>

    方法 启动方法 <公开 类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn">
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

类 TCP服务器窗口 <基础类 = 窗口 注释 = "" 注释 = "火山无名菜鸟驿站：http://www.vowm.cn" @视窗.布局 = "client_size = \"516, 329\""
        标题 = "TCP服务器">
{
    变量 按钮_发送文件 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"381, 288, 112, 32\"" 横向对齐方式 = 居中
            纵向对齐方式 = 居中 "类型" = 通常 标题 = "发送文件">
    变量 列表框_客户列表 <类型 = 列表框 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"5, 30, 208, 290\"">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"5, 6, 112, 24\"" 横向对齐方式 = 居中 纵向对齐方式 = 居中
            标题 = "已连接客户端">
    变量 编辑框_接收数据 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"237, 33, 264, 130\"" 是否允许多行 = 真
            滚动条 = 纵向滚动条 输入方式 = 只读方式>
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"237, 9, 136, 24\"" 横向对齐方式 = 左边
            纵向对齐方式 = 居中 标题 = "已接收数据文本：">
    变量 编辑框_要发送的数据 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"237, 195, 264, 80\"" 是否允许多行 = 真>
    变量 按钮_发送文本 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"245, 288, 112, 32\"" 横向对齐方式 = 居中
            纵向对齐方式 = 居中 "类型" = 通常 标题 = "发送内容">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"237, 171, 152, 24\"" 横向对齐方式 = 左边
            纵向对齐方式 = 居中 标题 = "待发送文本数据：">
    变量 服务器1 <类型 = HP_TCP服务器>

    方法 TCP服务器窗口_创建完毕 <接收事件 类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn">
    参数 来源对象 <类型 = TCP服务器窗口>
    参数 标记值 <类型 = 整数>
    {
        创建目录 (取运行目录 () + "文件接收")

        如果 (服务器1.启动 (HPSocket类.取主机IP地址 ().取成员 (0), 999))  // 默认使用本机地址,监听端口999
        {
            调试输出 ("服务器正在启动")
        }
        否则
        {
            调试输出 ("TCP服务器启动错误：" + 到文本 (HPSocket类.取上次错误码 ()))
        }
        返回 (0)
    }

    方法 TCP服务器窗口_将被销毁 <接收事件 类型 = 整数 折叠>
    参数 来源对象 <类型 = TCP服务器窗口>
    参数 标记值 <类型 = 整数>
    {
        服务器1.停止 ()
        返回 (0)
    }

    方法 HP_TCP服务器_客户进入 <接收事件 类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 来源对象 <类型 = HP_TCP服务器>
    参数 标记值 <类型 = 整数>
    参数 客户ID <类型 = 变整数>
    {
        调试输出 ("有客户进入 ID->>>>>" + 到文本 (客户ID))
        变量 客户IP <类型 = 文本型>
        来源对象.取客户远程地址 (客户ID, 客户IP)
        调试输出 (客户IP)
        列表框_客户列表.加入项目 ("客户端" + 到文本 (客户ID) + " - " + 客户IP + 到文本 (来源对象.取客户远程端口 (客户ID)), 客户ID)
        返回 (0)
    }

    方法 HP_TCP服务器_客户离开 <接收事件 类型 = 整数 折叠>
    参数 来源对象 <类型 = HP_TCP服务器>
    参数 标记值 <类型 = 整数>
    参数 客户ID <类型 = 变整数>
    参数 关闭原因 <类型 = HP操作类型>
    参数 错误码 <类型 = HP错误码>
    {
        调试输出 ("客户断开 ID->>>>>" + 到文本 (客户ID))
        列表框_客户列表.删除项目 (客户ID找列表索引 (客户ID))
        返回 (0)
    }

    方法 客户ID找列表索引 <类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 ID <类型 = 变整数>
    {
        变量 i <类型 = 整数>
        循环 (, 列表框_客户列表.取项目数 (), i)
        {
            如果 (列表框_客户列表.取项目数值 (i) == ID)
            {
                返回 (i)
            }
        }
        返回 (-1)
    }

    变量 数据总字节 <类型 = 字节集类>

    常量 发送类型_文本 <类型 = 整数 值 = 1111>
    常量 发送类型_文件 <类型 = 整数 值 = 2222>

    方法 HP_TCP服务器_数据进入 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = HP_TCP服务器>
    参数 标记值 <类型 = 整数>
    参数 客户ID <类型 = 变整数>
    参数 已接收数据 <类型 = 字节集类>
    参数 已接收长度 <类型 = 整数>
    {
        数据总字节.插入字节集 (数据总字节.取字节集长度 (), 已接收数据)
        变量 标记头 <类型 = 整数>
        标记头 = 取字节集数据 (数据总字节, , 整数)
        如果 (标记头 == 发送类型_文本)
        {
            // 文件头类型 + 要发送的数据长度 +  实际文本内容
            变量 文本数据长度 <类型 = 整数>
            文本数据长度 = 取字节集数据 (数据总字节, 4, 整数)
            变量 字节内容 <类型 = 字节集类>
            字节内容 = 取字节集右边 (数据总字节, 数据总字节.取字节集长度 () - 8)
            如果 (文本数据长度 == 字节内容.取字节集长度 ())
            {
                输出到编辑框 ("数据内容 -- >  " + 字节集到文本 (字节内容))
                数据总字节.清空字节集 ()
            }
        }
        否则 (标记头 == 发送类型_文件)
        {
            // 文件头  要发送的数据长度(后面3个长度)  实际文件尺寸   文件名    实际文件
            变量 实际发送长度 <类型 = 整数>
            实际发送长度 = 取字节集数据 (数据总字节, 4, 整数)
            如果 (实际发送长度 == 数据总字节.取字节集长度 () - 8 || 实际发送长度 == 数据总字节.取字节集长度 () - 12)
            {
                // -8是因为发送的小文件没有带hp自己的头,-12是因为hp带自己的头了。
                变量 文件名 <类型 = 文本型>
                变量 实际文件长度 <类型 = 整数>
                变量 结果数组 <类型 = 文本数组类>
                分割文本 (取字节集数据 (数据总字节, 12, 文本型), "\n", 结果数组)
                文件名 = 结果数组.取成员 (0)
                实际文件长度 = 取字节集数据 (数据总字节, 8, 整数)
                输出到编辑框 (" --> 接收完毕：" + 文件名)
                如果 (文件是否存在 (取运行目录 () + "文件接收\\" + 文件名))
                {
                    写到文件 (取运行目录 () + "文件接收\\" + 到文本 (取时间戳 (取现行时间 ())) + 文件名, 取字节集右边 (数据总字节, 实际文件长度))
                }
                否则
                {
                    写到文件 (取运行目录 () + "文件接收\\" + 文件名, 取字节集右边 (数据总字节, 实际文件长度))
                }
                浏览选中文件 (取运行目录 () + "文件接收\\" + 文件名)
                数据总字节.清空字节集 ()
            }
        }
        返回 (0)
    }

    方法 输出到编辑框 <注释 = "火山无名菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 内容 <类型 = 文本型>
    {
        编辑框_接收数据.加入文本行 (内容)
    }

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn">
    参数 来源对象 <类型 = 按钮>
    参数 标记值 <类型 = 整数>
    {
        如果 (列表框_客户列表.现行选中项 < 0)
        {
            信息框 ("请选择一个客户")
            返回 (0)
        }
        如果 (来源对象 == 按钮_发送文本)
        {
            如果 (文本是否为空 (编辑框_要发送的数据.内容))
            {
                信息框 ("发送的内容不能为空！")
            }
            否则
            {
                调试输出 ("正在给客户" + 列表框_客户列表.取项目文本 (列表框_客户列表.现行选中项) + "发送数据")
                服务器1.发送数据 (列表框_客户列表.取项目数值 (列表框_客户列表.现行选中项), 生成要发送的文本数据 (编辑框_要发送的数据.内容))

            }
        }
        否则 (来源对象 == 按钮_发送文件)
        {
            变量 浏览文件 <类型 = 通用对话框 "类型" = 打开文件>
            如果真 (浏览文件.打开 (本对象))
            {
                如果真 (浏览文件.文件名 != "")
                {
                    服务器1.发送数据 (列表框_客户列表.取项目数值 (列表框_客户列表.现行选中项), 生成要发送的文件 (浏览文件.文件名))

                }
            }
        }
        返回 (0)
    }

    方法 生成要发送的文件 <类型 = 字节集类 折叠>
    参数 文件路径 <类型 = 文本型>
    {
        // 文件头  要发送的数据长度(后面3个长度)  实际文件尺寸   文件名    实际文件
        变量 要发送的字节集 <类型 = 字节集类>
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (发送类型_文件))
        变量 要发送的文件 <类型 = 字节集类>
        要发送的文件 = 读入文件 (文件路径)
        变量 文件长度 <类型 = 整数>
        文件长度 = 取字节集长度 (要发送的文件)
        变量 文件名 <类型 = 字节集类>
        文件名 = 文本到字节集 (取文件名无路径部分 (文件路径) + "\n")
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (文件长度 + 文件名.取字节集长度 () + 4))
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 到字节集 (文件长度))
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 文件名)
        要发送的字节集.插入字节集 (要发送的字节集.取字节集长度 (), 要发送的文件)
        调试输出 (要发送的字节集.取字节集长度 (), 文件名.取字节集长度 (), 文件长度)
        返回 (要发送的字节集)
    }

    方法 生成要发送的文本数据 <类型 = 字节集类 注释 = "火山无名菜鸟驿站：http://www.vowm.cn" 折叠>
    参数 待发送数据 <类型 = 文本型>
    {
        // 文件头类型 + 要发送的数据长度 +  实际文本内容
        变量 文本字节集 <类型 = 字节集类>
        文本字节集 = 到字节集 (待发送数据)
        变量 要发的数据 <类型 = 字节集类>
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 到字节集 (发送类型_文本))
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 到字节集 (取字节集长度 (文本字节集)))
        要发的数据.插入字节集 (要发的数据.取字节集长度 (), 文本字节集)
        返回 (要发的数据)
    }

    方法 HP_TCP服务器_启动完毕 <接收事件 类型 = 整数 折叠>
    参数 来源对象 <类型 = HP_TCP服务器>
    参数 标记值 <类型 = 整数>
    {
        调试输出 ("服务器已启动完毕")
        返回 (0)
    }

    方法 HP_TCP服务器_服务器被关闭 <接收事件 类型 = 整数 注释 = "火山无名菜鸟驿站：http://www.vowm.cn">
    参数 来源对象 <类型 = HP_TCP服务器>
    参数 标记值 <类型 = 整数>
    {
        调试输出 ("服务器已被关闭")
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类 @视窗.附属文件 = "..\\SCDLL32.dll" @视窗.附属文件 = "..\\Ry4S.dll">
{
    变量 "//主窗口对象" <类型 = 类_欢迎窗口 标题 = "我的主窗口">
    变量 窗口_欢迎窗口 <公开 类型 = 类_欢迎窗口>
    变量 窗口_登录窗口 <公开 类型 = 类_登录窗口>
    变量 窗口_主界面窗口 <公开 类型 = 类_主窗口 标题 = "简易进销存">
    变量 "//窗口_供应商管理" <公开 类型 = 类_供应商管理>
    变量 数据库_全局ACCESS库 <公开 类型 = 数据库类>
    变量 "//窗口_商品管理" <公开 类型 = 类_商品管理>
    变量 "//窗口_客户管理" <公开 类型 = 类_客户管理>
    变量 数据库_全局Mysql库 <公开 类型 = Mysql数据库类>
    变量 "//窗口_进货管理" <公开 类型 = 类_进货管理>
    变量 "//窗口_进货下单" <公开 类型 = 类_进货下单>
    变量 窗口_销售管理 <公开 类型 = 类_销售管理>
    变量 窗口_销售下单 <公开 类型 = 类_销售下单>
    变量 窗口_库存管理 <公开 类型 = 类_库存管理>
    变量 窗口_盘点列表 <公开 类型 = 类_盘点列表>
    变量 窗口_库存盘点 <公开 类型 = 类_库存盘点>
    变量 窗口_图表统计 <公开 类型 = 类_图表统计>
    变量 窗口_导入导出 <公开 类型 = 类_导入导出>
    变量 窗口_锐浪报表 <公开 类型 = 类_锐浪报表>
    变量 窗口_硬件接入 <公开 类型 = 类_硬件接入>
    变量 全局_用户名 <公开 类型 = 文本型>
    变量 全局_权限 <公开 类型 = 文本型>

    方法 启动方法 <公开 类型 = 整数>
    {

        变量 局部_一个人 <类型 = 人类 折叠>
        变量 局部_另一个人 <静态 类型 = 人类>
        变量 局部_一只鸟 <类型 = 禽类>
        变量 局部_一条狼 <类型 = 食肉动物类>
        变量 局部_一头牛 <类型 = 食草动物类>
        变量 局部_一棵树 <类型 = 植物类>
        变量 局部_周总理 <类型 = 人类>
        // 局部_一棵树.是否在地球 = 真
        // 局部_一个人.姓名 = "张三"
        // 局部_一只鸟.年龄 = 2
        // 局部_一条狼.体重 = 60.5
        // 局部_一头牛.几只脚 = 4
        // 局部_另一个人.是否在地球 = 假
        // // 局部_另一个人.
        // 调试输出 ("一头牛吃:" + 局部_一头牛.吃 ())
        // 调试输出 ("一只鸟吃:" + 局部_一只鸟.吃 ())
        // 调试输出 ("一个人吃:" + 局部_一个人.吃 ())
        // 调试输出 ("一条狼吃:" + 局部_一条狼.吃 ())

        // 调试输出 ("有一个人学习的目的:" + 局部_一个人.学习 ("挣钱"))
        // 调试输出 ("有另一个人学习的目的:" + 局部_一个人.学习 ("提升自己"))
        // 调试输出 ("周总理学习的目的:" + 局部_一个人.学习 ("中华之崛起"))
        // 窗口_进货管理.创建主窗口 (, , , , )

        // 返回 (1)

        // 生物类.是否在地球 = 真
        // 窗口_进货下单.创建主窗口 (, , , , )
        // 窗口_硬件接入.创建主窗口 (, , , , )
        // 部件类_系统设置.外部接口_菜单MDI ()
        // 返回 (1)


        类_全局变量.成员_当前用户 = "超级管理员"
        // 类_全局变量.关闭指定窗口 ()

        // 主窗口对象.创建主窗口 ()
        // 窗口_欢迎窗口.创建主窗口 (, , , , )
        窗口_主界面窗口.创建主窗口 (, , , , )
        窗口_登录窗口.创建窗口 (, , , , )
        调试输出 (读配置项 (取运行目录 () + "登录信息.ini", "小王", "不显示欢迎窗口", ))
        如果 (读配置项 (取运行目录 () + "登录信息.ini", "小王", "不显示欢迎窗口", "0") == "0")
        {
            窗口_欢迎窗口.创建窗口 (, , , , )
        }
        否则
        {
            取程序 ().窗口_登录窗口.可视 = 真

        }

        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"500, 300\"">
{
    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        标题 = 类_全局变量.成员_当前用户


        返回 (0)
    }

    方法 消息过滤 <公开 类型 = 逻辑型 注释 = "用户的窗口类可以覆盖此方法以过滤处理本窗口及其所有子组件中的消息"
            返回值注释 = "返回真表示允许消息继续向后传递并处理,返回假表示取消掉该消息的后续处理." @虚拟方法 = 可覆盖>
    参数 窗口句柄 <类型 = 变整数 注释 = "提供消息所对应的窗口句柄(HWND),必定为本窗口或其直接/间接下属子窗口.">
    参数 消息值 <类型 = 整数 注释 = "提供消息的具体值">
    参数 消息参数1 <类型 = 变整数 注释 = "提供消息所附带的参数1的值">
    参数 消息参数2 <类型 = 变整数 注释 = "提供消息所附带的参数2的值">
    参数 消息地址 <类型 = 变整数 注释 = "提供消息的具体 MSG* 地址指针,用作备用.">
    {
        返回 (父对象.消息过滤 (窗口句柄, 消息值, 消息参数1, 消息参数2, 消息地址))  // 调用基础类中的被覆盖虚拟方法






    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_主窗口 <公开 基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"1280, 900\"" 底色 = 0xFFFFFF 控制按钮 = 真
        窗口边框 = 普通可调边框 最大化按钮 = 真 最小化按钮 = 真 可否移动 = 真 可视 = 假>
{
    变量 超级按钮_退出 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"1190, 5, 72, 72\"" 标题 = "退出"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xA78227 通常前景色 = 0xFFFFFF 对齐方式 = 图上文下
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC
            通常图片 = "..\\相关素材\\背景\\dian_guan_40_8_n.png">
    变量 标签_副标题 <类型 = 标签 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"264, 0, 1021, 80\"" 标题 = "——努力成为您生意的好帮手"
            背景颜色 = 0xA78227 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF>
    变量 超级按钮1 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"0, 368, 240, 48\"" 标题 = "库存管理"
            字体 = "微软雅黑,22, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0x846000 通常前景色 = 0xFFFFFF
            通常图片 = "..\\相关素材\\背景\\kwd.png" 对齐方式 = 图右文左 点燃背景色 = 0x755500 焦点背景色 = 0x846000 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00FFFF>
    变量 超级按钮_库存盘点 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"0, 416, 240, 48\"" 标题 = "库存盘点"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_库存列表 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"0, 464, 240, 48\"" 标题 = "库存列表"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮4 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"0, 224, 240, 48\"" 标题 = "销售管理"
            字体 = "微软雅黑,22, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0x846000 通常前景色 = 0xFFFFFF
            通常图片 = "..\\相关素材\\背景\\kwd.png" 对齐方式 = 图右文左 点燃背景色 = 0x755500 焦点背景色 = 0x846000 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00FFFF>
    变量 超级按钮_销售开单 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"0, 272, 240, 48\"" 标题 = "销售开单"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_销售管理 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"0, 320, 240, 48\"" 标题 = "销售列表"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮7 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"0, 80, 240, 48\"" 标题 = "进货管理"
            字体 = "微软雅黑,22, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0x846000 通常前景色 = 0xFFFFFF
            通常图片 = "..\\相关素材\\背景\\kwd.png" 对齐方式 = 图右文左 点燃背景色 = 0x755500 焦点背景色 = 0x846000 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00FFFF>
    变量 超级按钮_进货开单 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"0, 128, 240, 48\"" 标题 = "进货开单"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_进货列表 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"0, 176, 240, 48\"" 标题 = "进货列表"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮10 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"0, 512, 240, 48\"" 标题 = "基础管理"
            字体 = "微软雅黑,22, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0x846000 通常前景色 = 0xFFFFFF
            通常图片 = "..\\相关素材\\背景\\kwd.png" 对齐方式 = 图右文左 点燃背景色 = 0x755500 焦点背景色 = 0x846000 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00FFFF>
    变量 超级按钮_商品管理 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"0, 560, 240, 48\"" 标题 = "商品管理"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_供应商管理 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"0, 608, 240, 48\"" 标题 = "供应商管理"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_客户管理 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"0, 656, 240, 48\"" 标题 = "客户管理"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮14 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"0, 704, 240, 48\"" 标题 = "系统管理"
            字体 = "微软雅黑,22, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0x846000 通常前景色 = 0xFFFFFF
            通常图片 = "..\\相关素材\\背景\\kwd.png" 对齐方式 = 图右文左 点燃背景色 = 0x755500 焦点背景色 = 0x846000 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00FFFF>
    变量 超级按钮_系统设置 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"0, 752, 240, 48\"" 标题 = "系统设置"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 超级按钮_权限管理 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"0, 800, 240, 48\"" 标题 = "权限管理"
            字体 = "微软雅黑,18, 0, 0, 0, 0, 0" 使用默认色 = 假 通常背景色 = 0xB78500 通常前景色 = 0xFFFFFF 对齐方式 = 图右文左
            点燃背景色 = 0xB88D2C 焦点背景色 = 0xCB9C30 点燃前景色 = 0x00FFFF 焦点前景色 = 0xECECEC>
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 119\r\npos = \"0, 0, 264, 80\"" 标题 = " 简 易 进 销 存"
            背景颜色 = 0xA78227 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF>
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 120\r\npos = \"261, 103, 210, 50\"" 标题 = "进货总量"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 121\r\npos = \"261, 153, 210, 50\"" 标题 = "26784"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 122\r\npos = \"524, 103, 210, 50\"" 标题 = "销售总量"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 123\r\npos = \"524, 153, 210, 50\"" 标题 = "3321"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 124\r\npos = \"787, 103, 210, 50\"" 标题 = "库存总量"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 125\r\npos = \"787, 153, 210, 50\"" 标题 = "23463"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 126\r\npos = \"1050, 103, 210, 50\"" 标题 = "进销比例"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 127\r\npos = \"1050, 153, 210, 50\"" 标题 = "11.6%"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 月历1 <类型 = 月历 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 128\r\npos = \"1046, 220, 216, 176\"" 组件边框 = 单线边框式>
    变量 EC图表组件1 <类型 = EC基础图表 隐藏值属性 = "0" @视窗.布局 = "id = 129\r\npos = \"261, 415, 1000, 432\"" "">
    变量 超级列表框1 <类型 = 超级列表框 隐藏值属性 = "0" @视窗.布局 = "id = 130\r\npos = \"261, 220, 736, 176\"" "类型" = 大图标列表框
            图片组 = "..\\相关素材\\背景\\item_icons.png"
            表项 = "0\n0\n0\n0\n0\n进货开单\n\n0\n1\n1\n0\n0\n销售开单\n\n0\n0\n0\n0\n0\n商品管理\n\n0\n2\n2\n0\n0\n权限管理\n\n0\n1\n1\n0\n0\n库存盘点\n">
    变量 状态条1 <类型 = 状态条 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 131\r\npos = \"0, 879, 1288, 40\"" 位置 = 底边 尺寸调节器 = 真
            项目 = "200\n0\n-1\n当前用户：超级管理员\n\n200\n0\n-1\n火山视窗开发 世恒教育出品\n\n-1\n0\n-1\n\n">
    变量 图片框_底层工作区 <类型 = 图片框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 132\r\npos = \"245, 86, 1024, 776\""
            底色 = 0xFFFFFF>
    变量 成员_进货统计数组 <类型 = 整数数组类>
    变量 成员_销售统计数组 <类型 = 整数数组类>
    变量 成员_库存统计数组 <类型 = 整数数组类>

    方法 方法_简易进销存统计图 <
            注释 = "本本例程为变量属性赋值方式构建图表,配置参数还原官方案例参考:https://echarts.apache.org/examples/zh/editor.html?c=area-stack">
    {
        变量 局部_标题栏 <类型 = 图表标题栏类 主标题 = "进销存统计" 副标题 = "简易进销存" 水平对齐方式 = 自动 左边 = 左对齐 内边距 = "5">
        变量 局部_横坐标轴 <类型 = 图表坐标轴类 "类型" = 类目轴 类目数据_文本 = "" 类目轴边界留白 = 假>
        变量 局部_纵坐标轴 <类型 = 图表坐标轴类 "类型" = 数值轴>
        变量 局部_提示框 <类型 = 图表提示框类 触发类型 = 坐标轴触发>
        变量 局部_系列1 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "进货统计" 数据_文本 = "" 数据堆叠 = "总量">
        变量 局部_系列2 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "销售统计" 数据_文本 = "" 数据堆叠 = "总量">
        变量 局部_系列3 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "库存统计" 数据堆叠 = "总量" 数据_文本 = "">
        变量 局部_图例 <类型 = 图表图例类 数据_文本 = " [\'进货统计\', \'销售统计\', \'库存统计\']">
        变量 局部_直角坐标系网格底板 <类型 = 直角坐标系类 左边2 = "3%" 右边 = "4%" 底边 = "3%" 包含轴刻度 = 真>
        EC图表组件1.清空参数 (真)  // 先清空之前的配置 如果有的话.. //第一个参数为真 保留风格主题配置 第二个参数:是否保留调色盘
        EC图表组件1.标题栏 = 局部_标题栏  // 变量配置 赋值给图表对象对应的各个组件
        EC图表组件1.图例 = 局部_图例
        // EC图表组件1.直角坐标系网格 = 直角坐标系网格底板
        EC图表组件1.坐标系.直角坐标系.添加坐标系 (局部_直角坐标系网格底板)
        局部_提示框.坐标轴指示器.类型 = 坐标轴指示器类型.十字准星指示器
        局部_提示框.坐标轴指示器.标签样式.背景颜色 = "#6a7985"
        EC图表组件1.提示框 = 局部_提示框
        EC图表组件1.工具栏.置按钮显示 (, 真, 真)
        // ['周一', '周二', '周三', '周四', '周五', '周六', '周日']

        变量 局部_年月串 <类型 = 文本型>

        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT CONCAT(YEAR(`jhb`.`进货日期`),'年',MONTH(`jhb`.`进货日期`),'月') AS `年月` FROM `jhb`  ORDER BY `年月`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        局部_年月串 = "["

        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_年月串 = 局部_年月串 + "'" + 局部_记录集.读文本数据 ("年月") + "'"
            如果真 (取循环索引 () != 局部_记录集.行数 - 1)
            {
                局部_年月串 = 局部_年月串 + ","

            }

            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        局部_年月串 = 局部_年月串 + "]"
        局部_横坐标轴.类目数据_文本 = 局部_年月串
        EC图表组件1.坐标轴.横轴.添加坐标轴 (局部_横坐标轴)
        EC图表组件1.坐标轴.纵轴.添加坐标轴 (局部_纵坐标轴)
        局部_系列1.区域填充.是否显示 = 真  // 填充折线图为面积图
        局部_系列1.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列  // 鼠标移入高亮自身淡出其他系列

        // [120, 132, 101, 134, 90, 230, 210]
        变量 局部_数据 <类型 = 文本型>

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT   CONCAT(YEAR(`jhb`.`进货日期`),'年',MONTH(`jhb`.`进货日期`),'月') AS `年月`,SUM(jhmxb.`进货数量`) AS `数量` FROM jhb,jhmxb   WHERE jhb.`ID`=jhmxb.`单据ID`  GROUP BY CONCAT(YEAR(`jhb`.`进货日期`),'年',MONTH(`jhb`.`进货日期`),'月') ORDER BY `年月` ") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        局部_数据 = "["

        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_数据 = 局部_数据 + 局部_记录集.读文本数据 ("数量")
            成员_进货统计数组.加入成员 (局部_记录集.读整数数据 ("数量"))

            如果真 (取循环索引 () != 局部_记录集.行数 - 1)
            {
                局部_数据 = 局部_数据 + ","

            }

            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        局部_数据 = 局部_数据 + "]"
        局部_系列1.数据_文本 = 局部_数据

        EC图表组件1.系列集.添加系列 (局部_系列1)  // 将系列变量添加到系列集  折线图的一个系列代表一条数据线以及其相关的各种配置
        局部_系列2.区域填充.是否显示 = 真
        局部_系列2.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // [220, 182, 191, 234, 290, 330, 310]

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT   CONCAT(YEAR(`xsb`.`销售日期`),'年',MONTH(`xsb`.`销售日期`),'月') AS `年月`,SUM(xsmxb.`销售数量`) AS `数量` FROM xsb,xsmxb   WHERE xsb.`ID`=xsmxb.`单据ID`  GROUP BY CONCAT(YEAR(`xsb`.`销售日期`),'年',MONTH(`xsb`.`销售日期`),'月') ORDER BY `年月`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        局部_数据 = "["

        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_数据 = 局部_数据 + 局部_记录集.读文本数据 ("数量")
            成员_销售统计数组.加入成员 (局部_记录集.读整数数据 ("数量"))

            如果真 (取循环索引 () != 局部_记录集.行数 - 1)
            {
                局部_数据 = 局部_数据 + ","

            }

            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        局部_数据 = 局部_数据 + "]"
        局部_系列2.数据_文本 = 局部_数据


        EC图表组件1.系列集.添加系列 (局部_系列2)
        局部_系列3.区域填充.是否显示 = 真
        局部_系列3.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // [150, 232, 201, 154, 190, 330, 410]

        局部_数据 = "["
        变量 局部_进货合计 <类型 = 整数>
        变量 局部_销售合计 <类型 = 整数>
        变量 局部_库存合计 <类型 = 整数>

        计次循环 (成员_销售统计数组.取成员数 ())
        {
            局部_进货合计 = 局部_进货合计 + 成员_进货统计数组.取成员 (取循环索引 ())
            局部_销售合计 = 局部_销售合计 + 成员_销售统计数组.取成员 (取循环索引 ())

            成员_库存统计数组.加入成员 (成员_进货统计数组.取成员 (取循环索引 ()) - 成员_销售统计数组.取成员 (取循环索引 ()))
            局部_数据 = 局部_数据 + 到文本 (成员_进货统计数组.取成员 (取循环索引 ()) - 成员_销售统计数组.取成员 (取循环索引 ()))
            局部_库存合计 = 局部_库存合计 + 成员_进货统计数组.取成员 (取循环索引 ()) - 成员_销售统计数组.取成员 (取循环索引 ())

            如果真 (取循环索引 () != 成员_销售统计数组.取成员数 () - 1)
            {
                局部_数据 = 局部_数据 + ","
            }

        }
        标签_橙色2.标题 = 到文本 (局部_进货合计)
        标签_蓝色2.标题 = 到文本 (局部_销售合计)
        标签_绿色2.标题 = 到文本 (局部_库存合计)
        标签_紫色2.标题 = 到文本 (四舍五入 (局部_进货合计 / (小数)局部_销售合计, 2))
        局部_数据 = 局部_数据 + "]"
        局部_系列3.数据_文本 = 局部_数据
        EC图表组件1.系列集.添加系列 (局部_系列3)
        EC图表组件1.画图 ()  // 画图 构建图表配置参数执行echarts绘图
    }

    方法 方法_连接Mysql数据库 <公开>
    {
        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")
        }

    }

    方法 EC基础图表_准备就绪 <接收事件 类型 = 整数 注释 = "  当页面文档及ECharts图表环境准备就绪时触发此事件.">
    参数 来源对象 <类型 = EC基础图表 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 系列集对象 <类型 = 图表系列集类 注释 = "  系列集,(对应option.series配置项)此配置项实际是个数组,每个成员即一个系列,系列是指:一组数值以及他们映射成的图."
            注释 = "其不仅表示数据,也表示数据映射成为的图.所以一个系列包含的要素至少有:一组数值,图表类型,以及其他的关于这些数据如何映射成图的参数.">
    {
        如果 (来源对象 == EC图表组件1)
        {
            方法_简易进销存统计图 ()

        }
        返回 (0)
    }

    方法 类_主窗口_尺寸被改变 <接收事件 类型 = 整数 注释 = "当本组件的尺寸被改变后发送此事件">
    参数 来源对象 <类型 = 类_主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        状态条1.更新位置 ()
        标签_副标题.宽度 = 取用户区宽度 () - 标签_副标题.左边
        超级按钮_退出.左边 = 取用户区宽度 () - 超级按钮_退出.宽度 - 20

        EC图表组件1.宽度 = 取用户区宽度 () - EC图表组件1.左边 - 20
        EC图表组件1.高度 = 取用户区高度 () - EC图表组件1.顶边 - 状态条1.高度 - 10

        月历1.左边 = 取用户区宽度 () - 月历1.宽度 - 20

        超级列表框1.宽度 = 取用户区宽度 () - 超级列表框1.左边 - 20 - 月历1.宽度 - 20

        标签_紫色1.宽度 = (整数)((取用户区宽度 () - 标签_橙色1.左边 - 20 - 40 * 3) / 4.0)
        标签_紫色2.宽度 = 标签_紫色1.宽度
        标签_绿色1.宽度 = 标签_紫色1.宽度
        标签_绿色2.宽度 = 标签_紫色1.宽度
        标签_蓝色1.宽度 = 标签_紫色1.宽度
        标签_蓝色2.宽度 = 标签_紫色1.宽度
        标签_橙色1.宽度 = 标签_紫色1.宽度
        标签_橙色2.宽度 = 标签_紫色1.宽度
        标签_蓝色1.左边 = 标签_橙色1.左边 + 标签_橙色1.宽度 + 40
        标签_蓝色2.左边 = 标签_蓝色1.左边
        标签_绿色1.左边 = 标签_蓝色1.左边 + 标签_蓝色1.宽度 + 40
        标签_绿色2.左边 = 标签_绿色1.左边
        // 标签_填充.高度 = 取用户区高度 () - 标签_填充.顶边

        图片框_底层工作区.移动 (, , 取用户区宽度 () - 图片框_底层工作区.左边 - 10, 取用户区高度 () - 图片框_底层工作区.顶边 - 状态条1.高度 - 10)


        标签_紫色1.左边 = 取用户区宽度 () - 标签_紫色1.宽度 - 20
        标签_紫色2.左边 = 标签_紫色1.左边



        返回 (0)
    }

    方法 方法_隐藏主界面元素
    参数 参数_是否显示 <类型 = 逻辑型>
    {
        EC图表组件1.可视 = 参数_是否显示
        月历1.可视 = 参数_是否显示
        超级列表框1.可视 = 参数_是否显示
        标签_紫色1.可视 = 参数_是否显示
        标签_紫色2.可视 = 参数_是否显示
        标签_绿色1.可视 = 参数_是否显示
        标签_绿色2.可视 = 参数_是否显示
        标签_蓝色1.可视 = 参数_是否显示
        标签_蓝色2.可视 = 参数_是否显示
        标签_橙色1.可视 = 参数_是否显示
        标签_橙色2.可视 = 参数_是否显示
        // 标签_填充.高度 = 取用户区高度 () - 标签_填充.顶边


    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_系统设置)
        {
            部件类_系统设置.外部接口_菜单MDI ()

        }
        否则 (来源对象 == 超级按钮_权限管理)
        {

            部件类_权限管理.外部接口_权限管理 (取程序 ().数据库_全局Mysql库)

        }
        否则 (来源对象 == 超级按钮_退出)
        {
            结束 ()
            // 否则 (来源对象 == 超级按钮_关于)
            {
                // 方法_调用windows关于 (取窗口句柄 (), 取字节集指针 (文本到多字节 ("简易进销存", )), 取字节集指针 (文本到多字节 ("努力成为您生意的好帮手", )), 方法_加载图标 (0, 32516))
            }

        }
        否则 (来源对象 == 超级按钮_库存列表)
        {
            取程序 ().窗口_库存管理.创建窗口 (, , , , )

        }
        否则 (来源对象 == 超级按钮_库存盘点)
        {
            取程序 ().窗口_盘点列表.创建窗口 (, , , , )

        }
        否则 (来源对象 == 超级按钮_销售管理)
        {
            取程序 ().窗口_销售管理.创建子窗口 (图片框_底层工作区, , , , , )

        }
        否则 (来源对象 == 超级按钮_销售开单)
        {
            取程序 ().窗口_销售下单.创建窗口 (, , , , )

        }
        否则 (来源对象 == 超级按钮_进货列表)
        {
            // 取程序 ().窗口_进货管理.创建窗口 (, , , , )
            如果 (寻找文本 (取程序 ().全局_权限, ",0.1003,", , ) == -1 && 取程序 ().全局_用户名 != "超级管理员")
            {
                信息框 ("您无权操作进货管理！", 信息框按钮.错误图标, )
                返回 (0)
            }
            方法_隐藏主界面元素 (假)
            // 信息框 (到文本 (图片框_底层工作区.宽度) + "-" + 到文本 (图片框_底层工作区.高度), , )

            部件类_进货管理.外部接口_进货管理 (图片框_底层工作区.取窗口句柄 (), 取程序 ().数据库_全局Mysql库, 取程序 ().全局_权限)

        }
        否则 (来源对象 == 超级按钮_进货开单)
        {
            // 取程序 ().窗口_进货下单.创建窗口 (, , , , )
            如果 (寻找文本 (取程序 ().全局_权限, ",0.1003.02,", , ) == -1 && 取程序 ().全局_用户名 != "超级管理员")
            {
                信息框 ("您无权操作进货下单！", 信息框按钮.错误图标, )
                返回 (0)
            }
            部件类_进货管理.外部接口_进货下单 (取程序 ().数据库_全局Mysql库, 取程序 ().全局_权限)

        }
        否则 (来源对象 == 超级按钮_客户管理)
        {
            // 取程序 ().窗口_客户管理.创建窗口 (, , , , )
            外部接口_客户管理 ()

        }
        否则 (来源对象 == 超级按钮_商品管理)
        {
            // 取程序 ().窗口_商品管理.创建窗口 (, , , , )
            运行 (取运行目录 () + "插件目录\\商品管理.exe $_$ SHTEACH", , )
            // J:\volpc21days\第18天_权限管理>简易进销存编译\插件目录\供应商管理.exe

        }
        否则 (来源对象 == 超级按钮_供应商管理)
        {
            // 取程序 ().窗口_供应商管理.创建窗口 (, , , , )
            运行 (取运行目录 () + "插件目录\\供应商管理.exe  $_$ SHTEACH", , )

        }
        返回 (0)


    }

    方法 外部接口_客户管理 <公开 静态 类型 = 逻辑型 @输出名 = "jyjxc_khgl" @视窗.输入 = "插件目录\\客户管理.dll">
    {

    }

    方法 外部接口_客户信息 <公开 静态 类型 = 逻辑型 @输出名 = "jyjxc_khxx" @视窗.输入 = "插件目录\\客户管理.dll">
    {

    }

    方法 方法_调用windows关于 <公开 静态 类型 = 整数
            注释 = "Declare Sub ShellAbout Lib \"shell.dll\" (ByVal hWndOwner As Integer,"
            注释 = "ByVal lpszAppName As String, By lpszMoreInfo As String," 注释 = "ByVal hIcon As Integer)"
            @输出名 = "ShellAboutA" @视窗.输入 = "shell32.dll">
    参数 参数_hWndOwner_句柄 <类型 = 整数>
    参数 参数_lpszAppName_标题 <类型 = 变整数>
    参数 参数_lpszMoreInfo_描述 <类型 = 变整数>
    参数 参数_hIcon_图标 <类型 = 整数>
    {

    }

    方法 方法_加载图标 <公开 静态 类型 = 整数 注释 = "HICON LoadIcon(HINSTANCE hInstance,LPCTSTR lpIconName);"
            @输出名 = "LoadIconA" @视窗.输入 = "user32.dll">
    参数 参数_hInstance_句柄 <类型 = 整数>
    参数 参数_lpIconName_图表号 <类型 = 整数>
    {

    }

    方法 类_主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {

        标题 = "简易进销存"


        方法_连接Mysql数据库 ()
        取程序 ().全局_用户名 = "小王"
        调试输出 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "窗口最大化", "0"))
        调试输出 (取程序 ().全局_用户名)

        如果 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "窗口最大化", "0") == "1")
        {
            位置 = 窗口位置类型.最大化
            调试输出 ("窗口位置类型.最大化")
            调试输出 (窗口位置类型.最大化)
            左边 = 0
            顶边 = 0
            宽度 = 取屏幕宽度 ()
            高度 = 取屏幕高度 ()

        }
        否则 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "按照上次设置", "0") == "1")
        {
            宽度 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "上次宽度", "0"))
            宽度 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "上次高度", "0"))

        }
        否则 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "固定设置", "0") == "1")
        {
            宽度 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "宽度", "0"))
            宽度 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "高度", "0"))

        }




        返回 (0)

        变量 局部_状态 <类型 = 整数>
        变量 局部_数据 <类型 = 字节集类>
        // P1=C44C 50252
        // P2=C8F8 51448
        // P3=0799 1945
        // P4=C43B 50235
        类_飞天加密狗.成员_p1 = 50252
        类_飞天加密狗.成员_p2 = 51448
        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_FIND, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))
        调试输出 (局部_状态)
        如果真 (局部_状态 != 0)
        {
            信息框 ("未检测到软件授权的加密狗，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
            返回 (0)

        }
        调试输出 (类_飞天加密狗.成员_lp1)
        如果真 (类_飞天加密狗.成员_lp1 == 0)
        {
            信息框 ("未检测到软件授权的加密狗，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
            返回 (0)
        }

        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_OPEN, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 (局部_状态)
        如果真 (局部_状态 != 0)
        {
            信息框 ("未检测到软件授权的加密狗，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
            返回 (0)
        }
        调试输出 (类_飞天加密狗.成员_handle)

        类_飞天加密狗.成员_p1 = 0
        类_飞天加密狗.成员_p2 = 500
        类_飞天加密狗.成员_buffer = 取空白字节集 (500)
        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_READ_EX, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 ("BY_READ_EX")
        调试输出 (局部_状态)
        如果真 (局部_状态 != 0)
        {
            信息框 ("未检测到软件授权的加密狗，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
            返回 (0)
        }
        调试输出 (类_飞天加密狗.成员_buffer)
        调试输出 (多字节到文本 (类_飞天加密狗.成员_buffer))
        变量 局部_数据长度 <类型 = 短整数>
        局部_数据长度 = 取字节集数据 (取字节集左边 (类_飞天加密狗.成员_buffer, 2), , 短整数)

        // 调试输出 (字节集到文本 (类_飞天加密狗.成员_buffer))
        // 调试输出 (UTF8到文本 (类_飞天加密狗.成员_buffer))
        局部_数据 = 取字节集中间 (类_飞天加密狗.成员_buffer, 2, 局部_数据长度)
        局部_数据 = 加解密类.解密_RC4 (局部_数据, 取文本中间 (加解密类.取数据MD5 (文本到多字节 ("世恒教育", 假)), 8, 16))
        调试输出 (多字节到文本 (局部_数据))


        // $SHTEACH$
        如果真 (取文本左边 (多字节到文本 (局部_数据), 9) != "$SHTEACH$")
        {
            信息框 ("加密狗数据错误，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
            返回 (0)

        }
        状态条1.置文本 (2, "本软件授权给：" + 取文本中间 (多字节到文本 (局部_数据), 9, 取文本长度 (多字节到文本 (局部_数据)) - 9))

        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_CLOSE, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 (局部_状态)

        调试输出 ("走到这里算全部成功")








        返回 (0)
    }

    方法 类_主窗口_将被销毁 <接收事件 类型 = 整数 注释 = "当本组件被销毁前发送此事件">
    参数 来源对象 <类型 = 类_主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        写配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "上次宽度", 到文本 (宽度))
        写配置项 (取运行目录 () + "登录信息.ini", 取程序 ().全局_用户名, "上次高度", 到文本 (高度))

        返回 (0)
    }

    方法 图片框_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 图片框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 图片框_底层工作区)
        {

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_图表统计 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"">
{
    变量 EC图表组件1 <类型 = EC基础图表 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"14, 391, 997, 373\"">
    变量 画板1 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"517, 7, 408, 240\"" 组件边框 = 单线边框式 自动重画 = 真
            画板背景色 = 0xFFFFFF>
    变量 画板2 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"5, 5, 463, 373\"" 组件边框 = 单线边框式 自动重画 = 真
            画板背景色 = 0xFFFFFF>
    变量 成员_横坐标项目 <类型 = 文本数组类>
    变量 成员_纵坐标数据 <类型 = 整数数组类>

    方法 折线图_堆叠区域图 <
            注释 = "本本例程为变量属性赋值方式构建图表,配置参数还原官方案例参考:https://echarts.apache.org/examples/zh/editor.html?c=area-stack">
    {
        变量 标题栏 <类型 = 图表标题栏类 主标题 = "进销存统计" 副标题 = "简易进销存" 水平对齐方式 = 自动 左边 = 左对齐 内边距 = "5">
        变量 横坐标轴 <类型 = 图表坐标轴类 "类型" = 类目轴 类目数据_文本 = "['周一', '周二', '周三', '周四', '周五', '周六', '周日']" 类目轴边界留白 = 假>
        变量 纵坐标轴 <类型 = 图表坐标轴类 "类型" = 数值轴>
        变量 提示框 <类型 = 图表提示框类 触发类型 = 坐标轴触发>
        变量 系列1 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "销售统计"
                数据_文本 = "[120, 632, 101, 134, 90, 830, 210]" 数据堆叠 = "总量">
        变量 系列2 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "进货统计"
                数据_文本 = "[220, 182, 191, 234, 290, 330, 310]" 数据堆叠 = "总量">
        变量 系列3 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "库存统计" 数据堆叠 = "总量"
                数据_文本 = "[150, 232, 201, 154, 190, 330, 410]">
        变量 系列4 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "经营曲线" 数据堆叠 = "总量"
                数据_文本 = "[320, 332, 301, 334, 390, 330, 320]">
        变量 系列5 <类型 = 图表系列类 注释 = "" 注释 = "" 注释 = "" 图表类型 = 折线图 系列名称 = "其他收入" 数据堆叠 = "总量"
                数据_文本 = "[820, 932, 901, 934, 1290, 1330, 1320]">
        变量 图例 <类型 = 图表图例类 数据_文本 = " [\'销售统计\', \'进货统计\', \'库存统计\', \'经营曲线\', \'其他收入\']">
        变量 直角坐标系网格底板 <类型 = 直角坐标系类 左边2 = "3%" 右边 = "4%" 底边 = "3%" 包含轴刻度 = 真>
        EC图表组件1.清空参数 (真)  // 先清空之前的配置 如果有的话.. //第一个参数为真 保留风格主题配置 第二个参数:是否保留调色盘
        EC图表组件1.标题栏 = 标题栏  // 变量配置 赋值给图表对象对应的各个组件
        EC图表组件1.图例 = 图例
        // EC图表组件1.直角坐标系网格 = 直角坐标系网格底板
        EC图表组件1.坐标系.直角坐标系.添加坐标系 (直角坐标系网格底板)
        提示框.坐标轴指示器.类型 = 坐标轴指示器类型.十字准星指示器
        提示框.坐标轴指示器.标签样式.背景颜色 = "#6a7985"
        EC图表组件1.提示框 = 提示框
        EC图表组件1.工具栏.置按钮显示 (, 真, 真)
        EC图表组件1.坐标轴.横轴.添加坐标轴 (横坐标轴)
        EC图表组件1.坐标轴.纵轴.添加坐标轴 (纵坐标轴)
        // 系列1.区域填充.是否显示 = 真  // 填充折线图为面积图
        系列1.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列  // 鼠标移入高亮自身淡出其他系列
        EC图表组件1.系列集.添加系列 (系列1)  // 将系列变量添加到系列集  折线图的一个系列代表一条数据线以及其相关的各种配置
        // 系列2.区域填充.是否显示 = 真
        // 系列2.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // EC图表组件1.系列集.添加系列 (系列2)
        // 系列3.区域填充.是否显示 = 真
        // 系列3.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // EC图表组件1.系列集.添加系列 (系列3)
        // 系列4.区域填充.是否显示 = 真
        // 系列4.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // EC图表组件1.系列集.添加系列 (系列4)
        // 系列5.区域填充.是否显示 = 真
        // 系列5.悬停状态.聚焦淡出 = 聚焦淡出方式.聚焦系列
        // 系列5.标签样式.是否显示 = 真  // 单独为该系列设置显示提示标签
        // 系列5.标签样式.位置 = 图表元素定位.顶部
        // EC图表组件1.系列集.添加系列 (系列5)
        EC图表组件1.画图 ()  // 画图 构建图表配置参数执行echarts绘图
    }

    方法 类_图表统计_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_图表统计 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        成员_横坐标项目.加入成员 ("周一")
        成员_横坐标项目.加入成员 ("周二")
        成员_横坐标项目.加入成员 ("周三")
        成员_横坐标项目.加入成员 ("周四")
        成员_横坐标项目.加入成员 ("周五")
        成员_横坐标项目.加入成员 ("周六")
        成员_横坐标项目.加入成员 ("周日")

        // [120, 132, 101, 134, 90, 230, 210]
        成员_纵坐标数据.加入成员 (120)
        成员_纵坐标数据.加入成员 (632)
        成员_纵坐标数据.加入成员 (101)
        成员_纵坐标数据.加入成员 (134)
        成员_纵坐标数据.加入成员 (90)
        成员_纵坐标数据.加入成员 (830)
        成员_纵坐标数据.加入成员 (210)

        方法_画板画统计图 (画板1, 成员_横坐标项目, 成员_纵坐标数据)
        方法_画板画统计图 (画板2, 成员_横坐标项目, 成员_纵坐标数据)
        返回 (0)
    }

    方法 EC基础图表_准备就绪 <接收事件 类型 = 整数 注释 = "  当页面文档及ECharts图表环境准备就绪时触发此事件.">
    参数 来源对象 <类型 = EC基础图表 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 系列集对象 <类型 = 图表系列集类 注释 = "  系列集,(对应option.series配置项)此配置项实际是个数组,每个成员即一个系列,系列是指:一组数值以及他们映射成的图."
            注释 = "其不仅表示数据,也表示数据映射成为的图.所以一个系列包含的要素至少有:一组数值,图表类型,以及其他的关于这些数据如何映射成图的参数.">
    {
        如果 (来源对象 == EC图表组件1)
        {
            折线图_堆叠区域图 ()

        }
        返回 (0)
    }

    方法 方法_画板画统计图
    参数 参数_画板 <类型 = 画板>
    参数 参数_横坐标项目 <类型 = 文本数组类>
    参数 参数_纵坐标数据 <类型 = 整数数组类>
    {
        变量 局部_单项目宽度 <类型 = 整数>
        变量 局部_纵坐标数据 <类型 = 整数数组类>
        变量 局部_最大值 <类型 = 整数>
        变量 局部_刻度数 <类型 = 整数>
        如果真 (参数_横坐标项目.取成员数 () == 0 || 参数_横坐标项目 == 空对象)
        {
            返回
        }
        如果真 (参数_纵坐标数据.取成员数 () == 0 || 参数_纵坐标数据 == 空对象)
        {
            返回
        }
        局部_单项目宽度 = (整数)((参数_画板.宽度 - 50 * 2) / (小数)参数_横坐标项目.取成员数 ())
        局部_纵坐标数据 = 参数_纵坐标数据
        局部_纵坐标数据.排序 (假)
        局部_最大值 = 局部_纵坐标数据.取成员 (0)
        // 局部_刻度数 = 局部_最大值 / 5.0
        // 45.6 50
        // 2415.6 3000
        // 235 300
        // 200 200
        变量 局部_临时数值 <类型 = 整数>
        变量 局部_数值文本 <类型 = 文本型>
        变量 局部_最大位数字 <类型 = 整数>
        变量 局部_数值长度 <类型 = 整数>
        变量 局部_位移距离 <类型 = 整数>
        局部_数值文本 = 到文本 (绝对取整 (局部_最大值 / 5.0))
        局部_最大位数字 = 文本到整数 (取文本左边 (局部_数值文本, 1))
        局部_数值长度 = 取文本长度 (局部_数值文本)
        局部_临时数值 = 局部_最大位数字 * (整数)求次方 (10, 局部_数值长度 - 1)
        如果 (文本到整数 (局部_数值文本) > 局部_临时数值)
        {
            局部_刻度数 = (局部_最大位数字 + 1) * (整数)求次方 (10, 局部_数值长度 - 1)
        }
        否则
        {
            局部_刻度数 = 局部_最大位数字 * (整数)求次方 (10, 局部_数值长度 - 1)

        }
        调试输出 (局部_刻度数)
        参数_画板.画笔粗细 = 1
        参数_画板.画笔颜色 = 颜色类.灰色
        参数_画板.画笔类型 = 画笔类型.点线

        计次循环 (6)
        {
            参数_画板.定位写出 (20, (整数)(参数_画板.高度 - 50 - 取循环索引 () * (参数_画板.高度 - 50 * 2) / 5.0 - 参数_画板.取高度 ("1") / 2.0), 取循环索引 () * 局部_刻度数, )
            参数_画板.画直线 (50, (整数)(参数_画板.高度 - 50 - 取循环索引 () * (参数_画板.高度 - 50 * 2) / 5.0), 参数_画板.宽度 - 50, (整数)(参数_画板.高度 - 50 - 取循环索引 () * (参数_画板.高度 - 50 * 2) / 5.0))

        }
        参数_画板.画笔粗细 = 1
        参数_画板.画笔颜色 = 颜色类.蓝色
        参数_画板.画笔类型 = 画笔类型.直线
        参数_画板.刷子类型 = 填充刷子类型.颜色刷子
        参数_画板.刷子颜色 = 颜色类.青蓝色
        变量 局部_横坐标 <类型 = 整数>
        变量 局部_纵坐标 <类型 = 整数>
        变量 局部_上个点横坐标 <类型 = 整数>
        变量 局部_上个点纵坐标 <类型 = 整数>

        计次循环 (参数_横坐标项目.取成员数 ())
        {
            参数_画板.定位写出 ((整数)(50 + 取循环索引 () * (参数_画板.宽度 - 50 * 2) / (小数)(参数_横坐标项目.取成员数 () - 1)), 参数_画板.高度 - 40, 参数_横坐标项目.取成员 (取循环索引 ()), )
            // x / 高度 = 数 / 局部_刻度数 * 5
            局部_位移距离 = (整数)(参数_纵坐标数据.取成员 (取循环索引 ()) * (参数_画板.高度 - 50 * 2) / (小数)(局部_刻度数 * 5))
            参数_画板.画椭圆 ((整数)(50 + 取循环索引 () * (参数_画板.宽度 - 50 * 2) / (小数)(参数_横坐标项目.取成员数 () - 1)) - 3, 参数_画板.高度 - 50 - 局部_位移距离 - 3, (整数)(50 + 取循环索引 () * (参数_画板.宽度 - 50 * 2) / (小数)(参数_横坐标项目.取成员数 () - 1)) + 3, 参数_画板.高度 - 50 - 局部_位移距离 + 3)
            局部_横坐标 = (整数)(50 + 取循环索引 () * (参数_画板.宽度 - 50 * 2) / (小数)(参数_横坐标项目.取成员数 () - 1))
            局部_纵坐标 = 参数_画板.高度 - 50 - 局部_位移距离
            如果真 (取循环索引 () != 0)
            {
                参数_画板.画笔粗细 = 2
                参数_画板.画直线 (局部_上个点横坐标, 局部_上个点纵坐标, 局部_横坐标, 局部_纵坐标)
                参数_画板.画笔粗细 = 1
            }
            局部_上个点横坐标 = (整数)(50 + 取循环索引 () * (参数_画板.宽度 - 50 * 2) / (小数)(参数_横坐标项目.取成员数 () - 1))
            局部_上个点纵坐标 = 参数_画板.高度 - 50 - 局部_位移距离

        }
        参数_画板.画笔粗细 = 1
        参数_画板.画笔颜色 = 颜色类.黑色
        参数_画板.画笔类型 = 画笔类型.直线
        参数_画板.画直线 (50, 50, 50, 参数_画板.高度 - 50)
        参数_画板.画直线 (50, 参数_画板.高度 - 50, 参数_画板.宽度 - 50, 参数_画板.高度 - 50)






        // "['周一', '周二', '周三', '周四', '周五', '周六', '周日']"
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_导入导出 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1287, 676\"">
{
    变量 编辑框1 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"13, 15, 640, 256\"" 是否允许多行 = 真
            滚动条 = 横向及纵向滚动条>
    变量 树形框1 <类型 = 树形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"701, 15, 568, 256\"" 显示连线 = 真 显示根部线 = 真
            显示加减框 = 真>
    变量 超级列表框1 <类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"701, 303, 568, 344\"" "类型" = 报表列表框
            报表列 = "0\n-1\n0\n100\n姓名\n0\n-1\n0\n100\n性别\n0\n-1\n0\n100\n年龄" 显示表格线 = 真 整行选择 = 真>
    变量 按钮_解析 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"653, 23, 40, 72\"" 标题 = "解析">
    变量 按钮_生成 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"653, 135, 40, 72\"" 标题 = "生成">
    变量 按钮_导出 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"653, 319, 40, 72\"" 标题 = "导出">
    变量 按钮_清除 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"653, 415, 40, 72\"" 标题 = "清除">
    变量 按钮_导入 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"653, 511, 40, 72\"" 标题 = "导入">
    变量 按钮_类库导出 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"597, 319, 40, 72\"" 标题 = "类库导出">
    变量 按钮_类库导入 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"597, 511, 40, 72\"" 标题 = "类库导入">
    变量 按钮_CSV导出 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"541, 319, 40, 72\"" 标题 = "CSV导出">
    变量 按钮_CSV导入 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"541, 511, 40, 72\"" 标题 = "CSV导入">
    变量 成员_XML文档 <类型 = XML文档类>
    变量 成员_XML节点 <类型 = XML节点类>
    变量 成员_XML属性 <类型 = XML属性类>
    变量 成员_XML节点值 <类型 = XML节点值>
    变量 成员_XML节点集 <类型 = XML节点集>
    变量 成员_数据库 <类型 = 数据库类>
    变量 成员_Excel程序 <类型 = Excel程序>
    变量 成员_Excel工作簿集 <类型 = Excel工作簿集>
    变量 成员_Excel工作簿 <类型 = Excel工作簿>
    变量 成员_Excel工作表集 <类型 = Excel工作表集>
    变量 成员_Excel工作表 <类型 = Excel工作表>
    变量 成员_单元格 <类型 = Excel单元格>

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮_CSV导入)
        {
            变量 局部_CSV文本 <类型 = 文本型>
            变量 局部_文本数组 <类型 = 文本数组类>
            变量 局部_文本数组1 <类型 = 文本数组类>
            变量 ""
            变量 局部_计次 <类型 = 整数>
            变量 局部_索引 <类型 = 整数>
            局部_CSV文本 = 读入文本文件 (取当前目录 () + "\\导出.csv", , 文本编码类型.多字节)
            分割文本 (局部_CSV文本, "\r\n", 局部_文本数组, , )

            计次循环 (局部_文本数组.取成员数 () - 1)
            {
                分割文本 (局部_文本数组.取成员 (取循环索引 () + 1), ",", 局部_文本数组1, , )
                局部_索引 = 超级列表框1.插入表项 (, , , , , )
                循环 (0, 局部_文本数组1.取成员数 (), 局部_计次)
                {
                    超级列表框1.置标题 (局部_索引, 局部_计次, 局部_文本数组1.取成员 (局部_计次))
                    // 超级列表框1.置标题 (局部_索引, 2, 局部_记录集.读文本数据 ("年龄"))



                }
                变量 "// 局部_索引" <类型 = 整数>
                // 局部_索引 = 超级列表框1.插入表项 (, 局部_记录集.读文本数据 ("姓名"), , , , )
                // 超级列表框1.置标题 (局部_索引, 1, 局部_记录集.读文本数据 ("性别"))
                // 超级列表框1.置标题 (局部_索引, 2, 局部_记录集.读文本数据 ("年龄"))
                // 局部_记录集.到下一行 ()

            }

        }
        否则 (来源对象 == 按钮_CSV导出)
        {

            变量 局部_CSV文本 <类型 = 文本型>
            变量 局部_计次 <类型 = 整数>

            计次循环 (超级列表框1.取列数 ())
            {
                局部_CSV文本 = 局部_CSV文本 + 超级列表框1.取列标题 (取循环索引 ()) + ","

            }
            局部_CSV文本 = 局部_CSV文本 + "\r\n"

            计次循环 (超级列表框1.取表项数 ())
            {
                循环 (0, 3, 局部_计次)
                {
                    局部_CSV文本 = 局部_CSV文本 + 超级列表框1.取标题 (取循环索引 (), 局部_计次) + ","


                }
                局部_CSV文本 = 局部_CSV文本 + "\r\n"

            }
            写出文本文件 (局部_CSV文本, 取当前目录 () + "\\导出.csv", , 文本编码类型.多字节)

            调试输出 (局部_CSV文本)




        }
        否则 (来源对象 == 按钮_类库导出)
        {
            成员_Excel程序.创建 ()
            成员_Excel程序.可视 = 真
            成员_Excel工作簿集 = 成员_Excel程序.工作簿集
            成员_Excel工作簿 = 成员_Excel工作簿集.新建工作簿 (, )
            成员_Excel工作表集 = 成员_Excel工作簿.工作表集
            成员_Excel工作表 = 成员_Excel工作表集.取工作表 (1, )
            成员_Excel工作表.名称 = "学生列表"
            计次循环 (超级列表框1.取列数 ())
            {
                成员_单元格 = 成员_Excel工作表.取单元格 (到文本 ((字符)(65 + 取循环索引 ())) + 到文本 (1), )
                调试输出 (到文本 ((字符)(65 + 取循环索引 ())) + 到文本 (1))
                成员_单元格.内容 = 超级列表框1.取列标题 (取循环索引 ())

            }

            计次循环 (超级列表框1.取表项数 ())
            {
                变量 局部_计次 <类型 = 整数>
                循环 (0, 3, 局部_计次)
                {
                    成员_单元格 = 成员_Excel工作表.取单元格 (到文本 ((字符)(65 + 局部_计次)) + 到文本 (取循环索引 () + 2), )
                    调试输出 (到文本 ((字符)(65 + 局部_计次)) + 到文本 (取循环索引 () + 2))
                    成员_单元格.内容 = 超级列表框1.取标题 (取循环索引 (), 局部_计次)


                }
            }
            成员_Excel工作簿.另存为 (取当前目录 () + "\\类库导出.xlsx", , , , , , , , )
            // 成员_Excel工作簿.关闭 (, )
            // 成员_Excel工作簿集.关闭 ()
            成员_Excel程序.退出 ()

            // 成员_Excel工作表 = 成员_Excel工作表集.新建工作表 (, "学生列表", , , )




        }
        否则 (来源对象 == 按钮_类库导入)
        {
            成员_Excel程序.创建 ()
            成员_Excel程序.可视 = 真
            成员_Excel工作簿集 = 成员_Excel程序.工作簿集
            成员_Excel工作簿集.打开 (取当前目录 () + "\\类库导出.xlsx", )
            // 成员_Excel工作表集 = 成员_Excel工作簿.工作表集
            // 成员_Excel工作表 = 成员_Excel工作表集.取工作表 (1, )
            // 成员_Excel工作表.名称 = "学生列表"
            成员_Excel工作表 = 成员_Excel程序.活动工作表

            // 计次循环 (超级列表框1.取列数 ())
            {
                // 成员_单元格 = 成员_Excel工作表.取单元格 (到文本 ((字符)(65 + 取循环索引 ())) + 到文本 (1), )
                // 调试输出 (到文本 ((字符)(65 + 取循环索引 ())) + 到文本 (1))
                // 成员_单元格.内容 = 超级列表框1.取列标题 (取循环索引 ())

            }
            成员_单元格 = 成员_Excel工作表.取已用单元格 ()
            调试输出 (成员_单元格.行数)
            超级列表框1.全部删除 ()
            计次循环 (成员_单元格.行数)
            {
                变量 局部_计次 <类型 = 整数>
                变量 局部_索引 <类型 = 整数>
                局部_索引 = 超级列表框1.插入表项 (, , , , , )
                循环 (0, 3, 局部_计次)
                {
                    超级列表框1.置标题 (局部_索引, 局部_计次, 成员_单元格.取文本 (局部_计次 + 1, 取循环索引 () + 2))


                }
            }
            成员_Excel工作簿.关闭 (, )
            // 成员_Excel工作簿.关闭 (, )
            // 成员_Excel工作簿集.关闭 ()
            成员_Excel程序.退出 ()





        }
        否则 (来源对象 == 按钮_导入)
        {
            调试输出 (成员_数据库.连接 ("DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};FirstRowHasNames=1;ReadOnly=FALSE;DBQ=" + 取当前目录 () + "\\学生信息.xlsx", , , , ))
            变量 局部_记录集 <类型 = 记录集类>
            如果真 (局部_记录集.从已有连接打开 ("select * from [学生列表$] ", 成员_数据库, , , 记录集编辑锁类型.开放式锁定, ) == 假)
            {
                信息框 ("打开失败", , )
                返回 (0)

            }
            局部_记录集.到首记录 ()
            超级列表框1.全部删除 ()
            计次循环 ((整数)局部_记录集.记录数量)
            {
                变量 局部_索引 <类型 = 整数>
                局部_索引 = 超级列表框1.插入表项 (, 局部_记录集.读文本数据 ("姓名"), , , , )
                超级列表框1.置标题 (局部_索引, 1, 局部_记录集.读文本数据 ("性别"))
                超级列表框1.置标题 (局部_索引, 2, 局部_记录集.读文本数据 ("年龄"))
                局部_记录集.到下一行 ()

            }
            局部_记录集.关闭 ()
            成员_数据库.关闭 ()


        }
        否则 (来源对象 == 按钮_导出)
        {
            调试输出 (成员_数据库.连接 ("DRIVER={Microsoft Excel Driver (*.xls, *.xlsx, *.xlsm, *.xlsb)};FirstRowHasNames=1;ReadOnly=FALSE;DBQ=" + 取当前目录 () + "\\学生信息.xlsx", , , , ))
            变量 局部_记录集 <类型 = 记录集类>
            如果真 (局部_记录集.从已有连接打开 ("select * from [学生列表$] ", 成员_数据库, , , 记录集编辑锁类型.开放式锁定, ) == 假)
            {
                信息框 ("打开失败", , )
                返回 (0)
            }
            计次循环 (超级列表框1.取表项数 ())
            {
                局部_记录集.添加空记录 ()
                局部_记录集.写文本数据 ("姓名", 超级列表框1.取标题 (取循环索引 (), 0))
                局部_记录集.写文本数据 ("性别", 超级列表框1.取标题 (取循环索引 (), 1))
                局部_记录集.写文本数据 ("年龄", 超级列表框1.取标题 (取循环索引 (), 2))
            }
            调试输出 (局部_记录集.批更新 ())
            局部_记录集.关闭 ()
            成员_数据库.关闭 ()


        }
        否则 (来源对象 == 按钮_清除)
        {
            超级列表框1.全部删除 ()

        }
        否则 (来源对象 == 按钮_生成)
        {
            变量 局部_XML合成 <类型 = XML合成器类>
            局部_XML合成.开始节点 ("学生信息")
            计次循环 (超级列表框1.取表项数 ())
            {
                局部_XML合成.添加同级节点 ("学生")
                局部_XML合成.置同级节点属性 ("姓名", 超级列表框1.取标题 (取循环索引 (), 0))
                局部_XML合成.置同级节点属性 ("性别", 超级列表框1.取标题 (取循环索引 (), 1))
                局部_XML合成.置同级节点属性 ("年龄", 超级列表框1.取标题 (取循环索引 (), 2))
                局部_XML合成.置同级节点内容 (超级列表框1.取标题 (取循环索引 (), 0))
            }
            调试输出 (局部_XML合成.导出XML文档 ())
            编辑框1.内容 = 局部_XML合成.导出XML文档 ()

            变量 局部_XML文档 <类型 = XML文档类>
            变量 局部_根节点 <类型 = XML节点类>
            变量 局部_节点 <类型 = XML节点类>
            变量 局部_属性 <类型 = XML属性类>
            局部_根节点 = 局部_XML文档.添加节点到头部 ("学生信息")
            计次循环 (超级列表框1.取表项数 ())
            {
                局部_节点 = 局部_根节点.添加节点到尾部 ("学生")
                局部_属性 = 局部_节点.添加属性到头部 ("姓名")
                局部_属性.置入文本值 (超级列表框1.取标题 (取循环索引 (), 0))
                局部_节点.添加节点到尾部 ("姓名").取元素节点值 ().置入文本值 (超级列表框1.取标题 (取循环索引 (), 0))
                局部_节点.添加节点到尾部 ("性别").取元素节点值 ().置入文本值 (超级列表框1.取标题 (取循环索引 (), 1))
                局部_节点.添加节点到尾部 ("年龄").取元素节点值 ().置入文本值 (超级列表框1.取标题 (取循环索引 (), 2))

            }
            调试输出 (局部_XML文档.到文本 ())










        }
        否则 (来源对象 == 按钮_解析)
        {
            调试输出 (成员_XML文档.从文本创建 (编辑框1.内容))
            // 成员_XML节点集 = 成员_XML文档.取节点集 ("/address/Row")
            // 调试输出 (成员_XML节点集.取成员数 ())

            成员_XML节点集 = 成员_XML文档.取节点集 ("/address/Row[3]/Cell[2]/Data")
            调试输出 (成员_XML节点集.取成员数 ())

            计次循环 (成员_XML节点集.取成员数 ())
            {
                // 成员_XML节点集.取成员属性 ()
                成员_XML节点 = 成员_XML节点集.取成员节点 (取循环索引 ())
                成员_XML属性 = 成员_XML节点.取属性 ("name")
                调试输出 (成员_XML节点.取元素节点值 ().取文本值 ())

            }

            返回 (0)
            树形框1.清空 ()
            计次循环 (成员_XML节点集.取成员数 ())
            {
                // 成员_XML节点集.取成员属性 ()
                成员_XML节点 = 成员_XML节点集.取成员节点 (取循环索引 ())
                成员_XML属性 = 成员_XML节点.取属性 ("name")
                调试输出 (成员_XML属性.取属性文本值 ())
                变量 局部_索引 <类型 = 整数>
                局部_索引 = 树形框1.加入项目 (, 成员_XML属性.取属性文本值 (), , , , , )
                变量 局部_市节点 <类型 = XML节点类>
                成员_XML节点.枚举子节点 (局部_市节点)
                {
                    变量 局部_区县节点 <类型 = XML节点类>
                    变量 局部_市索引 <类型 = 整数>
                    局部_市索引 = 树形框1.加入项目 (局部_索引, 局部_市节点.取属性 ("name").取属性文本值 (), , , , , )
                    局部_市节点.枚举子节点 (局部_区县节点)
                    {
                        树形框1.加入项目 (局部_市索引, 局部_区县节点.取元素节点值 ().取文本值 (), , , , , )
                    }


                }


            }
            // 成员_XML节点 = 成员_XML文档.取节点 ("/全国省市/北京市/北京市/东城区")
            // 成员_XML属性 = 成员_XML节点.取属性 ("人口")
            // 调试输出 (成员_XML属性.取属性文本值 ())
            // 成员_XML节点值 = 成员_XML节点.取元素节点值 ()
            // 调试输出 (成员_XML节点值.取文本值 ())
            // 调试输出 (成员_XML文档.取文本值 ("/全国省市/辽宁省/大连市"))




        }
        返回 (0)
    }

    方法 类_导入导出_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_导入导出 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        编辑框1.内容 = 读入文本文件 (取当前目录 () + "\\全国省市区县.xml", , 文本编码类型.UTF8)
        计次循环 (10)
        {
            变量 局部_索引 <类型 = 整数>
            局部_索引 = 超级列表框1.插入表项 (, "张" + 到文本 (取循环索引 ()), , , , )
            超级列表框1.置标题 (局部_索引, 1, 选择 (取随机数 (1, 2) == 1, "男", "女"))
            超级列表框1.置标题 (局部_索引, 2, 到文本 (取随机数 (11, 20)))


        }


        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_盘点列表 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 底色 = 0xFFFFFF>
{
    变量 树形框_盘点日程 <类型 = 树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 175, 315, 576\""
            字体 = ", 14, 0, 0, 0, 0, 0" 显示根部线 = 真 显示连线 = 真 显示加减框 = 真 是否有检查框 = 假 图片组 = "..\\相关素材\\col_icons.png">
    变量 ""
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 13, 210, 50\"" 标题 = "账面数量"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"273, 13, 210, 50\"" 标题 = "实际数量"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"536, 13, 210, 50\"" 标题 = "数量落差"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"799, 13, 210, 50\"" 标题 = "落差比例"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_单据列表 <公开 类型 = 超级列表框 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"341, 175, 674, 176\""
            "类型" = 报表列表框 报表列 = "0\n-1\n0\n200\n单据号\n0\n-1\n0\n100\n存放仓库\n0\n-1\n0\n110\n盘点日期\n0\n-1\n0\n80\n经手人"
            整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"461, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_打印 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"917, 131, 96, 32\"" 标题 = "打印"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"803, 131, 96, 32\"" 标题 = "删除"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_修改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"689, 131, 96, 32\"" 标题 = "修改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_盘点 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"575, 131, 96, 32\"" 标题 = "盘点"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"10, 131, 311, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"333, 131, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 ""
    变量 成员_当前状态 <公开 静态 类型 = 文本型>
    变量 成员_商品类别 <公开 静态 类型 = 文本型>
    变量 成员_商品类别ID <公开 静态 类型 = 文本型>
    变量 "//窗口_商品信息" <公开 类型 = 类_商品信息>
    变量 表格1 <类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"341, 375, 664, 376\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 1 表头列数 = 0 是否可编辑 = 假 行数 = 1 列数 = 7 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 "//窗口_进货下单" <公开 类型 = 类_进货下单>

    方法 方法_盘点统计
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_最大ID <类型 = 文本型>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select max(`ID`) as `最大ID` from `pdb`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            局部_最大ID = 到文本 (局部_记录集.读整数数据 ("最大ID"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()





        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`账面数量`) as `总数` from `pdmxb` where `单据ID`=" + 局部_最大ID) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`实际数量`) as `总数` from `pdmxb` where `单据ID`=" + 局部_最大ID) == 假)
        {
            信息框 ("查询失败", , )

            返回

        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select (sum(`账面数量`)-sum(`实际数量`)) as `总数` from `pdmxb` where `单据ID`=" + 局部_最大ID) == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select ((sum(`账面数量`)-sum(`实际数量`))/sum(`账面数量`)) as `总数` from `pdmxb` where `单据ID`=" + 局部_最大ID) == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_紫色2.标题 = 到文本 (四舍五入 (局部_记录集.读小数数据 ("总数") * 100, 2)) + "%"

            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()

    }

    方法 方法_显示盘点单据列表
    参数 参数_日期 <类型 = 文本型>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_位置 <类型 = 整数>
        变量 局部_语句 <类型 = 文本型>
        局部_语句 = "SELECT `pdb`.`ID` AS `ID` ,`pdb`.`单据号` AS `单据号` ,`pdb`.`存放仓库` AS `存放仓库` ,`pdb`.`盘点日期` AS `盘点日期`  ,`pdb`.`经手人` AS `经手人`   FROM `pdb` WHERE  YEAR(`pdb`.`盘点日期`)*10000+MONTH(`pdb`.`盘点日期`)*100+DAY(`pdb`.`盘点日期`) =" + 参数_日期

        调试输出 (局部_语句)

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {

            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        超级列表框_单据列表.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_单据列表.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_单据列表.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("单据号"))
            超级列表框_单据列表.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("存放仓库"))
            超级列表框_单据列表.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("盘点日期"))
            超级列表框_单据列表.置标题 (局部_位置, 3, 局部_记录集.读文本数据 ("经手人"))

        }
        局部_记录集.关闭 ()



        // Create Table
        // CREATE TABLE `pdb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `供应商ID` bigint(11) DEFAULT NULL,  `存放仓库` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `盘点日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT '0.00',  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=gbk COLLATE=gbk_bin

    }

    方法 方法_显示盘点日程
    参数 参数_树型框 <类型 = 树形框>
    参数 参数_当前选中项 <类型 = 整数 @默认值 = -1>
    {
        变量 局部_索引 <类型 = 整数>

        变量 局部_语句 <类型 = 文本型>
        如果真 (参数_当前选中项 != -1)
        {
            判断循环 (树形框_盘点日程.取父项目 (参数_当前选中项 + 1) == 参数_当前选中项)
            {
                树形框_盘点日程.删除项目 (参数_当前选中项 + 1)
            }

        }
        如果 (参数_当前选中项 == -1)
        {
            局部_索引 = 树形框_盘点日程.加入项目 (, "盘点日程", , , -1, , )
            树形框_盘点日程.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

        }
        否则
        {
            如果 (树形框_盘点日程.取缩进层次 (参数_当前选中项) == 1)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`盘点日期`) AS `年份` FROM `pdb` ORDER BY `年份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("年份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  YEAR(`盘点日期`)*100+month(`盘点日期`) AS `月份` FROM `pdb`  where YEAR(`盘点日期`) =" + 局部_记录集.读文本数据 ("年份") + " ORDER BY `月份` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()


            }
            否则 (树形框_盘点日程.取缩进层次 (参数_当前选中项) == 2)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`盘点日期`)*100+month(`盘点日期`) AS `月份` FROM `pdb`  where YEAR(`盘点日期`) =" + 树形框_盘点日程.取项目文本 (参数_当前选中项) + " ORDER BY `月份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("月份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  (YEAR(`盘点日期`)*10000+MONTH(`盘点日期`)*100+DAY(`盘点日期`)) AS `日`  FROM `pdb`  where YEAR(`盘点日期`)*100+month(`盘点日期`) =" + 局部_记录集.读文本数据 ("月份") + " ORDER BY `日` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()



            }
            否则 (树形框_盘点日程.取缩进层次 (参数_当前选中项) == 3)
            {
                局部_语句 = "SELECT DISTINCT  (YEAR(`盘点日期`)*10000+MONTH(`盘点日期`)*100+DAY(`盘点日期`)) AS `日`  FROM `pdb`  where YEAR(`盘点日期`)*100+month(`盘点日期`) =" + 树形框_盘点日程.取项目文本 (参数_当前选中项) + " ORDER BY `日` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("日"), 2, 2, , , )

                }
                局部_记录集.关闭 ()



            }


        }
        调试输出 (局部_语句)

        返回





        如果真 (局部_记录集.从已有连接打开 (局部_语句, 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("类别名称"), 2, 2, 局部_记录集.读整数数据 ("ID"), , )
            变量 局部_记录集1 <类型 = 记录集类>
            如果真 (局部_记录集1.从已有连接打开 ("select count(ID) as [总数] from [商品类别] where [上级ID]=" + 到文本 (局部_记录集.读整数数据 ("ID")), 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
            {
                信息框 ("查询失败", , )
                返回  // day
            }
            局部_记录集1.到首记录 ()
            如果真 (局部_记录集1.记录数量 == 1)
            {
                如果真 (局部_记录集1.读整数数据 ("总数") > 0)
                {
                    参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                }
                局部_记录集1.关闭 ()
            }

            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()




    }

    方法 方法_连接Mysql数据库 <公开>
    {
        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")
        }

    }

    方法 表格_光标位置改变 <接收事件 类型 = 整数 注释 = "当用户更改了当前被选择单元时会产生本事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {

        }
        返回 (0)
    }

    方法 树形框_即将扩展 <接收事件 类型 = 整数 注释 = "当某项目即将被展开以显示出下属子项目时产生本事件,返回1中止展开,返回0则允许.">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 项目索引 <类型 = 整数 注释 = "提供即将扩展显示下属子项目的项目索引,从0开始.">
    {
        如果 (来源对象 == 树形框_盘点日程)
        {
            方法_显示盘点日程 (树形框_盘点日程, 项目索引)
        }
        返回 (0)
    }

    方法 树形框_项目被选择 <接收事件 类型 = 整数 注释 = "当前选择项目被改变时产生此事件">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 选择方式 <类型 = 整数 注释 = "提供是如何操作导致当前选择项目被改变的:  0:键盘; 1:鼠标;  2:其它">
    {
        如果 (来源对象 == 树形框_盘点日程)
        {
            如果真 (来源对象.取缩进层次 (来源对象.现行选中项) == 4)
            {
                方法_显示盘点单据列表 (来源对象.取项目文本 (来源对象.现行选中项))


            }

        }
        返回 (0)
    }

    方法 超级列表框_左键单击表项 <接收事件 类型 = 整数 注释 = "  当用鼠标左键单击某表项时即产生此事件,接收到此事件后读取" 注释 = "\"现行选中项\"属性即可获得被单击表项的索引.">
    参数 来源对象 <类型 = 超级列表框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级列表框_单据列表)
        {
            表格1.行数 = 1
            // SELECT `pdmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`pdmxb`.`盘点数量` AS `盘点数量` ,`pdmxb`.`盘点价格` AS `盘点价格` ,`pdmxb`.`合计金额` AS `合计金额`   FROM `pdmxb`,`spxx` WHERE spxx.`ID`=pdmxb.`商品ID` AND `pdmxb`.`单据ID`=7

            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            // SELECT `pdmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`pdmxb`.`盘点数量` AS `盘点数量` ,`pdmxb`.`盘点价格` AS `盘点价格` ,`pdmxb`.`合计金额` AS `合计金额`   FROM `pdmxb`,`spxx` WHERE spxx.`ID`=pdmxb.`商品ID` AND `pdmxb`.`单据ID`=7
            局部_语句 = "SELECT `pdmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`pdmxb`.`账面数量` AS `账面数量` ,`pdmxb`.`实际数量` AS `实际数量`    FROM `pdmxb`,`spxx` WHERE spxx.`ID`=pdmxb.`商品ID` AND `pdmxb`.`单据ID`=" + 到文本 (超级列表框_单据列表.取表项数值 (超级列表框_单据列表.现行选中项))

            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            计次循环 ((整数)局部_记录集.行数)
            {
                局部_记录集.到下一行 ()
                表格1.行数 = 表格1.行数 + 1
                表格1.置数据 (表格1.行数 - 1, 0, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品编码"))
                表格1.置数据 (表格1.行数 - 1, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
                表格1.置数据 (表格1.行数 - 1, 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
                表格1.置数据 (表格1.行数 - 1, 3, 表格常量.文本值型, 局部_记录集.读文本数据 ("账面数量"))
                表格1.置数据 (表格1.行数 - 1, 4, 表格常量.文本值型, 局部_记录集.读文本数据 ("实际数量"))
                表格1.置数据 (表格1.行数 - 1, 5, 表格常量.文本值型, 局部_记录集.读文本数据 ("ID"))

            }
            局部_记录集.关闭 ()


        }
        返回 (0)

    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_盘点)
        {
            取程序 ().窗口_库存盘点.创建窗口 (, , , , )


        }
        返回 (0)
    }

    方法 类_盘点列表_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_盘点列表 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        方法_连接Mysql数据库 ()


        // "CREATE TABLE `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin"
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("CREATE TABLE if not exists `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin") == 假)
        {
            信息框 ("创建分类表失败", , )
            销毁 ()
            返回 (0)

        }
        // 信息框 ("创建分类表成功", , )
        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` (`上级ID`,`类别名称` ,  `添加时间`) VALUES (1,'啤酒类',NOW()) ") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
        }

        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` set `上级ID`=1,`类别名称` ='白酒类',`添加时间`=NOW()") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
            // 返回 (0)
        }

        方法_显示盘点日程 (树形框_盘点日程, -1)
        树形框_盘点日程.扩展 (0)
        方法_盘点统计 ()


        表格1.列数 = 6
        表格1.列宽 = 120
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "账面数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "实际数量")
        表格1.置数据 (0, 5, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (5, 0)
        表格1.置列宽 (2, 80)
        表格1.置列宽 (3, 80)
        表格1.置列宽 (4, 80)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.数值型)
        // 表格1.置列类型 (5, 表格常量.货币型)
        // 表格1.置计算公式 (3, 4, 表格常量.乘, 5)
        返回 (0)

        返回 (0)
    }
}

类 类_库存盘点 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 516\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"920, 447, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"794, 447, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_存放仓库 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"448, 55, 568, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"8, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "单据号">
    变量 编辑框_经手人 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"807, 15, 209, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"701, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "经手人">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"341, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "供应商" 可视 = 假>
    变量 组合框_供应商 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"448, 15, 224, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" "类型" = 不可编辑下拉式 可视 = 假>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"8, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "盘点日期">
    变量 日期框_进货日期 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"124, 55, 193, 32\"">
    变量 编辑框_合计金额 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"242, 447, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 假 输入方式 = 只读方式 可视 = 假>
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"341, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "盘点仓库">
    变量 表格1 <类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"8, 103, 1008, 336\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 0 表头列数 = 0 是否可编辑 = 真 行数 = 0 列数 = 0 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"125, 447, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合计金额" 可视 = 假>
    变量 编辑框_单据号 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"124, 15, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 真>
    变量 超级按钮_删除行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"53, 447, 32, 32\"" 标题 = "－"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 可视 = 假>
    变量 超级按钮_添加行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"8, 447, 32, 32\"" 标题 = "＋"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 可视 = 假>

    方法 方法_连接Mysql数据库 <公开>
    {

        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")

        }
    }

    #

    方法 方法_生成单据号 <类型 = 文本型>
    {
        变量 局部_单据号 <类型 = 文本型>
        局部_单据号 = 到文本 (取年份 (取现行时间 ())) + 取文本右边 ("0" + 到文本 (取月份 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取日 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取小时 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取分钟 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取秒 (取现行时间 ())), 2) + 到文本 (取随机数 (10000, 99999))

        返回 (局部_单据号)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_保存)
        {

        }

        如果 (来源对象 == 超级按钮_保存)
        {

            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "INSERT INTO `pdb` set `单据号`='" + 编辑框_单据号.内容 + "',`存放仓库`='" + 编辑框_存放仓库.内容 + "',`盘点日期`='" + 到文本 (取年份 (日期框_进货日期.今天)) + 取文本右边 ("0" + 到文本 (取月份 (日期框_进货日期.今天)), 2) + 取文本右边 ("0" + 到文本 (取日 (日期框_进货日期.今天)), 2) + "',`经手人`='" + 编辑框_经手人.内容 + "',`添加时间`=now()"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("保存盘点单失败", , )
                返回 (0)

            }
            变量 局部_单据ID <类型 = 长整数>
            局部_单据ID = 取程序 ().数据库_全局Mysql库.取自增值 ()

            // select last_insert_id()
            计次循环 (表格1.行数 - 1)
            {
                局部_语句 = "INSERT INTO `pdmxb` set `单据ID`=" + 到文本 (局部_单据ID) + ",`商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 5)) + ",`账面数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`实际数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 4))

                调试输出 (局部_语句)

                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("保存盘点单明细失败", , )
                    返回 (0)
                }


                // Create Table
                // CREATE TABLE `pdmxb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据ID` bigint(11) DEFAULT NULL,  `商品ID` bigint(11) DEFAULT NULL,  `盘点数量` bigint(11) DEFAULT NULL,  `盘点价格` double(8,2) DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin


            }
            信息框 ("保存盘点单成功", , )
            编辑框_单据号.内容 = 方法_生成单据号 ()
            返回 (0)

            // Create Table
            // CREATE TABLE `pdb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `供应商ID` bigint(11) DEFAULT NULL,  `存放仓库` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `盘点日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin


        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }

    方法 类_库存盘点_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_库存盘点 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {

        方法_连接Mysql数据库 ()
        // 方法_获取供应商 (组合框_供应商)
        编辑框_单据号.内容 = 方法_生成单据号 ()

        表格1.列数 = 6
        表格1.列宽 = 150
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "账面数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "实际数量")
        表格1.置数据 (0, 5, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (5, 0)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.数值型)


        变量 局部_语句 <类型 = 文本型>
        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_字段列表 <类型 = Mysql字段信息数组类>
        变量 局部_字段 <类型 = Mysql字段信息类>
        // `kcb`.`ID` AS `ID` ,
        局部_语句 = "SELECT   `spxx`.`ID` AS `商品ID`,`spxx`.`商品编码` AS `商品编码`,`spxx`.`商品名称` AS `商品名称`,`spxx`.`规格型号` AS `规格型号` ,`kcb`.`库存数量` AS `账面数量`,'' as '实际数量'  FROM spxx,kcb WHERE kcb.`商品ID`=spxx.`ID` ORDER BY `kcb`.`ID` DESC"
        调试输出 (局部_语句)
        // 局部_语句 = "SELECT *  FROM spxx RIGHT JOIN kcb ON kcb.`商品ID`=spxx.`ID`"

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {
            信息框 ("查询失败", , )
            返回 (0)
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        // 局部_字段列表 = 局部_记录集.取字段列表 ()
        // 表格1.行数 = 0
        // 表格1.列数 = 0
        // 调试输出 (局部_字段列表.取成员数 ())

        // 计次循环 (局部_字段列表.取成员数 ())
        {
            // 局部_字段 = 局部_字段列表.取成员 (取循环索引 ())
            // 表格1.插入列 (局部_字段.名称, )
            // // 超级列表框_显示.插入列 (, 局部_字段.名称, 150, , , )

        }
        // 返回 (0)

        // 超级列表框_显示.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            表格1.插入行 (, )

            表格1.置数据 (表格1.行数 - 1, 0, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品编码"))
            表格1.置数据 (表格1.行数 - 1, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
            表格1.置数据 (表格1.行数 - 1, 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
            表格1.置数据 (表格1.行数 - 1, 3, 表格常量.文本值型, 局部_记录集.读文本数据 ("账面数量"))
            表格1.置数据 (表格1.行数 - 1, 4, 表格常量.文本值型, 局部_记录集.读文本数据 ("实际数量"))
            表格1.置数据 (表格1.行数 - 1, 5, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品ID"))

            // 局部_位置 =
            // 计次循环 (局部_字段列表.取成员数 ())
            {
                // 局部_字段 = 局部_字段列表.取成员 (取循环索引 ())
                // 表格1.置数据 (表格1.行数 - 1, 取循环索引 (), 表格常量.文本值型, 局部_记录集.读文本数据 (局部_字段.名称))





            }
        }
        局部_记录集.关闭 ()
        表格1.置只读方式 (0, 0, 表格1.行数 - 1, 3, 真)
        表格1.置只读方式 (0, 5, 表格1.行数 - 1, 5, 真)




        返回 (0)
    }
}

类 类_库存管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"">
{
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 13, 210, 50\"" 标题 = "进货数"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"273, 13, 210, 50\"" 标题 = "销售数"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"536, 13, 210, 50\"" 标题 = "库存数"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"799, 13, 210, 50\"" 标题 = "进销比"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_显示 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"7, 175, 1008, 576\""
            "类型" = 报表列表框 整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"461, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_打印 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"917, 131, 96, 32\"" 标题 = "打印"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"797, 131, 96, 32\"" 标题 = "盘点"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"12, 131, 312, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"333, 131, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 "//窗口_供应商信息" <公开 类型 = 类_供应商信息>
    变量 成员_当前状态 <公开 静态 类型 = 文本型>

    方法 类_库存管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_库存管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // SELECT   `kcb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码`,`spxx`.`商品名称` AS `商品名称`,`spxx`.`规格型号` AS `规格型号` ,`kcb`.`盘点数` AS `盘点数` ,`kcb`.`出库数` AS `出库数` ,`kcb`.`库存数量` AS `库存数量`  FROM spxx,kcb WHERE kcb.`商品ID`=spxx.`ID` ORDER BY `kcb`.`ID` DESC

        方法_连接Mysql数据库 ()
        方法_库存销售 ()

        变量 局部_位置 <类型 = 整数>
        变量 局部_语句 <类型 = 文本型>
        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_字段列表 <类型 = Mysql字段信息数组类>
        变量 局部_字段 <类型 = Mysql字段信息类>
        // `kcb`.`ID` AS `ID` ,
        局部_语句 = "SELECT  `spxx`.`商品编码` AS `商品编码`,`spxx`.`商品名称` AS `商品名称`,`spxx`.`规格型号` AS `规格型号` ,`kcb`.`入库数` AS `入库数` ,`kcb`.`出库数` AS `出库数` ,`kcb`.`库存数量` AS `库存数量`  FROM spxx,kcb WHERE kcb.`商品ID`=spxx.`ID` ORDER BY `kcb`.`ID` DESC"
        调试输出 (局部_语句)
        // 局部_语句 = "SELECT *  FROM spxx RIGHT JOIN kcb ON kcb.`商品ID`=spxx.`ID`"

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {
            信息框 ("查询失败", , )
            返回 (0)
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        局部_字段列表 = 局部_记录集.取字段列表 ()
        计次循环 (局部_字段列表.取成员数 ())
        {
            局部_字段 = 局部_字段列表.取成员 (取循环索引 ())
            超级列表框_显示.插入列 (, 局部_字段.名称, 150, , , )

        }
        // 返回 (0)

        超级列表框_显示.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_显示.插入表项 (, , , , , )
            计次循环 (局部_字段列表.取成员数 ())
            {
                局部_字段 = 局部_字段列表.取成员 (取循环索引 ())
                超级列表框_显示.置标题 (局部_位置, 取循环索引 (), 局部_记录集.读文本数据 (局部_字段.名称))

            }
        }
        局部_记录集.关闭 ()

        返回 (0)
    }

    方法 方法_连接Mysql数据库 <公开>
    {
        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")
        }

    }

    方法 方法_库存销售
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`入库数`) as `总数` from `kcb`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`出库数`) as `总数` from `kcb`") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`库存数量`) as `总数` from `kcb`") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select sum(`入库数`)/sum(`出库数`) as `总数` from `kcb`") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_紫色2.标题 = 到文本 (四舍五入 (局部_记录集.读小数数据 ("总数"), 2))

            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()

    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_添加)
        {
            取程序 ().窗口_盘点列表.创建窗口 (, , , , )

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_欢迎窗口 <公开 基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"480, 360\"" 底色 = 0xC06000 窗口边框 = 无边框>
{
    变量 时钟1 <类型 = 时钟 折叠2 编辑时信息 = "0, 286BA1, 0, 0" 隐藏值属性 = "0"
            @视窗.布局 = "id = 101\r\npos = \"416, 104, 48, 40\"" 时钟周期 = 100>
    变量 时钟2 <类型 = 时钟 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"344, 80, 48, 40\"" 时钟周期 = 100>
    变量 标签1 <类型 = 标签 折叠2 编辑时信息 = "0, 286BA1, 0, 0" 隐藏值属性 = "0"
            @视窗.布局 = "id = 103\r\npos = \"0, 108, 480, 69\"" 标题 = "程序正在启动中" 横向对齐方式 = 居中 纵向对齐方式 = 居中
            字体 = "微软雅黑, 28, 0, 0, 0, 0, 0" 背景颜色 = 0xA78227 文本颜色 = 0xFFFFFF>
    变量 图形按钮1 <类型 = 图形按钮 编辑时信息 = "0, 286BA1, 0, 0" 隐藏值属性 = "0"
            @视窗.布局 = "id = 104\r\npos = \"104, 184, 260, 50\"" 正常图片 = "..\\相关素材\\进度\\auto_install_admin_1.png"
            透明颜色 = 0x0>
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"0, 0, 480, 69\"" 标题 = "简 易 进 销 存"
            横向对齐方式 = 居中 纵向对齐方式 = 居中 字体 = "方正小标宋简体, 28, 0, 0, 0, 0, 0" 背景颜色 = 0x614700 文本颜色 = 0xFFFFFF>
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"0, 69, 496, 223\""
            字体 = ", 22, 0, 0, 0, 0, 0" 背景颜色 = 0xA78227>
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"0, 292, 480, 68\""
            字体 = ", 16, 0, 0, 0, 0, 0" 背景颜色 = 0x614700 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 图片_进度1 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_1.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度2 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_2.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度3 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_3.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度4 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_4.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度5 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_5.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度6 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_6.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度7 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_7.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度8 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_8.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 图片_进度9 <类型 = 位图资源 值 = "..\\相关素材\\进度\\auto_install_admin_9.png" 编辑时信息 = "0, 286BA1, 0, 0">
    变量 成员_当前图片 <类型 = 整数 值 = 0 编辑时信息 = "0, 286BA1, 0, 0">
    变量 成员_启动过程 <类型 = "文本型 [6]" 值 = {"检查系统环境中...","系统环境检查通过","连接数据库中...","数据库连接成功","绘制登录窗口中...","登录窗口绘制完成"}
            编辑时信息 = "0, 286BA1, 0, 0">
    变量 成员_停留时间 <类型 = "整数 []" 值 = {1900,900,2500,800,3800,2000}>
    变量 成员_过程数组 <类型 = 文本数组类>
    变量 成员_时间数组 <类型 = 整数数组类>
    变量 成员_当前位置 <类型 = 整数>

    方法 时钟_周期事件 <接收事件 类型 = 整数 注释 = "每当经过了指定的时钟周期,将发送本事件.">
    参数 来源对象 <类型 = 时钟 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 时钟2)
        {
            时钟2.时钟周期 = 成员_停留时间 [成员_当前位置]
            标签3.标题 = 成员_启动过程 [成员_当前位置]
            成员_当前位置 = 成员_当前位置 + 1
            如果真 (成员_当前位置 > 5)
            {
                时钟2.时钟周期 = 0
                // 可视 = 假
                // 取程序 ().窗口_登录窗口.创建主窗口 (, , , , )
                取程序 ().窗口_登录窗口.可视 = 真

                本对象.销毁 ()


            }


        }

        如果 (来源对象 == 时钟1)
        {

            // 标签2.标题 = 到文本 (成员_停留时间 [2]) + ":" + 成员_启动过程 [2]
            // 标签3.标题 = 到文本 (成员_时间数组.取成员 (3)) + ":" + 成员_过程数组.取成员 (3)

            // 标签1.标题 = 时间到文本 (取现行时间 (), , )




            成员_当前图片 = 成员_当前图片 + 1
            如果真 (成员_当前图片 > 9)
            {
                成员_当前图片 = 1

            }
            分支判断 (成员_当前图片)
            {
                分支 (1)
                {
                    图形按钮1.正常图片 = 图片_进度1


                }
                分支 (2)
                {
                    图形按钮1.正常图片 = 图片_进度2
                }
                分支 (3)
                {
                    图形按钮1.正常图片 = 图片_进度3
                }
                分支 (4)
                {
                    图形按钮1.正常图片 = 图片_进度4
                }
                分支 (5)
                {
                    图形按钮1.正常图片 = 图片_进度5
                }
                分支 (6)
                {
                    图形按钮1.正常图片 = 图片_进度6
                }
                分支 (7)
                {
                    图形按钮1.正常图片 = 图片_进度7
                }
                分支 (8)
                {
                    图形按钮1.正常图片 = 图片_进度8
                }
                分支 (9)
                {
                    图形按钮1.正常图片 = 图片_进度9


                }


            }

            // 如果 (成员_当前图片 == 1)
            {
                // 图形按钮1.正常图片 = 图片_进度1
            }
            // 否则 (成员_当前图片 == 2)
            {
                // 图形按钮1.正常图片 = 图片_进度2
            }
            // 否则 (成员_当前图片 == 3)
            {
                // 图形按钮1.正常图片 = 图片_进度3
            }
            // 否则 (成员_当前图片 == 4)
            {
                // 图形按钮1.正常图片 = 图片_进度4
            }
            // 否则 (成员_当前图片 == 5)
            {
                // 图形按钮1.正常图片 = 图片_进度5
            }
            // 否则 (成员_当前图片 == 6)
            {
                // 图形按钮1.正常图片 = 图片_进度6
            }
            // 否则 (成员_当前图片 == 7)
            {
                // 图形按钮1.正常图片 = 图片_进度7
            }
            // 否则 (成员_当前图片 == 8)
            {
                // 图形按钮1.正常图片 = 图片_进度8
            }
            // 否则 (成员_当前图片 == 9)
            {
                // 图形按钮1.正常图片 = 图片_进度9
            }








        }
        返回 (0)
    }

    方法 类_欢迎窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_欢迎窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        成员_过程数组.加入成员 ("检查系统环境中...")
        成员_过程数组.加入成员 ("系统环境检查通过")
        成员_过程数组.加入成员 ("连接数据库中...")
        成员_过程数组.加入成员 ("数据库连接成功")
        成员_过程数组.加入成员 ("绘制登录窗口中...")
        成员_过程数组.加入成员 ("登录窗口绘制完成")

        成员_时间数组.加入成员 (600)
        成员_时间数组.加入成员 (300)
        成员_时间数组.加入成员 (800)
        成员_时间数组.加入成员 (300)
        成员_时间数组.加入成员 (1000)
        成员_时间数组.加入成员 (500)


        计次循环 (取数组成员数 (成员_启动过程))
        {
            调试输出 (成员_启动过程 [取循环索引 ()])
            调试输出 (成员_停留时间 [取循环索引 ()])


        }


        变量 局部_计次 <类型 = 整数>
        循环 (20, 101, 局部_计次, 1)
        {
            如果真 (局部_计次 % 5 == 0)
            {
                调试输出 (局部_计次)


            }


        }

        循环 (0, 成员_过程数组.取成员数 (), 局部_计次, 1)
        {
            调试输出 (成员_过程数组.取成员 (局部_计次))



        }

        判断循环 (1 == 2)
        {
            调试输出 ("1=2")


        }

        循环判断首 ()
        {
            调试输出 ("1=2")

        }
        循环判断尾 (1 == 2)

        // 成员_停留时间 [0] = 800


        // {600,300,800,300,1000,500}
        // {"检查系统环境中...","系统环境检查通过","连接数据库中...","数据库连接成功","绘制登录窗口中...","登录窗口绘制完成"}


        返回 (0)

    }
}

类 ""

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_登录窗口 <公开 基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"1024, 720\"" 底色 = 0xA78227 可视 = 假>
{
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"47, 19, 328, 80\"" 标题 = "简 易 进 销 存"
            字体 = "方正小标宋简体, 40, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边 文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227>
    变量 图片框1 <类型 = 图片框 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"0, 135, 1024, 450\""
            底图 = "..\\相关素材\\背景\\简易进销存_登录背景_1024_450.png" 底图方式 = 缩放图片>
    变量 外形框1 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\nparent_id = 102\r\npos = \"573, 97, 360, 256\""
            填充颜色 = 0xFFFFFF 背景颜色 = 0x614700 外形 = 圆角矩形>
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\nparent_id = 103\r\npos = \"37, 66, 64, 48\""
            标题 = "用户名：" 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\nparent_id = 103\r\npos = \"37, 120, 64, 48\""
            标题 = "密　码：" 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 标签6 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\nparent_id = 103\r\npos = \"36, 7, 288, 40\""
            标题 = "用户登录" 字体 = "方正小标宋简体, 20, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边 文本颜色 = 0x614700 背景颜色 = 0xFFFFFF>
    变量 超级按钮_退出 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\nparent_id = 103\r\npos = \"192, 191, 142, 50\""
            按钮风格 = 平面风格 按钮类型 = 通常 使用默认色 = 假 标题 = "退  出"
            通常图片 = "..\\相关素材\\背景\\taobao_xp_cm_button_download_click.9.png" 对齐方式 = 图文混排
            字体 = "微软雅黑, 20, 0, 0, 0, 0, 0" 通常前景色 = 0xFFFFFF 点燃前景色 = 0xFFFFFF 焦点前景色 = 0xFFFFFF
            点燃图片 = "..\\相关素材\\背景\\taobao_xp_cm_button_download.9.png">
    变量 超级按钮_登录 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\nparent_id = 103\r\npos = \"26, 191, 142, 50\""
            按钮风格 = 平面风格 按钮类型 = 通常 使用默认色 = 假 标题 = "登  录"
            通常图片 = "..\\相关素材\\背景\\taobao_xp_cm_button_download_click.9.png" 对齐方式 = 图文混排
            字体 = "微软雅黑, 20, 0, 0, 0, 0, 0" 通常前景色 = 0xFFFFFF 点燃前景色 = 0xFFFFFF 焦点前景色 = 0xFFFFFF
            点燃图片 = "..\\相关素材\\背景\\taobao_xp_cm_button_download.9.png">
    变量 外形框2 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\nparent_id = 103\r\npos = \"110, 66, 223, 48\""
            填充颜色 = 0xFFFFFF 线条颜色 = 0x614700>
    变量 编辑框_用户名 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\nparent_id = 109\r\npos = \"37, 8, 176, 32\""
            组件边框 = 无边框 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 图片框2 <类型 = 图片框 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\nparent_id = 109\r\npos = \"6, 10, 24, 24\""
            图片 = "..\\相关素材\\背景\\frv.jpg">
    变量 外形框3 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\nparent_id = 103\r\npos = \"110, 120, 223, 48\""
            填充颜色 = 0xFFFFFF 线条颜色 = 0x614700>
    变量 编辑框_密码 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\nparent_id = 112\r\npos = \"37, 8, 176, 32\""
            组件边框 = 无边框 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 输入方式 = 密码输入 密码遮盖字符 = '*'>
    变量 图片框3 <类型 = 图片框 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\nparent_id = 112\r\npos = \"6, 10, 24, 24\""
            图片 = "..\\相关素材\\背景\\frw.jpg">
    变量 成员_登录次数 <类型 = 整数>
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"383, 19, 384, 80\"" 标题 = "——努力成为您生意的好帮手"
            字体 = "方正小标宋简体, 20, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边 文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227>
    变量 标签3 <类型 = 标签 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"220, 607, 584, 104\""
            标题 = "火山视窗开发  世恒教育出品\r\nwww.shteach.com" 字体 = "方正小标宋简体, 26, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边
            文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227 是否自动折行 = 真>
    变量 成员_用户名 <类型 = 文本型 值 = "超级管理员">
    变量 成员_密码 <类型 = 文本型 注释 = "这里记录的密码不是" 注释 = "明文密码而是MD5并且" 注释 = "取出第9开始的16位字符">
    变量 成员_权限 <类型 = 文本型>

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_登录)
        {





            // 成员_密码 = 读配置项 (取当前目录 () + "\\登录信息.ini", "管理员", "密码", )
            // 这里是从配置文件读取密码,然后下面比对

            如果真 (删首尾空 (编辑框_用户名.内容) == "")
            {
                信息框 ("请输入用户名！", 信息框按钮.错误图标, "出错提示")
                返回 (0)

            }
            如果真 (删首尾空 (编辑框_密码.内容) == "")
            {
                信息框 ("请输入合法的密码！", 信息框按钮.错误图标, "出错提示")
                返回 (0)

            }
            如果真 (取文本长度 (编辑框_密码.内容) < 6)
            {
                信息框 ("密码长度不正确，必须是6位！", 信息框按钮.错误图标, "出错提示")
                返回 (0)

            }
            // 如果真 (编辑框_用户名.内容 != 成员_用户名 || 编辑框_密码.内容 != 成员_密码)
            {
                // 信息框 ("用户验证失败，请检查输入！", 信息框按钮.错误图标, "出错提示")
                // 返回 (0)
            }


            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "SELECT  *  FROM `gly` where `用户名`='" + 编辑框_用户名.内容 + "'"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            如果 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                成员_密码 = 局部_记录集.读文本数据 ("密码")
                取程序 ().全局_权限 = 局部_记录集.读文本数据 ("权限")



            }
            否则
            {
                信息框 ("没有找到用户，请检查", 信息框按钮.错误图标, )
                返回 (0)


            }
            局部_记录集.关闭 ()
            如果真 (取文本中间 (加解密类.取数据MD5 (到字节集 (编辑框_密码.内容)), 8, 16) != 成员_密码)
            {
                信息框 ("用户验证失败，请检查输入！", 信息框按钮.错误图标, "出错提示")
                返回 (0)
            }

            信息框 ("用户验证通过，欢迎[" + 编辑框_用户名.内容 + "]登录！", 信息框按钮.信息图标, "欢迎登录")
            // 取程序 ().窗口_主界面窗口.创建主窗口 (, , , , )
            取程序 ().全局_用户名 = 编辑框_用户名.内容
            取程序 ().窗口_主界面窗口.可视 = 真

            // 图片框1.可视 = 假
            本对象.销毁 ()

            // 调试输出 (加解密类.取数据MD5 (到字节集 ("123abc")))
            // 调试输出 (取文本中间 (加解密类.取数据MD5 (到字节集 ("123abc")), 8, 16))


            // 编辑框_用户名.文本颜色 = 颜色类.灰色







            // 如果 (删首尾空 (编辑框_用户名.内容) == "")
            {
                // 信息框 ("请输入用户名！", 信息框按钮.错误图标, "出错提示")
                // 返回 (0)

            }
            // 否则 (删首尾空 (编辑框_密码.内容) == "")
            {
                // 信息框 ("请输入合法的密码！", 信息框按钮.错误图标, "出错提示")
                // 返回 (0)

            }
            // 否则 (取文本长度 (编辑框_密码.内容) < 6)
            {
                // 信息框 ("密码长度不正确，必须是6位！", 信息框按钮.错误图标, "出错提示")
                // 返回 (0)

            }
            // 否则 (编辑框_用户名.内容 == 成员_用户名 && 编辑框_密码.内容 == 成员_密码)
            {
                // 信息框 ("用户验证通过，欢迎登录！", 信息框按钮.信息图标, "欢迎登录")

            }
            // 否则
            {
                // 信息框 ("用户验证失败，请检查输入！", 信息框按钮.错误图标, "出错提示")

            }
            // 如果真 ()
            {


            }




            变量 局部_登录次数 <类型 = 整数>
            成员_登录次数 = 文本到整数 (读配置项 (取当前目录 () + "\\登录信息.ini", "管理员", "登录次数", ))

            成员_登录次数 = 成员_登录次数 + 1
            局部_登录次数 = 局部_登录次数 + 1
            调试输出 (成员_登录次数, 局部_登录次数)

            写配置项 (取运行目录 () + "登录信息.ini", "管理员", "登录次数", 到文本 (成员_登录次数))
            写配置项 (取当前目录 () + "\\登录信息.ini", "管理员", "登录次数", 到文本 (成员_登录次数))

            写配置项 (取运行目录 () + "登录信息.ini", "管理员", "最后登录时间", 时间到文本 (取现行时间 ()))
            写配置项 (取当前目录 () + "\\登录信息.ini", "管理员", "最后登录时间", 时间到文本 (取现行时间 ()))



        }
        否则 (来源对象 == 超级按钮_退出)
        {

            // 超级按钮_登录.销毁 ()
            如果真 (信息框 ("是否要退出程序？", 信息框按钮.询问图标 + 信息框按钮.是否钮, ) == 返回按钮类型.否钮)
            {
                返回 (0)

            }
            结束 ()





        }
        返回 (0)
    }

    方法 类_登录窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_登录窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        成员_用户名 = "超级管理员"
        如果真 (是否为调试版 ())
        {
            编辑框_用户名.内容 = "超级管理员"
            编辑框_密码.内容 = "123abc"


        }


        返回 (0)
    }
}

类 ""

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_硬件接入 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"766, 527\"">
{
    方法 类_硬件接入_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_硬件接入 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 局部_状态 <类型 = 整数>
        局部_状态 = 类_磁卡操作.方法_打开串口 (3, 取变量地址 (类_磁卡操作.成员_rHandle_COM句柄))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_rHandle_COM句柄)

        局部_状态 = 类_磁卡操作.方法_LED数码管显示 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (文本到多字节 ("123456", )), 3)

        调试输出 (局部_状态)
        延时 (2000)
        局部_状态 = 类_磁卡操作.方法_LED数码管显示 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (文本到多字节 ("12345678", )), 4)

        调试输出 (局部_状态)
        延时 (2000)
        局部_状态 = 类_磁卡操作.方法_LED数码管显示 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (取空白字节集 (0)), 0)

        调试输出 (局部_状态)
        延时 (2000)
        局部_状态 = 类_磁卡操作.方法_指示灯控制 (类_磁卡操作.成员_rHandle_COM句柄, 2, 5)
        延时 (2000)
        局部_状态 = 类_磁卡操作.方法_指示灯控制 (类_磁卡操作.成员_rHandle_COM句柄, 2, 5)

        调试输出 (局部_状态)

        返回 (0)

        局部_状态 = 类_磁卡操作.方法_寻找卡 (类_磁卡操作.成员_rHandle_COM句柄)
        调试输出 (局部_状态)
        类_磁卡操作.成员_pSNR_序列号 = 取空白字节集 (8)
        局部_状态 = 类_磁卡操作.方法_读卡序列号 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (类_磁卡操作.成员_pSNR_序列号))
        调试输出 (局部_状态)
        调试输出 (多字节到文本 (类_磁卡操作.成员_pSNR_序列号))
        // 调试输出 (字节集到文本 (类_磁卡操作.成员_pSNR_序列号))
        // 调试输出 (UTF8到文本 (类_磁卡操作.成员_pSNR_序列号))
        局部_状态 = 类_磁卡操作.方法_选择卡 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (类_磁卡操作.成员_pSNR_序列号))
        调试输出 (局部_状态)
        返回 (0)

        // P1=C44C 50252
        // P2=C8F8 51448
        // P3=0799 1945
        // P4=C43B 50235
        类_飞天加密狗.成员_p1 = 50252
        类_飞天加密狗.成员_p2 = 51448
        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_FIND, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))
        调试输出 (局部_状态)
        调试输出 (类_飞天加密狗.成员_lp1)

        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_OPEN, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 (局部_状态)
        调试输出 (类_飞天加密狗.成员_handle)


        变量 局部_数据 <类型 = 字节集类>
        局部_数据 = 文本到多字节 ("$SHTEACH$世恒教育", 假)
        局部_数据 = 加解密类.加密_RC4 (局部_数据, 取文本中间 (加解密类.取数据MD5 (文本到多字节 ("世恒教育", 假)), 8, 16))

        类_飞天加密狗.成员_p1 = 0
        类_飞天加密狗.成员_p2 = 取字节集长度 (局部_数据) + 2
        局部_数据.插入字节集 (0, 到字节集 ((短整数)取字节集长度 (局部_数据)))
        类_飞天加密狗.成员_buffer = 局部_数据
        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_WRITE_EX, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))
        调试输出 ("BY_WRITE_EX")
        调试输出 (局部_状态)
        调试输出 (类_飞天加密狗.成员_buffer)
        调试输出 (多字节到文本 (类_飞天加密狗.成员_buffer))




        类_飞天加密狗.成员_p1 = 0
        类_飞天加密狗.成员_p2 = 500
        类_飞天加密狗.成员_buffer = 取空白字节集 (500)
        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_READ_EX, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 ("BY_READ_EX")
        调试输出 (局部_状态)
        调试输出 (类_飞天加密狗.成员_buffer)
        调试输出 (多字节到文本 (类_飞天加密狗.成员_buffer))
        变量 局部_数据长度 <类型 = 短整数>
        局部_数据长度 = 取字节集数据 (取字节集左边 (类_飞天加密狗.成员_buffer, 2), , 短整数)

        // 调试输出 (字节集到文本 (类_飞天加密狗.成员_buffer))
        // 调试输出 (UTF8到文本 (类_飞天加密狗.成员_buffer))
        局部_数据 = 取字节集中间 (类_飞天加密狗.成员_buffer, 2, 局部_数据长度)
        局部_数据 = 加解密类.解密_RC4 (局部_数据, 取文本中间 (加解密类.取数据MD5 (文本到多字节 ("世恒教育", 假)), 8, 16))
        调试输出 (多字节到文本 (局部_数据))

        局部_状态 = 类_飞天加密狗.方法_加密狗操作 (类_飞天加密狗.BY_CLOSE, 取变量地址 (类_飞天加密狗.成员_handle), 取变量地址 (类_飞天加密狗.成员_lp1), 取变量地址 (类_飞天加密狗.成员_lp2), 取变量地址 (类_飞天加密狗.成员_p1), 取变量地址 (类_飞天加密狗.成员_p2), 取变量地址 (类_飞天加密狗.成员_p3), 取变量地址 (类_飞天加密狗.成员_p4), 取字节集指针 (类_飞天加密狗.成员_buffer))

        调试输出 (局部_状态)
        调试输出 (类_飞天加密狗.成员_handle)

        调试输出 ("走到这里算全部成功")

        返回 (0)

        局部_状态 = 类_磁卡操作.方法_打开串口 (4, 取变量地址 (类_磁卡操作.成员_rHandle_COM句柄))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_rHandle_COM句柄)

        局部_状态 = 类_磁卡操作.方法_寻找卡 (类_磁卡操作.成员_rHandle_COM句柄)
        调试输出 (局部_状态)
        类_磁卡操作.成员_pSNR_序列号 = 取空白字节集 (8)
        局部_状态 = 类_磁卡操作.方法_读卡序列号 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (类_磁卡操作.成员_pSNR_序列号))
        调试输出 (局部_状态)
        调试输出 (多字节到文本 (类_磁卡操作.成员_pSNR_序列号))
        // 调试输出 (字节集到文本 (类_磁卡操作.成员_pSNR_序列号))
        // 调试输出 (UTF8到文本 (类_磁卡操作.成员_pSNR_序列号))
        局部_状态 = 类_磁卡操作.方法_选择卡 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (类_磁卡操作.成员_pSNR_序列号))
        调试输出 (局部_状态)
        变量 局部_秘钥 <类型 = 字节集类>
        局部_秘钥 = 文本到多字节 ("FFFFFFFFFFFF", 假)
        局部_状态 = 类_磁卡操作.方法_核对秘钥 (类_磁卡操作.成员_rHandle_COM句柄, 0, 60, 取字节集指针 (局部_秘钥))
        调试输出 ("局部_秘钥")
        调试输出 (局部_状态)

        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 0, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))

        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 1, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))

        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 2, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))

        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 3, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))

        类_磁卡操作.成员_块数据 = 文本到多字节 ("123ABC", 假)
        调试输出 (类_磁卡操作.成员_块数据)
        类_磁卡操作.成员_块数据.插入字节集 (0, 取空白字节集 (16 - 取字节集长度 (类_磁卡操作.成员_块数据)))
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (字节集到十六进制文本 (类_磁卡操作.成员_块数据))
        调试输出 (文本到多字节 (字节集到十六进制文本 (类_磁卡操作.成员_块数据), 假))
        类_磁卡操作.成员_块数据 = 文本到多字节 (字节集到十六进制文本 (类_磁卡操作.成员_块数据), 假)
        调试输出 ("写块数据")
        局部_状态 = 类_磁卡操作.方法_写块数据 (类_磁卡操作.成员_rHandle_COM句柄, 1, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        局部_状态 = 类_磁卡操作.方法_鸣叫 (类_磁卡操作.成员_rHandle_COM句柄, , 3)
        调试输出 (局部_状态)

        // 调试输出 (类_磁卡操作.成员_块数据)
        // 调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))
        调试输出 ("读块数据")
        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 1, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))
        调试输出 (多字节到文本 (十六进制文本到字节集 (取文本右边 (多字节到文本 (类_磁卡操作.成员_块数据), 12))))




        类_磁卡操作.成员_块数据 = 文本到多字节 ("你好磁卡", 假)
        调试输出 (类_磁卡操作.成员_块数据)
        类_磁卡操作.成员_块数据.插入字节集 (0, 取空白字节集 (16 - 取字节集长度 (类_磁卡操作.成员_块数据)))
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (字节集到十六进制文本 (类_磁卡操作.成员_块数据))
        调试输出 (文本到多字节 (字节集到十六进制文本 (类_磁卡操作.成员_块数据), 假))
        类_磁卡操作.成员_块数据 = 文本到多字节 (字节集到十六进制文本 (类_磁卡操作.成员_块数据), 假)
        调试输出 ("写块数据")
        局部_状态 = 类_磁卡操作.方法_写块数据 (类_磁卡操作.成员_rHandle_COM句柄, 2, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)

        局部_状态 = 类_磁卡操作.方法_鸣叫 (类_磁卡操作.成员_rHandle_COM句柄, , 6)
        调试输出 (局部_状态)
        // 调试输出 (类_磁卡操作.成员_块数据)
        // 调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))
        调试输出 ("读块数据")
        类_磁卡操作.成员_块数据 = 取空白字节集 (32)
        局部_状态 = 类_磁卡操作.方法_读块数据 (类_磁卡操作.成员_rHandle_COM句柄, 2, 取字节集指针 (类_磁卡操作.成员_块数据))
        调试输出 (局部_状态)
        调试输出 (类_磁卡操作.成员_块数据)
        调试输出 (多字节到文本 (类_磁卡操作.成员_块数据))
        调试输出 (多字节到文本 (十六进制文本到字节集 (取文本右边 (多字节到文本 (类_磁卡操作.成员_块数据), 16))))



        局部_状态 = 类_磁卡操作.方法_关闭串口 (类_磁卡操作.成员_rHandle_COM句柄)
        调试输出 (局部_状态)


        返回 (0)
    }
}

类 类_飞天加密狗 <公开>
{
    变量 成员_handle <公开 静态 类型 = 整数>
    变量 成员_lp1 <公开 静态 类型 = 长整数>
    变量 成员_lp2 <公开 静态 类型 = 长整数>
    变量 成员_p1 <公开 静态 类型 = 整数>
    变量 成员_p2 <公开 静态 类型 = 整数>
    变量 成员_p3 <公开 静态 类型 = 整数>
    变量 成员_p4 <公开 静态 类型 = 整数>
    变量 成员_buffer <公开 静态 类型 = 字节集类>

    常量 BY_FIND <公开 类型 = 整数 值 = 1>
    常量 BY_OPEN <公开 类型 = 整数 值 = 3>
    常量 BY_CLOSE <公开 类型 = 整数 值 = 4>
    常量 BY_READ_EX <公开 类型 = 整数 值 = 46>
    常量 BY_WRITE_EX <公开 类型 = 整数 值 = 47>

    # .版本 2
    #
    # .常量 BY_FIND, "1"
    # .常量 BY_OPEN, "3"
    # .常量 BY_CLOSE, "4"
    # .常量 BY_READ_EX, "46"
    # .常量 BY_WRITE_EX, "47"
    #

    方法 方法_加密狗操作 <公开 静态 类型 = 整数 注释 = ".DLL命令 飞天加密狗操作, 整数型, \"Ry4S.dll\", \"Rockey\""
            注释 = "    .参数 function, 整数型, , 功能值" 注释 = "    .参数 handle, 整数型, 传址" 注释 = "    .参数 lp1, 长整数型, 传址"
            注释 = "    .参数 lp2, 长整数型, 传址" 注释 = "    .参数 p1, 整数型, 传址" 注释 = "    .参数 p2, 整数型, 传址"
            注释 = "    .参数 p3, 整数型, 传址" 注释 = "    .参数 p4, 整数型, 传址" 注释 = "    .参数 buffer, 字节集, 传址, 数据的缓冲区"
            @输出名 = "Rockey" @视窗.输入 = "Ry4S.dll" "" "" "" "">
    参数 参数_function <类型 = 整数>
    参数 参数_handle <类型 = 变整数>
    参数 参数_lp1 <类型 = 变整数>
    参数 参数_lp2 <类型 = 变整数>
    参数 参数_p1 <类型 = 变整数>
    参数 参数_p2 <类型 = 变整数>
    参数 参数_p3 <类型 = 变整数>
    参数 参数_p4 <类型 = 变整数>
    参数 参数_buffer <类型 = 变整数>
    {

    }

    #
}

类 类_磁卡操作 <公开>
{
    变量 成员_rHandle_COM句柄 <公开 静态 类型 = 整数>
    变量 成员_pSNR_序列号 <公开 静态 类型 = 字节集类>
    变量 成员_pSNR_序列号_文本 <公开 静态 类型 = 文本型>
    变量 成员_块数据 <公开 静态 类型 = 字节集类>

    方法 方法_打开串口 <公开 静态 类型 = 整数 注释 = "功能说明：此函数用来通过串口与读写器建立通讯链路。传输协议为：波特率为才57600bps，数据位为8 位，1个停止位，无奇偶校验位。"
            注释 = "                在调用其它函数功能前，一定要先进行串行口的联接。"
            注释 = "       函数原型：Function InitPort(Const iPort: Integer;Out rHandle:Thandle): Integer;StdCall;"
            注释 = " 参    数：port: 端口号1 到 9" 注释 = "                 rHandle： COM句柄"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe:=InitPort(1,rHandle);"
            @输出名 = "InitPort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_iPort_串口号 <类型 = 整数>
    参数 参数_rHandle_COM句柄 <类型 = 变整数>
    {

    }

    方法 方法_关闭串口 <公开 静态 类型 = 整数 注释 = "功能说明： 关闭串口"
            注释 = "       函数原型：Function ClosePort(Const Handle:THandle):integer;StdCall;"
            注释 = "       参    数：rHandle： 所要关闭COM的句柄" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe:=ClosePort(rHandle);" @输出名 = "ClosePort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {

    }

    方法 方法_寻找卡 <公开 静态 类型 = 整数 注释 = "  功能说明：查询感应区内是否有卡"
            注释 = "       函数原型：Function SC_Request(Const Handle:THandle ):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "       返 回 值： 返回值为：4表示8Kbit(1K字节)"
            注释 = "返回值为：2表示32Kbit(4K字节卡)" 注释 = "返回值为：1 表示无卡" 注释 = "       举    例：iRe := SC_Request(rHandle);"
            @输出名 = "SC_Request" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {
        // 返回值为:4表示8Kbit(1K字节)
        // 返回值为:2表示32Kbit(4K字节卡)
        // 返回值为:1 表示无卡

    }

    方法 方法_读卡序列号 <公开 静态 类型 = 整数 注释 = " 功能说明：读取卡片的4字节16进制序列号 使用此函数之前先调用 SC_Request()"
            注释 = "       函数原型：Function SC_GetSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节16进制的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：GetMem(pSNR,16);"
            注释 = "                 iRe:=SC_GetSnr(rHandle,pSNR);" @输出名 = "SC_GetSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_选择卡 <公开 静态 类型 = 整数 注释 = " 功能说明：选择要操作的卡 ，使用此函数之前先调用SC_GetSnr()"
            注释 = "       函数原型：Function SC_SelectSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。32Kbit(4k字节)的卡片返回1正确"
            注释 = "       举    例：iRe:=SC_SelectSnr(rHandle,pSNR);" @输出名 = "SC_SelectSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_核对秘钥 <公开 静态 类型 = 整数
            注释 = "功能说明：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "函数原型：Function SC_EncryptAuth (Const Handle:THandle;" 注释 = "iSector:integer;"
            注释 = "iMode:integer;pKey:Pchar):integer;stdcall;" 注释 = "参数：" 注释 = "rHandle：COM的句柄"
            注释 = "iSector：核对密钥的扇区号0~15" 注释 = "iMode：卡密钥的类型及A密钥60或B密钥61，通常使用A密钥60，"
            注释 = "pKey：卡密钥初始为12个FFFFFFFFFFFF" 注释 = "返回值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "举例：GetMem(pSNR,64);"
            注释 = "     iMode := 60;" 注释 = "     iSector := 0;" 注释 = "     pKey := Pchar(\'FFFFFFFFFFFF\');"
            注释 = "     iRe:= SC_EncryptAuth ( rHandle, iSector, iMode,pKey);" @输出名 = "SC_EncryptAuth"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iSector_扇区 <类型 = 整数>
    参数 参数_iMode_模式 <类型 = 整数 @默认值 = 60>
    参数 参数_pKey_秘钥 <类型 = 变整数>
    {

    }

    方法 方法_读块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：读卡一个块的16字节数据；"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENRead(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：存放读取的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： GetMem(pData,64);"
            注释 = "iBlock := 1;" 注释 = "iRe:= SC_RFRead(rHandle, iBlock, pData);" @输出名 = "SC_ENRead"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_写块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：写一个块数据，写入数据必须是16个字节的十六进制。"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENWrite(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：要写入的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： iBlock := 1;"
            注释 = "pData := Pchar(\'11223344556677889900AABBCCDDEEFF\');"
            注释 = "iRe:= SC_ENWrite ( rHandle,iBlock,pData);" @输出名 = "SC_ENWrite" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_鸣叫 <公开 静态 类型 = 整数 注释 = " 功能说明： 控制蜂鸣器的蜂鸣时间" 注释 = "       函数原型："
            注释 = "Function SC_Beep(Const Handle:THandle;" 注释 = "icount:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "icount: 固定为0" 注释 = "iTimes: 1 到 255" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe := SC_Beep(rHandle,0,3); //蜂鸣一声 短" 注释 = "" 注释 = "     报警声实现："
            注释 = "     iRe := SC_Beep(rHandle,0,25);" 注释 = "     sleep(1000); //延时的时间要大于，SC_Beep 的时间，否则会造成连续蜂鸣。"
            注释 = "     iRe := SC_Beep(rHandle,0,25);" @输出名 = "SC_Beep" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_icount_固定值 <类型 = 整数 @默认值 = 0>
    参数 参数_iTimes_长度 <类型 = 整数 @默认值 = 1>
    {

    }

    方法 方法_LED数码管显示 <公开 静态 类型 = 整数 注释 = "SC_LEDDSP()：LED数码管显示(此函数只对SC1023、SC1024、SC1025三种型号有效)"
            注释 = "     功能说明：可显示8位 数字和部分英文、字符" 注释 = "       函数原型：Function SC_LEDDSP(Const Handle:THandle;"
            注释 = "pData:Pchar;idot:integer):integer;stdcall;" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  pData ：可以显示的数据，空格表示 不显示" 注释 = "0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F、b、"
            注释 = "c、H、h、L、n、N、o、P、P、r、t、U、-、=、y、j" 注释 = ""
            注释 = "                  iDot  ：小数点的位置，值为0 ~ 8  ，0表示不显示" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例： iRe:= SC_LEDDSP( rHandle,12345678,6);" 注释 = ""
            注释 = "                  清屏：iRe:= SC_LEDDSP( rHandle,        ,0);" 注释 = "" @输出名 = "SC_LEDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    参数 参数_iDot_小数点位置 <类型 = 整数 @默认值 = 0>
    {

    }

    方法 方法_显示ASCII字符 <公开 静态 类型 = 整数 注释 = "SC_LCDDSP()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示ASCII字符" 注释 = "函数原型：Function SC_LCDDSP(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "参    数："
            注释 = "                 rHandle：COM的句柄" 注释 = "                 iline: 显示在第几行"
            注释 = "                 ilen : 显示字符长度" 注释 = "                 pData: 可以显示ASCII，如英文，标点符号等" 注释 = ""
            注释 = "     返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "     举    例： iRe:= SC_LCDDSP( rHandle,91,7,Pchar(\'ABCDEFG\'));" @输出名 = "SC_LCDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_显示中文 <公开 静态 类型 = 整数 注释 = "SC_LCDDSPCN()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示中文" 注释 = "函数原型：Function SC_LCDDSPCN(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "    参    数： rHandle：COM的句柄"
            注释 = "               iline: 显示在第几行" 注释 = "               ilen : 显示字符长度"
            注释 = "               pData: 汉字显示" 注释 = "" 注释 = "   返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "   举    例： iRe:= SC_LCDDSPCN( rHandle,91,6,Pchar(\'中文显示测试\'));" @输出名 = "SC_LCDDSPCN"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_指示灯控制 <公开 静态 类型 = 整数 注释 = "SC_LED()：指示灯控制" 注释 = "     功能说明： 控制红色和绿色指示灯、蜂鸣器" 注释 = "       函数原型："
            注释 = "Function SC_LED(Const Handle:THandle;" 注释 = "iType:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "iType:  1  //代表红色LED指示灯" 注释 = "2  //代表绿色LED指示灯" 注释 = "3  //代表红色和绿色LED指示灯" 注释 = "4  //代表 蜂鸣"
            注释 = "5  //代表 红色LED指示灯和蜂鸣" 注释 = "6  //代表 绿色LED指示灯和蜂鸣" 注释 = "7  //代表 红色和绿色LED指示灯和蜂鸣"
            注释 = "8  //代表 红色指示灯常亮" 注释 = "9  //代表 红色关闭" 注释 = "10 //代表 绿色指示灯常亮" 注释 = "11 //代表 绿色关闭"
            注释 = "12 //代表 红色和绿色指示灯常亮" 注释 = "13 //代表 红色和绿色指示灯关闭" 注释 = "iTimes: 1 到 255"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe := SC_LED(rHandle,1,5); //闪红色指示灯"
            注释 = "" 注释 = "     闪烁两下:：" 注释 = "     iRe := SC_LED(rHandle,1,5);"
            注释 = "     sleep(300); //延时的时间要大于，SC_LED的时间，否则会造成LED灯常亮。" 注释 = "     iRe := SC_LED (rHandle,1,5);"
            注释 = "" @输出名 = "SC_LED" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iType_类型 <类型 = 整数>
    参数 参数_iTimes_事件 <类型 = 整数 @默认值 = 1>
    {

    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_生成合同 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"600, 416\"">
{
    变量 ""
    变量 超级编辑框_甲方 <类型 = 超级编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"21, 47, 224, 128\"" 内容格式 = 纯文本>
    变量 通用对话框_字体 <类型 = 通用对话框 "//类型" = 字体选择>
    变量 按钮_设置甲方格式 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"21, 7, 144, 40\"" 标题 = "设置甲方格式"
            字体 = ",14">
    变量 按钮_设置乙方格式 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"357, 7, 144, 40\"" 标题 = "设置乙方格式"
            字体 = ",14">
    变量 按钮_生成合同 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"252, 63, 96, 232\"" 标题 = "生成合同"
            字体 = ",14">
    变量 超级编辑框_乙方 <类型 = 超级编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"357, 47, 224, 128\"" 内容格式 = 纯文本>
    变量 图片框1 <类型 = 图片框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"33, 191, 200, 200\"" 组件边框 = 单线边框式
            底图方式 = 缩放图片>
    变量 画板1 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"369, 191, 200, 200\"" 组件边框 = 单线边框式
            画板背景色 = 0xFFFFFF 自动重画 = 真>
    变量 成员_程序对象 <类型 = COM对象类>
    变量 成员_文档对象集 <类型 = COM对象类>
    变量 成员_文档对象 <类型 = COM对象类>
    变量 成员_文档选择区 <类型 = COM对象类>
    变量 成员_表格 <类型 = COM对象类>
    变量 成员_区域 <类型 = COM对象类>
    变量 成员_区域1 <类型 = COM对象类>

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮_生成合同)
        {
            // 如果真 (成员_程序对象.获取 ("Photoshop.Application") == 假)
            {
                // 如果真 (成员_程序对象.创建 ("Photoshop.Application", ) == 假)
                {
                    // 信息框 ("创建文档对象失败", , )
                    // 返回 (0)
                }
            }
            // 成员_程序对象.写属性 ("visible", 真)

            // 返回 (0)


            // 如果真 (成员_程序对象.获取 ("Kwps.Application") == 假)
            {
                // 如果真 (成员_程序对象.创建 ("Kwps.Application", ) == 假)
                {
                    // 信息框 ("创建文档对象失败", , )
                    // 返回 (0)
                }
            }

            如果真 (成员_程序对象.获取 ("word.Application") == 假)
            {
                如果真 (成员_程序对象.创建 ("word.Application", ) == 假)
                {
                    信息框 ("创建文档对象失败", , )
                    返回 (0)
                }

            }
            成员_程序对象.写属性 ("visible", 真)
            // 成员_文档对象.获取 ("", )
            成员_文档对象集 = 成员_程序对象.读无参数对象型属性 ("Documents", COM对象类)
            // 成员_文档对象 = 成员_文档对象集.读对象型属性 ("item", COM对象类, 1)
            成员_文档对象 = 成员_文档对象集.读无参数对象型属性 ("Add", COM对象类)

            // 后来加的,设置页面边距
            成员_文档对象.读无参数对象型属性 ("PageSetup", COM对象类).写属性 ("BottomMargin", 70)
            成员_文档对象.读无参数对象型属性 ("PageSetup", COM对象类).写属性 ("TopMargin", 70)
            成员_文档对象.读无参数对象型属性 ("PageSetup", COM对象类).写属性 ("LeftMargin", 60)
            成员_文档对象.读无参数对象型属性 ("PageSetup", COM对象类).写属性 ("RightMargin", 60)


            成员_文档选择区 = 成员_程序对象.读无参数对象型属性 ("Selection", COM对象类)


            成员_文档选择区.写属性 ("Style", "标题 2")
            成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("Alignment", 1)
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "销售合同")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

            成员_文档选择区.写属性 ("Style", "正文")
            成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 12)
            成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 1)
            成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacing", 16)
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "甲方：" + 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 1))
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "乙方：世恒教育网店")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

            变量 局部_样板文本 <类型 = 文本型>
            变量 局部_分割文本 <类型 = 文本数组类>
            局部_样板文本 = 读入文本文件 (取当前目录 () + "\\合同文字样板.txt", , 文本编码类型.多字节)
            子文本替换 (局部_样板文本, "【交货地点】", 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 2), , , )
            子文本替换 (局部_样板文本, "【销售日期】", 时间到文本 (时间操作类.到时间 (取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 3), ), 时间转换部分.日期部分, 真), , , )

            子文本替换 (局部_样板文本, "【客户】", 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 1), , , )
            子文本替换 (局部_样板文本, "【经销商】", "世恒教育网店", , , )
            子文本替换 (局部_样板文本, "【合计金额】", 数值到金融 (文本到小数 (取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 4)), 真), , , )


            调试输出 (局部_样板文本)

            分割文本 (局部_样板文本, "\r\n", 局部_分割文本, , )
            调试输出 (局部_分割文本.取成员数 ())

            计次循环 (局部_分割文本.取成员数 ())
            {
                处理事件 ()

                变量 局部_当前行 <类型 = 文本型>
                局部_当前行 = 删首尾空 (局部_分割文本.取成员 (取循环索引 ()))

                如果 (取文本左边 (局部_当前行, 1) == "第" && 取文本中间 (局部_当前行, 2, 1) == "条")
                {
                    成员_文档选择区.写属性 ("Style", "标题 4")
                    成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 13)
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 4)
                    // 成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 4)
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacing", 14)
                    //.写属性 ("LineSpacing",欲写入属性值)
                    // 写属性 ("LineSpacingRule",欲写入属性值)
                }
                否则
                {
                    成员_文档选择区.写属性 ("Style", "正文")
                    成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 12)
                    // 成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 1)
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 4)
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacing", 16)

                    // 正文时候缩进2个字符
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("FirstLineIndent", 0.35)
                    成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("CharacterUnitFirstLineIndent", 2)
                    // 成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 1)

                }
                如果 (局部_当前行 == "【销售单明细】")
                {
                    调试输出 ("【销售单明细】")
                    成员_文档选择区.写属性 ("Style", "正文")
                    成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 10.5)
                    成员_区域 = 成员_文档选择区.读无参数对象型属性 ("Range", COM对象类)
                    成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
                    成员_区域1 = 成员_文档选择区.读无参数对象型属性 ("Range", COM对象类)

                    变量 局部_行数 <类型 = 整数>
                    变量 局部_列数 <类型 = 整数>
                    变量 局部_计次 <类型 = 整数>
                    局部_行数 = 取程序 ().窗口_销售管理.表格1.行数
                    局部_列数 = 取程序 ().窗口_销售管理.表格1.列数 - 1
                    调试输出 (局部_行数, 局部_列数)
                    成员_文档选择区.写属性 ("Style", "正文")
                    成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 10.5)
                    成员_表格 = 成员_文档选择区.无参数对象型方法 ("Tables", COM对象类)
                    成员_表格 = 成员_表格.对象型方法 ("Add", COM对象类, 成员_区域, 局部_行数, 局部_列数)
                    计次循环 (局部_行数)
                    {
                        循环 (0, 局部_列数, 局部_计次)
                        {
                            如果真 (取循环索引 () == 0)
                            {
                                成员_表格.对象型方法 ("Cell", COM对象类, 取循环索引 () + 1, 局部_计次 + 1).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Size", 11)
                                成员_表格.对象型方法 ("Cell", COM对象类, 取循环索引 () + 1, 局部_计次 + 1).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Bold", 真)

                            }

                            成员_表格.对象型方法 ("Cell", COM对象类, 取循环索引 () + 1, 局部_计次 + 1).读无参数对象型属性 ("Range", COM对象类).写属性 ("Text", 取程序 ().窗口_销售管理.表格1.取文本数据 (取循环索引 (), 局部_计次))
                            调试输出 (取程序 ().窗口_销售管理.表格1.取文本数据 (取循环索引 (), 局部_计次))

                        }
                    }

                    成员_文档选择区.写属性 ("SetRange", 成员_区域1.读无参数属性 ("Start", 整数), 成员_区域1.读无参数属性 ("Start", 整数))

                }
                否则
                {
                    成员_文档选择区.对象型方法 ("TypeText", COM对象类, 局部_当前行)
                    成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

                }

            }

            // 成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).写属性 ("Text", "合计金额")
            // 成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Size", 12)
            // 成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Bold", 真)





            成员_文档选择区.写属性 ("Style", "正文")
            成员_文档选择区.读无参数属性 ("Font", COM对象类).写属性 ("size", 12)
            成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacingRule", 1)
            // 成员_文档选择区.读无参数对象型属性 ("ParagraphFormat", COM对象类).写属性 ("LineSpacing", 14)
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "甲方名称：" + 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 1))
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "甲方签字：")
            超级编辑框_甲方.起始选择位置 = 0
            超级编辑框_甲方.被选择字符数 = -1
            超级编辑框_甲方.复制 ()
            成员_文档选择区.无参数方法 ("Paste", COM对象类)
            // 成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "甲方盖章：")
            成员_文档选择区.读无参数对象型属性 ("InlineShapes", COM对象类).对象型方法 ("AddPicture", COM对象类, 取当前目录 () + "\\tmp.png")

            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "乙方名称：世恒教育网店")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "乙方签字：")
            超级编辑框_乙方.起始选择位置 = 0
            超级编辑框_乙方.被选择字符数 = -1
            超级编辑框_乙方.复制 ()

            成员_文档选择区.无参数方法 ("Paste", COM对象类)

            // 成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "乙方盖章：")
            变量 局部_位图对象 <类型 = 位图对象类>
            画板1.取图片 (局部_位图对象, 132, 132)
            局部_位图对象.写图片文件 (取当前目录 () + "\\tmp.bmp", , )
            成员_文档选择区.读无参数对象型属性 ("InlineShapes", COM对象类).对象型方法 ("AddPicture", COM对象类, 取当前目录 () + "\\tmp.bmp")

            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")


            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "日期：" + 时间到文本 (取现行时间 (), 时间转换部分.日期部分, 真))

            // 成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")





            成员_文档对象.对象型方法 ("SaveAs2", COM对象类, 取当前目录 () + "\\销售合同.docx")



            返回 (0)





            成员_文档选择区.写属性 ("Style", "标题 2")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "沙发沙发上")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

            成员_区域1 = 成员_文档选择区.读无参数对象型属性 ("Range", COM对象类)
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")


            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "起来吧")
            成员_文档选择区.对象型方法 ("TypeText", COM对象类, "\r\n")

            超级编辑框_甲方.起始选择位置 = 0
            超级编辑框_甲方.被选择字符数 = -1
            超级编辑框_甲方.复制 ()

            成员_文档选择区.无参数方法 ("Paste", COM对象类)

            成员_文档选择区.读无参数对象型属性 ("InlineShapes", COM对象类).对象型方法 ("AddPicture", COM对象类, 取当前目录 () + "\\src\\相关素材\\客户LOGO\\百度.png")
            变量 ""
            成员_区域 = 成员_文档选择区.读无参数对象型属性 ("Range", COM对象类)

            成员_表格 = 成员_文档选择区.无参数对象型方法 ("Tables", COM对象类)
            成员_表格 = 成员_表格.对象型方法 ("Add", COM对象类, 成员_区域1, 8, 6)
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 1).读无参数对象型属性 ("Range", COM对象类).写属性 ("Text", "商品编码")
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 1).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Size", 12)
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 1).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Bold", 真)
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).写属性 ("Text", "合计金额")
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Size", 12)
            成员_表格.对象型方法 ("Cell", COM对象类, 1, 6).读无参数对象型属性 ("Range", COM对象类).读无参数对象型属性 ("Font", COM对象类).写属性 ("Bold", 真)





            // 调试输出 (成员_文档对象集.读无参数属性 ("count", 整数))





        }
        否则 (来源对象 == 按钮_设置乙方格式)
        {
            // 信息框 (超级编辑框_甲方.内容, , )
            变量 局部_字符格式 <类型 = 超级编辑框字符格式>
            局部_字符格式 = 超级编辑框_乙方.取选择区字符格式 ()
            通用对话框_字体.字体大小 = 局部_字符格式.字体大小
            通用对话框_字体.字体名称 = 局部_字符格式.字体名称
            通用对话框_字体.字体颜色 = 局部_字符格式.文本颜色
            通用对话框_字体.倾斜 = 假
            通用对话框_字体.加粗 = 假
            通用对话框_字体.下划线 = 假
            通用对话框_字体.删除线 = 假
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.斜体) != 0)
            {
                通用对话框_字体.倾斜 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.粗体) != 0)
            {
                通用对话框_字体.加粗 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.删除线) != 0)
            {
                通用对话框_字体.删除线 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.下划线) != 0)
            {
                通用对话框_字体.下划线 = 真

            }
            通用对话框_字体.类型 = 通用对话框类型.字体选择
            如果真 (通用对话框_字体.打开 (本对象) == 假)
            {
                返回 (0)

            }
            局部_字符格式.字体大小 = 通用对话框_字体.字体大小
            局部_字符格式.字体名称 = 通用对话框_字体.字体名称
            局部_字符格式.文本颜色 = 通用对话框_字体.字体颜色
            // 局部_字符格式.效果 = 通用对话框_字体.加粗
            如果真 (通用对话框_字体.加粗)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.粗体
            }
            如果真 (通用对话框_字体.下划线)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.下划线
            }
            如果真 (通用对话框_字体.删除线)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.删除线
            }
            如果真 (通用对话框_字体.倾斜)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.斜体

            }
            超级编辑框_乙方.置选择区字符格式 (局部_字符格式)



        }
        否则 (来源对象 == 按钮_设置甲方格式)
        {
            变量 局部_字符格式 <类型 = 超级编辑框字符格式>
            局部_字符格式 = 超级编辑框_甲方.取选择区字符格式 ()
            通用对话框_字体.字体大小 = 局部_字符格式.字体大小
            通用对话框_字体.字体名称 = 局部_字符格式.字体名称
            通用对话框_字体.字体颜色 = 局部_字符格式.文本颜色
            通用对话框_字体.倾斜 = 假
            通用对话框_字体.加粗 = 假
            通用对话框_字体.下划线 = 假
            通用对话框_字体.删除线 = 假
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.斜体) != 0)
            {
                通用对话框_字体.倾斜 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.粗体) != 0)
            {
                通用对话框_字体.加粗 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.删除线) != 0)
            {
                通用对话框_字体.删除线 = 真
            }
            如果真 (位与 (局部_字符格式.效果, 超级编辑框字符效果.下划线) != 0)
            {
                通用对话框_字体.下划线 = 真

            }
            通用对话框_字体.类型 = 通用对话框类型.字体选择
            如果真 (通用对话框_字体.打开 (本对象) == 假)
            {
                返回 (0)

            }
            局部_字符格式.字体大小 = 通用对话框_字体.字体大小
            局部_字符格式.字体名称 = 通用对话框_字体.字体名称
            局部_字符格式.文本颜色 = 通用对话框_字体.字体颜色
            // 局部_字符格式.效果 = 通用对话框_字体.加粗
            如果真 (通用对话框_字体.加粗)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.粗体
            }
            如果真 (通用对话框_字体.下划线)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.下划线
            }
            如果真 (通用对话框_字体.删除线)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.删除线
            }
            如果真 (通用对话框_字体.倾斜)
            {
                局部_字符格式.效果 = 局部_字符格式.效果 + 超级编辑框字符效果.斜体

            }
            超级编辑框_甲方.置选择区字符格式 (局部_字符格式)





        }
        返回 (0)
    }

    方法 类_销售管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_销售管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // J:\21天学通火山视窗电脑编程\第12天:COM对象及图文类组件(简易进销存——销售管理)\文档代码
        变量 "//局部_丰富文本" <类型 = 文本型>
        // 局部_丰富文本 = 读入文本文件 ("J:\\21天学通火山视窗电脑编程\\第12天：COM对象及图文类组件（简易进销存——销售管理）\\文档代码\\丰富文本.rtf", , 文本编码类型.多字节)
        // 超级编辑框1.内容 = 局部_丰富文本
        // 超级编辑框_甲方.内容 = "测试一下超级编辑框"
        超级编辑框_甲方.内容 = 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 5)
        超级编辑框_乙方.内容 = "世恒教育网店"


        返回 (0)
    }

    方法 类_生成合同_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_生成合同 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        画板1.画笔粗细 = 3
        画板1.画笔颜色 = 颜色类.红色
        画板1.画椭圆 (1, 1, 196, 196)
        画板1.字体 = "宋体,60,1"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (60, 60, "★", )
        画板1.字体 = "宋体,15,1"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (38, 145, "世恒教育网店", )
        画板1.字体 = "宋体,25,1,0,0,0,500"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (9, 67, "合", )

        画板1.字体 = "宋体,25,1,0,0,0,350"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (38, 32, "同", )

        画板1.字体 = "宋体,25,1,0,0,0,0"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (82, 10, "专", )

        画板1.字体 = "宋体,25,1,0,0,0,3200"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (135, 15, "用", )

        画板1.字体 = "宋体,25,1,0,0,0,3000"
        画板1.文本颜色 = 颜色类.红色
        画板1.定位写出 (170, 40, "章", )
        // 取当前目录 () + "\\tmp.png"
        图片框1.置底图文件 (取当前目录 () + "\\tmp.png")
        超级编辑框_甲方.内容 = 取程序 ().窗口_销售管理.超级列表框_单据列表.取标题 (取程序 ().窗口_销售管理.超级列表框_单据列表.现行选中项, 5)
        超级编辑框_乙方.内容 = "世恒教育网店"

        返回 (0)
    }
}

类 ""
{

    #
}

类 类_销售管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 底色 = 0xFFFFFF 窗口边框 = 无边框
        可否移动 = 真 随意移动 = 真>
{
    变量 树形框_销售日程 <类型 = 树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 175, 315, 576\""
            字体 = ", 14, 0, 0, 0, 0, 0" 显示根部线 = 真 显示连线 = 真 显示加减框 = 真 是否有检查框 = 假 图片组 = "..\\相关素材\\col_icons.png">
    变量 ""
    变量 ""
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 13, 210, 50\"" 标题 = "订单总数"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"273, 13, 210, 50\"" 标题 = "30天内新增"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"536, 13, 210, 50\"" 标题 = "60天内新增"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"799, 13, 210, 50\"" 标题 = "半年新增"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_单据列表 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"341, 175, 674, 176\""
            "类型" = 报表列表框
            报表列 = "0\n-1\n0\n200\n单据号\n0\n-1\n0\n100\n客户名称\n0\n-1\n0\n100\n交货地点\n0\n-1\n0\n110\n销售日期\n0\n-1\n0\n80\n合计金额\n0\n-1\n0\n80\n经手人"
            整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"461, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_合同 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"917, 131, 96, 32\"" 标题 = "合同"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"803, 131, 96, 32\"" 标题 = "删除"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_修改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"689, 131, 96, 32\"" 标题 = "修改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_销售 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"575, 131, 96, 32\"" 标题 = "销售"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"10, 131, 311, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"333, 131, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 ""
    变量 成员_当前状态 <公开 静态 类型 = 文本型>
    变量 成员_商品类别 <公开 静态 类型 = 文本型>
    变量 成员_商品类别ID <公开 静态 类型 = 文本型>
    变量 "//窗口_商品信息" <公开 类型 = 类_商品信息>
    变量 表格1 <公开 类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"341, 375, 664, 376\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 1 表头列数 = 0 是否可编辑 = 假 行数 = 1 列数 = 7 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 窗口_销售下单 <公开 类型 = 类_销售下单>
    变量 窗口_生成合同 <公开 类型 = 类_生成合同>

    方法 类_销售管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_销售管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 ""
        方法_连接Mysql数据库 ()


        // "CREATE TABLE `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin"
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("CREATE TABLE if not exists `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin") == 假)
        {
            信息框 ("创建分类表失败", , )
            销毁 ()
            返回 (0)

        }
        // 信息框 ("创建分类表成功", , )
        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` (`上级ID`,`类别名称` ,  `添加时间`) VALUES (1,'啤酒类',NOW()) ") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
        }

        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` set `上级ID`=1,`类别名称` ='白酒类',`添加时间`=NOW()") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
            // 返回 (0)
        }

        方法_显示销售日程 (树形框_销售日程, -1)
        树形框_销售日程.扩展 (0)
        方法_统计销售 ()


        表格1.列数 = 7
        表格1.列宽 = 120
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "销售数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "销售价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置数据 (0, 6, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (6, 0)
        表格1.置列宽 (2, 80)
        表格1.置列宽 (3, 80)
        表格1.置列宽 (4, 80)
        表格1.置列宽 (5, 80)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置列类型 (5, 表格常量.货币型)
        表格1.置计算公式 (3, 4, 表格常量.乘, 5)
        返回 (0)





        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `splb`") == 假)
        {
            信息框 ("查询失败", , )
            销毁 ()
            返回 (0)
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)

        // 判断循环 (局部_记录集.到下一行 ())
        {
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))

        }
        // 局部_记录集.关闭 ()
        // 返回 (0)

        // 局部_记录集.到指定行 (0)
        // 表格1.行数 = 1
        // 表格1.列数 = 8
        // 表格1.列宽 = 100
        // 表格1.置数据 (0, 0, 表格常量.文本值型, "商品名称")
        // 表格1.置数据 (0, 1, 表格常量.文本值型, "规格型号")
        // 表格1.置数据 (0, 2, 表格常量.文本值型, "销售数量")
        // 表格1.置数据 (0, 3, 表格常量.文本值型, "销售价格")
        // 表格1.置数据 (0, 4, 表格常量.文本值型, "合计金额")
        表格1.列数 = 6
        表格1.列宽 = 120
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "销售数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "销售价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置列宽 (2, 80)
        表格1.置列宽 (3, 80)
        表格1.置列宽 (4, 80)
        表格1.置列宽 (5, 80)

        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            调试输出 (局部_记录集.读文本数据 ("类别名称"))
            // 表格1.置数据 (0, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("类别名称"))
            表格1.插入行 (局部_记录集.读文本数据 ("类别名称"), )


        }
        局部_记录集.关闭 ()
        表格1.置列类型 (5, 表格常量.选择型)
        表格1.置列类型 (6, 表格常量.图片型)
        表格1.添加下拉列表内容 ("1")
        表格1.添加下拉列表内容 ("2")
        表格1.清空下拉列表 ()
        表格1.添加下拉列表内容 ("330ml")
        表格1.添加下拉列表内容 ("500ml")
        表格1.添加下拉列表内容 ("2000ml")
        表格1.置列类型 (1, 表格常量.列表型)
        表格1.置列类型 (2, 表格常量.数值型)
        表格1.置列类型 (3, 表格常量.货币型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置计算公式 (2, 3, 表格常量.乘, 4)
        表格1.插入行 ("合计", )
        表格1.置累加公式 (2, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.置累加公式 (3, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.置累加公式 (4, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.合并 (表格1.行数 - 1, 0, 表格1.行数 - 1, 1)
        表格1.置对齐方式 (表格1.行数 - 1, 0, 表格1.行数 - 1, 0, 表格常量.居中对齐)




        // 调试输出 (表格1.取文本数据 (0, 3))
        // 表格1.行数 = 表格1.行数 + 1





        // 表格1.取图片数据

        返回 (0)
    }

    方法 方法_统计销售
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select count(ID) as `总数` from `xsb`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `xsb`  WHERE TIMESTAMPDIFF(DAY,`销售日期`,NOW())>=0 AND  TIMESTAMPDIFF(DAY,`销售日期`,NOW())<=30") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `xsb`  WHERE TIMESTAMPDIFF(DAY,`销售日期`,NOW())>=0 AND  TIMESTAMPDIFF(DAY,`销售日期`,NOW())<=60") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `xsb`  WHERE TIMESTAMPDIFF(MONTH,`销售日期`,NOW())>=0 AND  TIMESTAMPDIFF(MONTH,`销售日期`,NOW())<=6") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_紫色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()

    }

    方法 方法_显示销售单据列表
    参数 参数_日期 <类型 = 文本型>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_位置 <类型 = 整数>
        变量 局部_语句 <类型 = 文本型>
        局部_语句 = "SELECT `xsb`.`ID` AS `ID` ,`xsb`.`单据号` AS `单据号` ,`kh`.`客户名称` AS `客户名称` ,`xsb`.`交货地点` AS `交货地点` ,`xsb`.`销售日期` AS `销售日期` ,`xsb`.`合计金额` AS `合计金额`  ,`xsb`.`经手人` AS `经手人`   FROM `kh`,`xsb` WHERE `kh`.`ID`=`xsb`.`客户ID` AND YEAR(`xsb`.`销售日期`)*10000+MONTH(`xsb`.`销售日期`)*100+DAY(`xsb`.`销售日期`) =" + 参数_日期

        调试输出 (局部_语句)

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {

            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        超级列表框_单据列表.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_单据列表.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_单据列表.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("单据号"))
            超级列表框_单据列表.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("客户名称"))
            超级列表框_单据列表.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("交货地点"))
            超级列表框_单据列表.置标题 (局部_位置, 3, 局部_记录集.读文本数据 ("销售日期"))
            超级列表框_单据列表.置标题 (局部_位置, 4, 到文本 (局部_记录集.读小数数据 ("合计金额")))
            超级列表框_单据列表.置标题 (局部_位置, 5, 局部_记录集.读文本数据 ("经手人"))

        }
        局部_记录集.关闭 ()



        // Create Table
        // CREATE TABLE `xsb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `客户ID` bigint(11) DEFAULT NULL,  `交货地点` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `销售日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT '0.00',  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=gbk COLLATE=gbk_bin

    }

    方法 方法_显示销售日程
    参数 参数_树型框 <类型 = 树形框>
    参数 参数_当前选中项 <类型 = 整数 @默认值 = -1>
    {
        变量 局部_索引 <类型 = 整数>

        变量 局部_语句 <类型 = 文本型>
        如果真 (参数_当前选中项 != -1)
        {
            判断循环 (树形框_销售日程.取父项目 (参数_当前选中项 + 1) == 参数_当前选中项)
            {
                树形框_销售日程.删除项目 (参数_当前选中项 + 1)
            }

        }
        如果 (参数_当前选中项 == -1)
        {
            局部_索引 = 树形框_销售日程.加入项目 (, "销售日程", , , -1, , )
            树形框_销售日程.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

        }
        否则
        {
            如果 (树形框_销售日程.取缩进层次 (参数_当前选中项) == 1)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`销售日期`) AS `年份` FROM `xsb` ORDER BY `年份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("年份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  YEAR(`销售日期`)*100+month(`销售日期`) AS `月份` FROM `xsb`  where YEAR(`销售日期`) =" + 局部_记录集.读文本数据 ("年份") + " ORDER BY `月份` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()


            }
            否则 (树形框_销售日程.取缩进层次 (参数_当前选中项) == 2)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`销售日期`)*100+month(`销售日期`) AS `月份` FROM `xsb`  where YEAR(`销售日期`) =" + 树形框_销售日程.取项目文本 (参数_当前选中项) + " ORDER BY `月份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("月份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  (YEAR(`销售日期`)*10000+MONTH(`销售日期`)*100+DAY(`销售日期`)) AS `日`  FROM `xsb`  where YEAR(`销售日期`)*100+month(`销售日期`) =" + 局部_记录集.读文本数据 ("月份") + " ORDER BY `日` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()



            }
            否则 (树形框_销售日程.取缩进层次 (参数_当前选中项) == 3)
            {
                局部_语句 = "SELECT DISTINCT  (YEAR(`销售日期`)*10000+MONTH(`销售日期`)*100+DAY(`销售日期`)) AS `日`  FROM `xsb`  where YEAR(`销售日期`)*100+month(`销售日期`) =" + 树形框_销售日程.取项目文本 (参数_当前选中项) + " ORDER BY `日` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("日"), 2, 2, , , )

                }
                局部_记录集.关闭 ()



            }


        }
        调试输出 (局部_语句)

        返回





        如果真 (局部_记录集.从已有连接打开 (局部_语句, 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("类别名称"), 2, 2, 局部_记录集.读整数数据 ("ID"), , )
            变量 局部_记录集1 <类型 = 记录集类>
            如果真 (局部_记录集1.从已有连接打开 ("select count(ID) as [总数] from [商品类别] where [上级ID]=" + 到文本 (局部_记录集.读整数数据 ("ID")), 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
            {
                信息框 ("查询失败", , )
                返回  // day
            }
            局部_记录集1.到首记录 ()
            如果真 (局部_记录集1.记录数量 == 1)
            {
                如果真 (局部_记录集1.读整数数据 ("总数") > 0)
                {
                    参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                }
                局部_记录集1.关闭 ()
            }

            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()




    }

    方法 方法_连接Mysql数据库 <公开>
    {
        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")
        }

    }

    方法 表格_光标位置改变 <接收事件 类型 = 整数 注释 = "当用户更改了当前被选择单元时会产生本事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {

        }
        返回 (0)
    }

    方法 树形框_即将扩展 <接收事件 类型 = 整数 注释 = "当某项目即将被展开以显示出下属子项目时产生本事件,返回1中止展开,返回0则允许.">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 项目索引 <类型 = 整数 注释 = "提供即将扩展显示下属子项目的项目索引,从0开始.">
    {
        如果 (来源对象 == 树形框_销售日程)
        {
            方法_显示销售日程 (树形框_销售日程, 项目索引)
        }
        返回 (0)
    }

    方法 树形框_项目被选择 <接收事件 类型 = 整数 注释 = "当前选择项目被改变时产生此事件">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 选择方式 <类型 = 整数 注释 = "提供是如何操作导致当前选择项目被改变的:  0:键盘; 1:鼠标;  2:其它">
    {
        如果 (来源对象 == 树形框_销售日程)
        {
            如果真 (来源对象.取缩进层次 (来源对象.现行选中项) == 4)
            {
                方法_显示销售单据列表 (来源对象.取项目文本 (来源对象.现行选中项))


            }

        }
        返回 (0)
    }

    方法 超级列表框_左键单击表项 <接收事件 类型 = 整数 注释 = "  当用鼠标左键单击某表项时即产生此事件,接收到此事件后读取" 注释 = "\"现行选中项\"属性即可获得被单击表项的索引.">
    参数 来源对象 <类型 = 超级列表框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级列表框_单据列表)
        {
            表格1.行数 = 1
            // SELECT `xsmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`xsmxb`.`销售数量` AS `销售数量` ,`xsmxb`.`销售价格` AS `销售价格` ,`xsmxb`.`合计金额` AS `合计金额`   FROM `xsmxb`,`spxx` WHERE spxx.`ID`=xsmxb.`商品ID` AND `xsmxb`.`单据ID`=7

            变量 局部_记录集 <类型 = Mysql记录集类>
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `kh` where `客户名称`='" + 超级列表框_单据列表.取标题 (超级列表框_单据列表.现行选中项, 1) + "'") == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)

            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            如果真 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                写到文件 (取当前目录 () + "\\tmp.png", 局部_记录集.读字节集数据 ("客户LOGO"), )
            }
            局部_记录集.关闭 ()


            变量 局部_语句 <类型 = 文本型>
            // SELECT `xsmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`xsmxb`.`销售数量` AS `销售数量` ,`xsmxb`.`销售价格` AS `销售价格` ,`xsmxb`.`合计金额` AS `合计金额`   FROM `xsmxb`,`spxx` WHERE spxx.`ID`=xsmxb.`商品ID` AND `xsmxb`.`单据ID`=7
            局部_语句 = "SELECT `xsmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`xsmxb`.`销售数量` AS `销售数量` ,`xsmxb`.`销售价格` AS `销售价格` ,`xsmxb`.`合计金额` AS `合计金额`   FROM `xsmxb`,`spxx` WHERE spxx.`ID`=xsmxb.`商品ID` AND `xsmxb`.`单据ID`=" + 到文本 (超级列表框_单据列表.取表项数值 (超级列表框_单据列表.现行选中项))

            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            计次循环 ((整数)局部_记录集.行数)
            {
                局部_记录集.到下一行 ()
                表格1.行数 = 表格1.行数 + 1
                表格1.置数据 (表格1.行数 - 1, 0, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品编码"))
                表格1.置数据 (表格1.行数 - 1, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
                表格1.置数据 (表格1.行数 - 1, 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
                表格1.置数据 (表格1.行数 - 1, 3, 表格常量.文本值型, 局部_记录集.读文本数据 ("销售数量"))
                表格1.置数据 (表格1.行数 - 1, 4, 表格常量.文本值型, 局部_记录集.读文本数据 ("销售价格"))
                表格1.置数据 (表格1.行数 - 1, 5, 表格常量.文本值型, 局部_记录集.读文本数据 ("合计金额"))

            }
            局部_记录集.关闭 ()


        }
        返回 (0)

    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_合同)
        {
            如果真 (超级列表框_单据列表.现行选中项 == -1)
            {
                信息框 ("必须选择一条单据才可以生成合同", , )
                返回 (0)


            }
            窗口_生成合同.创建窗口 (, , , , )
        }
        否则 (来源对象 == 超级按钮_销售)
        {
            窗口_销售下单.创建窗口 (, , , , )


        }
        返回 (0)
    }
}

类 类_销售下单 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 516\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"920, 447, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"794, 447, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_交货地点 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"448, 55, 568, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"8, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "单据号">
    变量 编辑框_经手人 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"807, 15, 209, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"701, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "经手人">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"341, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "客户">
    变量 组合框_客户 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"448, 15, 224, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" "类型" = 不可编辑下拉式>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"8, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "销售日期">
    变量 日期框_销售日期 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"124, 55, 193, 32\"">
    变量 编辑框_合计金额 <公开 类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"242, 447, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 假 输入方式 = 只读方式>
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"341, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "交货地点">
    变量 表格1 <类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"8, 103, 1008, 336\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 1 表头列数 = 0 是否可编辑 = 真 行数 = 1 列数 = 8 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"125, 447, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合计金额">
    变量 编辑框_单据号 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"124, 15, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 真>
    变量 超级按钮_删除行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"53, 447, 32, 32\"" 标题 = "－"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"8, 447, 32, 32\"" 标题 = "＋"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 窗口_刷卡窗口 <公开 类型 = 类_刷卡窗口>

    方法 方法_连接Mysql数据库 <公开>
    {

        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")

        }
    }

    #

    方法 类_销售下单_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_销售下单 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        方法_连接Mysql数据库 ()
        方法_获取客户 (组合框_客户)
        编辑框_单据号.内容 = 方法_生成单据号 ()

        表格1.列数 = 7
        表格1.列宽 = 150
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "销售数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "销售价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置数据 (0, 6, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (6, 0)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置列类型 (5, 表格常量.货币型)
        表格1.置计算公式 (3, 4, 表格常量.乘, 5)


        返回 (0)
    }

    方法 方法_获取客户
    参数 参数_组合框 <类型 = 组合框>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `kh`") == 假)
        {
            信息框 ("查询失败", , )
            销毁 ()
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        参数_组合框.清空 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            调试输出 (局部_记录集.读文本数据 ("客户名称"))
            参数_组合框.加入项目 (局部_记录集.读文本数据 ("客户名称"), 局部_记录集.读整数数据 ("ID"))

        }
        局部_记录集.关闭 ()




    }

    方法 方法_生成单据号 <类型 = 文本型>
    {
        变量 局部_单据号 <类型 = 文本型>
        局部_单据号 = 到文本 (取年份 (取现行时间 ())) + 取文本右边 ("0" + 到文本 (取月份 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取日 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取小时 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取分钟 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取秒 (取现行时间 ())), 2) + 到文本 (取随机数 (10000, 99999))

        返回 (局部_单据号)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_删除行)
        {

            表格1.删除行 (表格1.取光标行号 ())

        }
        否则 (来源对象 == 超级按钮_添加行)
        {
            表格1.行数 = 表格1.行数 + 1

        }
        否则 (来源对象 == 超级按钮_保存)
        {

            计次循环 (表格1.行数 - 1)
            {
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select ID as `总数` from `kcb` where `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6))) == 假)
                {
                    信息框 ("查询失败", , )
                    返回 (0)
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)

                如果 (局部_记录集.行数 == 0)
                {
                    信息框 ("订单信息中有存在未入库商品，无法下单", , )
                    返回 (0)
                }

            }
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "INSERT INTO `xsb` set `单据号`='" + 编辑框_单据号.内容 + "',`客户ID`=" + 到文本 (组合框_客户.取项目数值 (组合框_客户.现行选中项)) + ",`交货地点`='" + 编辑框_交货地点.内容 + "',`销售日期`='" + 到文本 (取年份 (日期框_销售日期.今天)) + 取文本右边 ("0" + 到文本 (取月份 (日期框_销售日期.今天)), 2) + 取文本右边 ("0" + 到文本 (取日 (日期框_销售日期.今天)), 2) + "',`合计金额`=" + 到文本 (文本到整数 (编辑框_合计金额.内容)) + ",`经手人`='" + 编辑框_经手人.内容 + "',`添加时间`=now()"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("保存销售单失败", , )
                返回 (0)

            }
            变量 局部_单据ID <类型 = 长整数>
            局部_单据ID = 取程序 ().数据库_全局Mysql库.取自增值 ()

            // select last_insert_id()
            计次循环 (表格1.行数 - 1)
            {


                变量 "// 局部_记录集" <类型 = Mysql记录集类>
                // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select ID as `总数` from `kcb` where `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6))) == 假)
                {
                    // 信息框 ("查询失败", , )
                    // 返回 (0)
                }
                // 局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                // 调试输出 (局部_记录集.行数)

                // 如果 (局部_记录集.行数 == 0)
                {
                    // 信息框 ("库存信息中不存在当前商品，无法下单", , )
                    // 返回 (0)
                    // // 局部_语句 = "INSERT INTO `kcb` set `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6)) + ",`入库数`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`库存数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`添加时间`=now()"
                }
                // 否则

                局部_语句 = "update  `kcb` set `出库数`=`出库数`+" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`库存数量`=`库存数量`-" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`修改时间`=now() where `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6))

                // 局部_记录集.关闭 ()

                调试输出 (局部_语句)
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("修改库存信息失败", , )
                    返回 (0)
                }


                局部_语句 = "INSERT INTO `xsmxb` set `单据ID`=" + 到文本 (局部_单据ID) + ",`商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6)) + ",`销售数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`销售价格`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 4)) + ",`合计金额`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 5))
                调试输出 (局部_语句)
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("保存销售单明细失败", , )
                    返回 (0)
                }


                // Create Table
                // CREATE TABLE `xsmxb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据ID` bigint(11) DEFAULT NULL,  `商品ID` bigint(11) DEFAULT NULL,  `销售数量` bigint(11) DEFAULT NULL,  `销售价格` double(8,2) DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin


            }
            信息框 ("保存销售订单成功", , )
            窗口_刷卡窗口.创建窗口 (, , , , )
            编辑框_单据号.内容 = 方法_生成单据号 ()



        }






        返回 (0)

        // Create Table
        // CREATE TABLE `xsb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `客户ID` bigint(11) DEFAULT NULL,  `交货地点` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `销售日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin




        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }

    方法 表格_结束编辑 <接收事件 类型 = 整数 注释 = "当单元格编辑结束之后产生此事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {
            // 6954767410388
            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "select * from `spxx` where `商品编码`='" + 表格1.取文本数据 (表格1.取光标行号 (), 表格1.取光标列号 ()) + "'"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            如果真 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                表格1.置数据 (表格1.取光标行号 (), 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
                表格1.置数据 (表格1.取光标行号 (), 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
                表格1.置数据 (表格1.取光标行号 (), 6, 表格常量.文本值型, 到文本 (局部_记录集.读整数数据 ("ID")))
                表格1.置数据 (表格1.取光标行号 (), 4, 表格常量.文本值型, 到文本 (局部_记录集.读小数数据 ("零售价")))

            }
            局部_记录集.关闭 ()
            变量 局部_合计 <类型 = 小数>
            计次循环 (表格1.行数 - 1)
            {
                局部_合计 = 局部_合计 + 文本到小数 (表格1.取文本数据 (取循环索引 () + 1, 5))
            }
            编辑框_合计金额.内容 = 到文本 (局部_合计)


        }
        返回 (0)
    }

    方法 表格_光标位置改变 <接收事件 类型 = 整数 注释 = "当用户更改了当前被选择单元时会产生本事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {

        }
        返回 (0)
    }
}

类 类_刷卡窗口 <基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"442, 296\"">
{
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"21, 79, 96, 40\"" 标题 = "卡内余额"
            字体 = ", 16, 0, 0, 0, 0, 0">
    变量 编辑框_卡内余额 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"125, 79, 232, 40\""
            字体 = ", 16, 0, 0, 0, 0, 0" 输入方式 = 只读方式>
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"21, 143, 96, 40\"" 标题 = "本次消费"
            字体 = ", 16, 0, 0, 0, 0, 0">
    变量 编辑框_本次消费 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"125, 143, 232, 40\""
            字体 = ", 16, 0, 0, 0, 0, 0" 输入方式 = 只读方式>
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"21, 15, 96, 40\"" 标题 = "客户"
            字体 = ", 16, 0, 0, 0, 0, 0">
    变量 编辑框_客户名称 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"125, 11, 200, 40\""
            字体 = ", 16, 0, 0, 0, 0, 0" 输入方式 = 只读方式>
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"237, 223, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"101, 223, 96, 32\"" 标题 = "确认"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_刷卡 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"333, 15, 96, 32\"" 标题 = "刷卡"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">

    #

    方法 类_刷卡窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_刷卡窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        编辑框_本次消费.内容 = 取程序 ().窗口_销售下单.编辑框_合计金额.内容
        返回 (0)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_刷卡)
        {
            变量 局部_状态 <类型 = 整数>
            局部_状态 = 类_磁卡操作.方法_打开串口 (4, 取变量地址 (类_磁卡操作.成员_rHandle_COM句柄))
            调试输出 (局部_状态)
            调试输出 (类_磁卡操作.成员_rHandle_COM句柄)
            局部_状态 = 类_磁卡操作.方法_寻找卡 (类_磁卡操作.成员_rHandle_COM句柄)
            调试输出 (局部_状态)
            类_磁卡操作.成员_pSNR_序列号 = 取空白字节集 (8)
            局部_状态 = 类_磁卡操作.方法_读卡序列号 (类_磁卡操作.成员_rHandle_COM句柄, 取字节集指针 (类_磁卡操作.成员_pSNR_序列号))
            调试输出 (局部_状态)
            调试输出 (多字节到文本 (类_磁卡操作.成员_pSNR_序列号))
            局部_状态 = 类_磁卡操作.方法_关闭串口 (类_磁卡操作.成员_rHandle_COM句柄)
            调试输出 (局部_状态)

            如果真 (局部_状态 != 0 || 取文本长度 (多字节到文本 (类_磁卡操作.成员_pSNR_序列号)) != 8)
            {
                信息框 ("读卡失败，请重新读卡", 信息框按钮.错误图标, )
                返回 (0)

            }
            变量 局部_记录集 <类型 = Mysql记录集类>
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `kh` where `会员卡号`='" + 多字节到文本 (类_磁卡操作.成员_pSNR_序列号) + "'") == 假)
            {
                信息框 ("查询失败", , )
                销毁 ()
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            如果 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                编辑框_客户名称.标记 = 局部_记录集.读文本数据 ("ID")
                编辑框_客户名称.内容 = 局部_记录集.读文本数据 ("客户名称")
                编辑框_卡内余额.内容 = 局部_记录集.读文本数据 ("卡内余额")
            }
            否则
            {
                信息框 ("依照卡片查询客户失败", 信息框按钮.错误图标, )
                编辑框_客户名称.标记 = ""
                编辑框_客户名称.内容 = ""
                编辑框_卡内余额.内容 = ""


            }
            局部_记录集.关闭 ()


        }
        否则 (来源对象 == 超级按钮_保存)
        {
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "update  `kh` set `卡内余额`=`卡内余额`-" + 编辑框_本次消费.内容 + ",`修改时间`=now() where `ID`=" + 编辑框_客户名称.标记
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("结账失败", 信息框按钮.错误图标, )
                销毁 ()
                返回 (0)
            }

            信息框 ("结账成功", 信息框按钮.信息图标, )
            返回 (0)




        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_锐浪报表 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"967, 751\"">
{
    变量 查询显示器1 <类型 = 查询显示器 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"21, 407, 920, 320\"">
    变量 报表设计器1 <类型 = 报表设计器 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"21, 7, 920, 344\"">
    变量 按钮_普通列表 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"61, 359, 128, 40\"" 标题 = "普通列表">
    变量 按钮_分组列表 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"243, 359, 128, 40\"" 标题 = "分组列表">
    变量 按钮_推模式列表1 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"607, 359, 128, 40\"" 标题 = "推模式列表1">
    变量 按钮_分组列表1 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"425, 359, 128, 40\"" 标题 = "打印">
    变量 按钮_推模式列表2 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"789, 359, 128, 40\"" 标题 = "推模式列表2">
    变量 报表_公用 <公开 类型 = 报表>
    变量 窗口_锐浪打印 <公开 类型 = 类_打印窗口>

    方法 类_锐浪报表_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_锐浪报表 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {

        返回 (0)
    }

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮_推模式列表2)
        {
            报表_公用.释放 ()
            报表_公用.初始化 ()
            挂接事件 (报表_公用, 222)

            报表_公用.忽略数据绑定 = 真
            报表_公用.插入明细网格 ()
            报表_公用.获取明细网格.获取边框.获取画笔.宽度 = 0
            报表_公用.获取明细网格.获取边框.获取内框画笔.宽度 = 0
            报表_公用.获取明细网格.显示列线 = 假
            报表_公用.获取明细网格.显示行线 = 假
            报表_公用.获取明细网格.增加列 ("", "", "", 16)
            报表_公用.获取明细网格.获取标题行.高度 = 0
            报表_公用.获取明细网格.获取标题行.可见性 = 假
            报表_公用.获取明细网格.获取内容行.高度 = 3.6
            报表_公用.获取明细网格.获取内容行.获取内容格集合.按序号获取项目 (1).自由格 = 真
            变量 局部_部件 <类型 = 部件框>
            变量 局部_自由表格 <类型 = 自由表格>
            局部_部件 = 报表_公用.获取明细网格.获取内容行.获取内容格集合.按序号获取项目 (1).获取部件框集合.增加 (部件框类型枚举.自由表格框)
            局部_自由表格 = 局部_部件.获取为自由表格
            局部_自由表格.上 = 0.6
            局部_自由表格.获取边框.边框模式 = 边框模式枚举.画上 + 边框模式枚举.画下 + 边框模式枚举.画左 + 边框模式枚举.画右
            局部_自由表格.居中方式 = 居中方式枚举.水平垂直
            局部_自由表格.行数 = 3
            局部_自由表格.列数 = 4
            局部_自由表格.获取指定单元格 (1, 1).合并列数 = 4
            局部_自由表格.获取指定行 (1).高度 = 1.5
            局部_自由表格.获取指定单元格 (1, 1).文本 = "客户联系卡"
            局部_自由表格.获取指定单元格 (1, 1).获取字体.字号 = 18
            局部_自由表格.获取指定单元格 (1, 1).获取字体.名称 = "华文行楷"
            局部_自由表格.获取指定单元格 (1, 1).获取文本格式.文字对齐方式 = 文字对齐方式枚举.中中
            局部_自由表格.获取指定单元格 (2, 2).合并列数 = 3
            报表_公用.获取明细网格.获取数据集.增加字段 ("客户名称", 字段类型枚举.字符型)
            报表_公用.获取明细网格.获取数据集.增加字段 ("联系人", 字段类型枚举.字符型)
            报表_公用.获取明细网格.获取数据集.增加字段 ("电话", 字段类型枚举.字符型)
            局部_自由表格.获取指定单元格 (2, 1).文本 = "客户名称"
            局部_自由表格.获取指定单元格 (2, 2).文本 = "[#客户名称#]"
            局部_自由表格.获取指定单元格 (3, 1).文本 = "联系人"
            局部_自由表格.获取指定单元格 (3, 2).文本 = "[#联系人#]"
            局部_自由表格.获取指定单元格 (3, 3).文本 = "联系电话"
            局部_自由表格.获取指定单元格 (3, 4).文本 = "[#电话#]"

            报表_公用.加载数据准备 ()
            方法_连接Mysql数据库 ()
            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "SELECT `kh`.`客户名称` AS `客户名称` ,`kh`.`联系人` AS `联系人` ,`kh`.`电话` AS `电话`  FROM `kh` "

            调试输出 (局部_语句)

            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )

                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            计次循环 ((整数)局部_记录集.行数)
            {
                局部_记录集.到下一行 ()
                报表_公用.获取明细网格.获取数据集.追加 ()
                报表_公用.获取明细网格.获取数据集.按名称取字段 ("客户名称").字符值 = 局部_记录集.读文本数据 ("客户名称")
                报表_公用.获取明细网格.获取数据集.按名称取字段 ("联系人").字符值 = 局部_记录集.读文本数据 ("联系人")
                报表_公用.获取明细网格.获取数据集.按名称取字段 ("电话").字符值 = 局部_记录集.读文本数据 ("电话")
                调试输出 (局部_记录集.读文本数据 ("客户名称"))


                报表_公用.获取明细网格.获取数据集.提交 ()

            }
            局部_记录集.关闭 ()





            报表设计器1.关联报表 = 报表_公用
            查询显示器1.停止 ()
            查询显示器1.初始化 ()
            查询显示器1.关联报表 = 报表_公用
            查询显示器1.启动 ()

        }
        否则 (来源对象 == 按钮_推模式列表1)
        {
            报表_公用.释放 ()
            报表_公用.初始化 ()
            挂接事件 (报表_公用, 111)
            报表_公用.忽略数据绑定 = 真
            报表_公用.插入明细网格 ()
            计次循环 (6)
            {
                报表_公用.获取明细网格.获取数据集.增加字段 ("第" + 到文本 (取循环索引 () + 1) + "列", 字段类型枚举.字符型)
                报表_公用.获取明细网格.增加列 ("第" + 到文本 (取循环索引 () + 1) + "列", "第" + 到文本 (取循环索引 () + 1) + "列", "第" + 到文本 (取循环索引 () + 1) + "列", 3)


            }
            // 报表_公用.加载数据准备 ()

            报表设计器1.关联报表 = 报表_公用
            查询显示器1.停止 ()
            查询显示器1.初始化 ()
            查询显示器1.关联报表 = 报表_公用
            查询显示器1.启动 ()




        }
        否则 (来源对象 == 按钮_分组列表1)
        {
            窗口_锐浪打印.创建窗口 (, , , , )

        }
        否则 (来源对象 == 按钮_分组列表)
        {
            报表_公用.释放 ()
            报表_公用.初始化 ()
            报表_公用.从文件加载报表 (取当前目录 () + "\\商品列表.grf")
            // Driver={Microsoft Access Driver (*.mdb)};Dbq=简易进销存.mdb
            报表_公用.获取明细网格.获取数据集.连接串 = "Driver={Microsoft Access Driver (*.mdb)};Dbq=" + 取当前目录 () + "\\简易进销存.mdb"
            // 报表_公用.获取明细网格.获取数据集.查询SQL = ""

            报表设计器1.关联报表 = 报表_公用
            查询显示器1.停止 ()
            查询显示器1.初始化 ()
            查询显示器1.关联报表 = 报表_公用
            查询显示器1.启动 ()


        }
        否则 (来源对象 == 按钮_普通列表)
        {
            报表_公用.释放 ()
            报表_公用.初始化 ()
            报表_公用.从文件加载报表 (取当前目录 () + "\\供应商列表.grf")
            报表设计器1.关联报表 = 报表_公用
            查询显示器1.停止 ()
            查询显示器1.初始化 ()
            查询显示器1.关联报表 = 报表_公用
            查询显示器1.启动 ()

        }
        返回 (0)
    }

    方法 方法_连接Mysql数据库 <公开>
    {
        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")
        }

    }

    方法 报表_请求记录数据 <接收事件 类型 = 整数 注释 = "FetchRecord 编号：2"
            注释 = "采用推模式填充数据时，当报表的记录集上没有定义数据源连接串与查询SQL，或其“忽略数据查询”属性设为“是”，则在报表生成时，报表主对象请求数据时触发本事件。报表开发者必须在此事件中向记录集填入数据。"
            注释 = "如果没有定义数据库连接串与查询SQL，或指定在运行时不从数据库连接串与查询SQL设置中取得明细记录数据，则FetchRecord 事件在报表请求数据时触发，报表每生成一次触发一次本事件，只有具有明细网格的报表才会触发此事件。"
            注释 = "报表开发者必须响应此事件，且只能在此事件中向记录集填充记录。报表开发者使用记录集接口与字段接口的属性与方法向记录集填充记录。"
            注释 = "注意：Delphi 与 C++Builder 的包装类定义了一个 DataSet 属性，并对 FetchRecord 事件在包装类中进行了响应，如果设置了 DataSet 属性值，则会把 DataSet 属性关联记录集对象中的数据填入到 Grid++Report 中。"
            注释 = "因此在Delphi 与 C++Builder 中一般通过设置 DataSet 属性来提供明细记录数据。">
    参数 来源对象 <类型 = 报表 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (标记值 == 111)
        {
            计次循环 (16)
            {
                报表_公用.获取明细网格.获取数据集.追加 ()
                计次循环 (6)
                {
                    变量 局部_文本 <类型 = 文本型>
                    局部_文本 = 到文本 (取随机数 ((整数)(1 * 求次方 (10, 取循环索引 () + 1)), (整数)(9 * 求次方 (10, 取循环索引 () + 1))))
                    调试输出 (局部_文本)
                    报表_公用.获取明细网格.获取数据集.按名称取字段 ("第" + 到文本 (取循环索引 () + 1) + "列").字符值 = 局部_文本

                }
                报表_公用.获取明细网格.获取数据集.提交 ()

            }



        }
        返回 (0)
    }
}

类 类_打印窗口 <基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1026, 730\"">
{
    变量 图片框1 <类型 = 图片框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"13, 7, 1000, 720\"">
    变量 打印显示器1 <类型 = 打印显示器 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\nparent_id = 101\r\npos = \"16, 0, 80, 72\"">

    #

    方法 图片框_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 图片框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 图片框1)
        {
            打印显示器1.创建组件 (图片框1, 0, 0, 取用户区宽度 (), 取用户区高度 (), )
            打印显示器1.初始化 ()
            打印显示器1.关联报表 = 取程序 ().窗口_锐浪报表.报表_公用
            打印显示器1.启动 ()

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_全局变量
{
    变量 成员_当前用户 <公开 静态 类型 = 文本型>
    变量 成员_登录次数 <公开 静态 类型 = 整数>

    方法 关闭指定窗口 <公开 静态>
    {

    }

    #
}

# ===

类 生物类 <折叠>
{
    变量 是否在地球 <公开 静态 类型 = 逻辑型>

    #
}

类 植物类 <基础类 = 生物类 折叠>
{
    变量 ""

    #
}

类 动物类 <基础类 = 生物类 折叠>
{
    变量 体重 <公开 类型 = 小数>
    变量 年龄 <公开 类型 = 整数>
    变量 几只脚 <公开 类型 = 整数>
    变量 昵称 <公开 类型 = 文本型>
    变量 类别 <公开 类型 = 文本型>

    方法 吃 <公开 类型 = 文本型 @虚拟方法 = 可覆盖>
    {
        返回 ("有吃草的有吃肉的还有吃。。。")
    }

    #
}

类 禽类 <基础类 = 动物类 折叠>
{
    变量 展翅宽度 <类型 = 小数>

    方法 吃 <公开 类型 = 文本型 @虚拟方法 = 可覆盖>
    {
        返回 ("虫子")
    }

    #
}

类 兽类 <基础类 = 动物类>
{

    #
}

类 食肉动物类 <基础类 = 兽类 折叠>
{
    方法 吃 <公开 类型 = 文本型 @虚拟方法 = 可覆盖>
    {
        返回 ("肉")
    }

    #
}

类 食草动物类 <基础类 = 兽类 折叠>
{
    方法 吃 <公开 类型 = 文本型 @虚拟方法 = 可覆盖>
    {
        返回 ("草")
    }

    #
}

类 人类 <基础类 = 动物类 折叠>
{
    变量 学历 <公开 类型 = 文本型>
    变量 姓名 <公开 类型 = 文本型>

    方法 吃 <公开 类型 = 文本型 @虚拟方法 = 可覆盖>
    {
        返回 ("基本上什么东西都能让他们想办法给吃了")
    }

    方法 学习 <公开 类型 = 文本型>
    参数 参数_为什么学习 <类型 = 文本型>
    {






        返回 ("为" + 参数_为什么学习 + "而学习")

    }

    #
}

类 ""

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 窗口_供应商管理 <公开 类型 = 类_供应商管理>
    变量 数据库_全局Mysql库 <公开 类型 = Mysql数据库类>
    变量 数据库_全局ACCESS库 <公开 类型 = 数据库类>

    方法 启动方法 <公开 类型 = 整数>
    {
        窗口_供应商管理.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"500, 300\"" 标题 = "我的主窗口">

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_供应商管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 窗口边框 = 无边框 随意移动 = 真 可否移动 = 真
        底色 = 0xFFFFFF>
{
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 13, 210, 50\"" 标题 = "总数量"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"273, 13, 210, 50\"" 标题 = "合作中"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"536, 13, 210, 50\"" 标题 = "终止中"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"799, 13, 210, 50\"" 标题 = "30天内到期"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_显示 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"7, 175, 1008, 576\""
            "类型" = 报表列表框
            报表列 = "0\n-1\n0\n200\n供应商名称\n0\n-1\n0\n100\n联系人\n0\n-1\n0\n100\n电话\n0\n-1\n0\n80\n进货折扣\n0\n-1\n0\n80\n信誉等级\n0\n-1\n0\n80\n是否合作\n0\n-1\n0\n130\n合同起始\n0\n-1\n0\n130\n合同终止\n0\n-1\n0\n100\n备注"
            整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"328, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_打印 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"917, 131, 96, 32\"" 标题 = "打印"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"622, 131, 96, 32\"" 标题 = "删除"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_修改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"524, 131, 96, 32\"" 标题 = "修改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"426, 131, 96, 32\"" 标题 = "添加"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"12, 131, 196, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"216, 131, 99, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 超级按钮_导出 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"818, 131, 96, 32\"" 标题 = "导出"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_导入 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"720, 131, 96, 32\"" 标题 = "导入"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 窗口_供应商信息 <公开 类型 = 类_供应商信息>
    变量 成员_当前状态 <公开 静态 类型 = 文本型>

    方法 类_供应商管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_供应商管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 局部_文本数组 <类型 = 文本数组类>
        取命令行 (局部_文本数组)
        如果真 (局部_文本数组.取成员数 () != 2)
        {
            信息框 ("非法调用，程序将退出！", 信息框按钮.错误图标, )
            结束 ()

        }
        如果真 (局部_文本数组.取成员 (0) != "$_$" || 局部_文本数组.取成员 (1) != "SHTEACH")
        {
            信息框 ("非法调用，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
        }
        // 信息框 (到文本 (局部_文本数组.取成员数 ()), , )
        // 计次循环 (局部_文本数组.取成员数 ())
        {
            // 信息框 (局部_文本数组.取成员 (取循环索引 ()), , )


        }



        // 如果真 (取程序 ().数据库_全局ACCESS库.当前状态 == 数据库状态类型.关闭)
        {
            // 如果真 (取程序 ().数据库_全局ACCESS库.连接Access (取当前目录 () + "\\简易进销存.accdb", , 真) == 假)
            {
                // 信息框 ("数据库连接失败", , )
                // 销毁 ()
            }


        }
        方法_连接Mysql数据库 ()
        方法_统计供应商 ()

        方法_显示供应商列表 ("select * from `gys`")

        返回 (0)





    }

    方法 方法_连接Mysql数据库 <公开>
    {

        如果真 (取程序 ().数据库_全局Mysql库.检测连接状态 () != 0)
        {
            如果真 (取程序 ().数据库_全局Mysql库.连接 ("127.0.0.1", "root", "root", "jyjxc", 3306, , ) == 假)
            {
                信息框 ("Mysql数据库连接失败", , )
                销毁 ()
                返回
            }
            // 信息框 ("Mysql数据库连接成功", , )
            取程序 ().数据库_全局Mysql库.置当前字符集 ("gbk")

        }
    }

    方法 方法_统计供应商
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select count(ID) as `总数` from `gys`") == 假)
        {
            信息框 ("查询失败1", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()



        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select count(ID) as `总数` from `gys` where `是否合作`=1") == 假)
        {
            信息框 ("查询失败2", , )

            返回
        }

        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        如果真 (局部_记录集.到下一行 ())
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()



        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select count(ID) as `总数` from `gys` where `是否合作`=0") == 假)
        {
            信息框 ("查询失败3", , )
            返回
        }

        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        如果真 (局部_记录集.到下一行 ())
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `gys`  WHERE DATEDIFF(`合同终止`,NOW())>=0 AND  DATEDIFF(`合同终止`,NOW())<=30") == 假)
        {
            信息框 ("查询失败4", , )
            返回  // day

        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        如果真 (局部_记录集.到下一行 ())
        {
            标签_紫色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


    }

    方法 方法_显示供应商列表
    参数 参数_SQL语句 <类型 = 文本型>
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_位置 <类型 = 整数>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (参数_SQL语句) == 假)
        {
            信息框 ("查询失败0", , )
            返回  // day
        }

        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        超级列表框_显示.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_显示.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_显示.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("供应商名称"))
            超级列表框_显示.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("联系人"))
            超级列表框_显示.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("电话"))
            超级列表框_显示.置标题 (局部_位置, 3, 到文本 (局部_记录集.读小数数据 ("进货折扣")))
            超级列表框_显示.置标题 (局部_位置, 4, 到文本 (局部_记录集.读整数数据 ("信誉等级")))
            超级列表框_显示.置标题 (局部_位置, 5, 选择 (到文本 (局部_记录集.读逻辑型数据 ("是否合作")) == "1", "是", "否"))
            超级列表框_显示.置标题 (局部_位置, 6, 局部_记录集.读文本数据 ("合同起始"))
            超级列表框_显示.置标题 (局部_位置, 7, 局部_记录集.读文本数据 ("合同终止"))

            超级列表框_显示.置标题 (局部_位置, 8, 局部_记录集.读文本数据 ("备注"))


        }
        局部_记录集.关闭 ()
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_导入)
        {
            变量 局部_CSV文本 <类型 = 文本型>
            变量 局部_文本数组 <类型 = 文本数组类>
            变量 局部_文本数组1 <类型 = 文本数组类>
            变量 ""
            变量 局部_计次 <类型 = 整数>
            局部_CSV文本 = 读入文本文件 (取当前目录 () + "\\导出供应商.csv", , 文本编码类型.多字节)
            分割文本 (局部_CSV文本, "\r\n", 局部_文本数组, , )
            变量 局部_添加语句 <类型 = 文本型>
            局部_添加语句 = "insert into `gys` ("

            计次循环 (局部_文本数组.取成员数 ())
            {
                如果真 (局部_文本数组.取成员 (取循环索引 ()) == "")
                {
                    到循环尾

                }
                如果 (取循环索引 () == 0)
                {
                    分割文本 (局部_文本数组.取成员 (取循环索引 ()), ",", 局部_文本数组1, , )
                    循环 (0, 局部_文本数组1.取成员数 (), 局部_计次)
                    {
                        如果真 (局部_文本数组1.取成员 (局部_计次) != "")
                        {
                            局部_添加语句 = 局部_添加语句 + "`" + 局部_文本数组1.取成员 (局部_计次) + "`"


                        }
                        如果 (局部_计次 != 局部_文本数组1.取成员数 () - 1)
                        {
                            局部_添加语句 = 局部_添加语句 + ","
                        }
                        否则
                        {
                            局部_添加语句 = 局部_添加语句 + ") values ("

                        }


                    }




                }
                否则
                {
                    变量 局部_数据段 <类型 = 文本型>
                    局部_数据段 = ""
                    分割文本 (局部_文本数组.取成员 (取循环索引 ()), ",", 局部_文本数组1, , 假)
                    调试输出 (局部_文本数组1.取成员数 ())

                    循环 (0, 局部_文本数组1.取成员数 () - 1, 局部_计次)
                    {
                        如果 (局部_计次 == 6)
                        {
                            局部_数据段 = 局部_数据段 + "'" + 选择 (局部_文本数组1.取成员 (局部_计次) == "是", "1", "0") + "'"
                        }
                        否则
                        {
                            局部_数据段 = 局部_数据段 + "'" + 局部_文本数组1.取成员 (局部_计次) + "'"


                        }
                        如果 (局部_计次 != 局部_文本数组1.取成员数 () - 2)
                        {
                            局部_数据段 = 局部_数据段 + ","
                        }
                        否则
                        {
                            局部_数据段 = 局部_数据段 + ")"
                        }
                    }
                    // 调试输出 (局部_数据段)
                    调试输出 (局部_添加语句 + 局部_数据段)

                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_添加语句 + 局部_数据段) == 假)
                    {
                        信息框 ("导入数据失败", , )
                        返回 (0)  // day
                    }


                    // 分割文本 (局部_文本数组.取成员 (取循环索引 () + 1), ",", 局部_文本数组1, , )
                    // 局部_索引 = 超级列表框1.插入表项 (, , , , , )
                    // 循环 (0, 局部_文本数组1.取成员数 (), 局部_计次)
                    {
                        // 超级列表框1.置标题 (局部_索引, 局部_计次, 局部_文本数组1.取成员 (局部_计次))
                        // // 超级列表框1.置标题 (局部_索引, 2, 局部_记录集.读文本数据 ("年龄"))
                    }

                }
            }

            调试输出 (局部_添加语句)


        }
        否则 (来源对象 == 超级按钮_导出)
        {
            变量 局部_CSV文本 <类型 = 文本型>
            变量 局部_计次 <类型 = 整数>
            局部_CSV文本 = "ID,"
            计次循环 (超级列表框_显示.取列数 ())
            {
                局部_CSV文本 = 局部_CSV文本 + 超级列表框_显示.取列标题 (取循环索引 ()) + ","

            }
            局部_CSV文本 = 局部_CSV文本 + "\r\n"

            计次循环 (超级列表框_显示.取表项数 ())
            {
                局部_CSV文本 = 局部_CSV文本 + 到文本 (超级列表框_显示.取表项数值 (取循环索引 ())) + ","
                循环 (0, 超级列表框_显示.取列数 (), 局部_计次)
                {
                    局部_CSV文本 = 局部_CSV文本 + 超级列表框_显示.取标题 (取循环索引 (), 局部_计次) + ","

                }
                局部_CSV文本 = 局部_CSV文本 + "\r\n"

            }
            写出文本文件 (局部_CSV文本, 取当前目录 () + "\\导出供应商.csv", , 文本编码类型.多字节)

            调试输出 (局部_CSV文本)





        }
        否则 (来源对象 == 超级按钮_删除)
        {

            如果真 (信息框 ("是否要删除选中的供应商，删除后无法回复！", 信息框按钮.询问图标 + 信息框按钮.是否钮, ) == 返回按钮类型.否钮)
            {
                返回 (0)

            }
            变量 局部_SQL语句 <类型 = 文本型>
            变量 局部_记录集 <类型 = 记录集类>
            局部_SQL语句 = "delete from [供应商] where ID= " + 到文本 (超级列表框_显示.取表项数值 (超级列表框_显示.现行选中项))
            调试输出 (局部_SQL语句)

            局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
            // 局部_记录集.取错误 ()
            // 调试输出 (局部_记录集.状态)
            // 数据库状态类型.
            超级列表框_显示.删除表项 (超级列表框_显示.现行选中项)


        }
        否则 (来源对象 == 超级按钮_修改)
        {
            成员_当前状态 = "修改"
            窗口_供应商信息.创建窗口 (, , , , )

        }
        否则 (来源对象 == 超级按钮_添加)
        {
            成员_当前状态 = "添加"
            窗口_供应商信息.创建窗口 (, , , , )

        }
        否则 (来源对象 == 超级按钮_查询)
        {
            变量 局部_SQL语句 <类型 = 文本型>

            如果 (选择框_模糊查找.选中 == 假)
            {
                局部_SQL语句 = "select * from `gys` where  `供应商名称`='" + 编辑框_关键字.内容 + "' or `联系人`='" + 编辑框_关键字.内容 + "' or `电话`='" + 编辑框_关键字.内容 + "' or `备注`='" + 编辑框_关键字.内容 + "'"
                方法_显示供应商列表 (局部_SQL语句)
                调试输出 (局部_SQL语句)
            }
            否则
            {
                局部_SQL语句 = "select * from `gys` where  `供应商名称` like '%" + 编辑框_关键字.内容 + "%' or `联系人` like '%" + 编辑框_关键字.内容 + "%' or `电话` like '%" + 编辑框_关键字.内容 + "%' or `备注` like '%" + 编辑框_关键字.内容 + "%'"
                方法_显示供应商列表 (局部_SQL语句)
                调试输出 (局部_SQL语句)

                // 324212321324
                // 2

            }



        }
        返回 (0)
    }
}

类 类_供应商信息 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"645, 459\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"365, 391, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"181, 391, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_进货折扣 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"124, 120, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"21, 12, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "供应商名称">
    变量 编辑框_联系人 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"124, 66, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"21, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "联系人">
    变量 编辑框_电话 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"437, 66, 192, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"333, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "电话">
    变量 编辑框_备注 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"124, 231, 505, 104\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"333, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "信誉等级">
    变量 组合框_信誉等级 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"437, 120, 120, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 列表项目 = "1\n0\n2\n0\n3\n0\n4\n0\n5\n0" "类型" = 不可编辑下拉式>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"21, 174, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合同起始">
    变量 日期框_合同起始 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"124, 174, 184, 32\"">
    变量 标签6 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"333, 174, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合同终止">
    变量 日期框_合同终止 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"445, 174, 184, 32\"">
    变量 选择框_是否合作 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"124, 351, 112, 32\"" 标题 = "是否合作"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_供应商名称 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"124, 12, 505, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"21, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "进货折扣">
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 119\r\npos = \"21, 231, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "备注">

    #

    方法 类_供应商信息_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_供应商信息 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果真 (类_供应商管理.成员_当前状态 == "修改")
        {
            编辑框_供应商名称.标记 = 到文本 (取程序 ().窗口_供应商管理.超级列表框_显示.取表项数值 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项))
            编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            编辑框_联系人.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 1)
            编辑框_电话.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 2)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)



        }


        返回 (0)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_保存)
        {

            如果 (类_供应商管理.成员_当前状态 == "修改")
            {

                变量 局部_SQL语句 <类型 = 文本型>
                变量 局部_记录集 <类型 = 记录集类>
                局部_SQL语句 = "update  [供应商] set [供应商名称]='" + 编辑框_供应商名称.内容 + "',[联系人]='" + 编辑框_联系人.内容 + "' where ID=" + 编辑框_供应商名称.标记

                调试输出 (局部_SQL语句)

                局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
                // 局部_记录集.取错误 ()
                调试输出 (局部_记录集.状态)
                // 数据库状态类型.




            }
            否则 (类_供应商管理.成员_当前状态 == "添加")
            {

                变量 局部_SQL语句 <类型 = 文本型>
                变量 局部_记录集 <类型 = 记录集类>
                局部_SQL语句 = "insert into [供应商] ([供应商名称],[联系人],[电话],[进货折扣],[信誉等级],[合同起始],[合同终止],[是否合作],[备注]) values ( '" + 编辑框_供应商名称.内容 + "','" + 编辑框_联系人.内容 + "','" + 编辑框_电话.内容 + "'," + 到文本 (文本到小数 (编辑框_进货折扣.内容)) + "," + 组合框_信誉等级.取项目文本 (组合框_信誉等级.现行选中项) + ",'" + 时间到文本 (日期框_合同起始.今天, 时间转换部分.日期部分, ) + "','" + 时间到文本 (日期框_合同终止.今天, 时间转换部分.日期部分, ) + "'," + 选择 (选择框_是否合作.选中, "true", "false") + ",'" + 编辑框_备注.内容 + "')"
                //到时间 (, )

                调试输出 (局部_SQL语句)

                局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
                // 局部_记录集.取错误 ()
                调试输出 (局部_记录集.状态)
                // 数据库状态类型.

            }






        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 窗口_商品管理 <公开 类型 = 类_商品管理>
    变量 数据库_全局ACCESS库 <公开 类型 = 数据库类>

    方法 启动方法 <公开 类型 = 整数>
    {
        窗口_商品管理.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"500, 300\"" 标题 = "我的主窗口">

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_商品管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 底色 = 0xFFFFFF 窗口边框 = 无边框
        可否移动 = 真 随意移动 = 真>
{
    方法 方法_统计商品信息
    {
        变量 局部_记录集 <类型 = 记录集类>
        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [商品信息]", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [商品信息] where datediff('d',[添加时间],now())<=30", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回  // day
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [商品信息] where datediff('d',[添加时间],now())<=60", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回  // day
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()

        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [商品信息] where datediff('m',[添加时间],now())<=6", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回  // day
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_紫色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


    }

    变量 树形框_商品类别 <类型 = 树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 175, 315, 576\""
            字体 = ", 14, 0, 0, 0, 0, 0"
            项目 = "商品类别\n2\n2\n0\n0\n1\n2\n1\n饮料类\n2\n2\n2\n0\n1\n2\n2\n果蔬饮料\n1\n1\n0\n0\n0\n1\n3\n碳酸饮料\n1\n1\n0\n0\n0\n1\n3\n功能饮料\n1\n1\n0\n0\n0\n1\n3\n茶饮料\n1\n1\n0\n0\n0\n1\n3\n啤酒类\n2\n2\n0\n0\n1\n2\n2\n国产啤酒\n1\n1\n0\n0\n0\n1\n3\n进口啤酒\n1\n1\n0\n0\n0\n1\n3\n白酒类\n1\n1\n0\n0\n0\n1\n2"
            显示根部线 = 真 显示连线 = 真 显示加减框 = 真 是否有检查框 = 假 图片组 = "..\..\相关素材\\col_icons.png">
    变量 超级按钮_增 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 131, 40, 32\"" 标题 = "增"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"101, 131, 40, 32\"" 标题 = "改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"57, 131, 40, 32\"" 标题 = "删"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 ""
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"10, 13, 210, 50\"" 标题 = "商品总数"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"273, 13, 210, 50\"" 标题 = "30天内新增"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"536, 13, 210, 50\"" 标题 = "60天内新增"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"799, 13, 210, 50\"" 标题 = "半年新增"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_显示 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"341, 175, 674, 576\""
            "类型" = 报表列表框
            报表列 = "0\n-1\n0\n200\n商品名称\n0\n-1\n0\n100\n供应商\n0\n-1\n0\n100\n规格型号\n0\n-1\n0\n80\n入库价\n0\n-1\n0\n80\n零售价\n0\n-1\n0\n100\n备注"
            整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"461, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_打印 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"917, 131, 96, 32\"" 标题 = "打印"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"803, 131, 96, 32\"" 标题 = "删除"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_修改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"689, 131, 96, 32\"" 标题 = "修改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"575, 131, 96, 32\"" 标题 = "添加"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 119\r\npos = \"157, 131, 167, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 120\r\npos = \"333, 131, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 ""
    变量 成员_当前状态 <公开 静态 类型 = 文本型>
    变量 成员_商品类别 <公开 静态 类型 = 文本型>
    变量 成员_商品类别ID <公开 静态 类型 = 文本型>
    变量 窗口_商品信息 <公开 类型 = 类_商品信息>

    方法 类_商品管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_商品管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // "商品类别\n2\n2\n0\n0\n1\n2\n1\n饮料类\n2\n2\n2\n0\n1\n2\n2\n果蔬饮料\n1\n1\n0\n0\n0\n1\n3\n碳酸饮料\n1\n1\n0\n0\n0\n1\n3\n功能饮料\n1\n1\n0\n0\n0\n1\n3\n茶饮料\n1\n1\n0\n0\n0\n1\n3\n啤酒类\n2\n2\n0\n0\n1\n2\n2\n国产啤酒\n1\n1\n0\n0\n0\n1\n3\n进口啤酒\n1\n1\n0\n0\n0\n1\n3\n白酒类\n1\n1\n0\n0\n0\n1\n2"
        变量 局部_文本数组 <类型 = 文本数组类>
        取命令行 (局部_文本数组)
        如果真 (局部_文本数组.取成员数 () != 2)
        {
            信息框 ("非法调用，程序将退出！", 信息框按钮.错误图标, )
            结束 ()

        }
        如果真 (局部_文本数组.取成员 (0) != "$_$" || 局部_文本数组.取成员 (1) != "SHTEACH")
        {
            信息框 ("非法调用，程序将退出！", 信息框按钮.错误图标, )
            结束 ()
        }
        // 信息框 (到文本 (局部_文本数组.取成员数 ()), , )
        // 计次循环 (局部_文本数组.取成员数 ())
        {
            // 信息框 (局部_文本数组.取成员 (取循环索引 ()), , )


        }


        树形框_商品类别.项目 = ""
        方法_连接数据库 ()
        方法_显示类别 (树形框_商品类别, -1)
        方法_统计商品信息 ()

        返回 (0)

        变量 局部_索引 <类型 = 整数>
        变量 局部_索引1 <类型 = 整数>
        局部_索引 = 树形框_商品类别.加入项目 (, "商品类别", 2, 2, , , )
        局部_索引1 = 树形框_商品类别.加入项目 (局部_索引, "饮料类", 2, 2, , , )
        树形框_商品类别.加入项目 (局部_索引1, "果蔬饮料", 1, 1, , , )
        树形框_商品类别.加入项目 (局部_索引1, "碳酸饮料", 1, 1, , , )
        树形框_商品类别.加入项目 (局部_索引1, "功能饮料", 1, 1, , , )
        树形框_商品类别.加入项目 (局部_索引1, "茶饮料", 1, 1, , , )
        树形框_商品类别.扩展 (局部_索引)
        树形框_商品类别.扩展 (局部_索引1)
        局部_索引1 = 树形框_商品类别.加入项目 (局部_索引, "啤酒类", 2, 2, , , )
        树形框_商品类别.加入项目 (局部_索引1, "国产啤酒", 1, 1, , , )
        树形框_商品类别.加入项目 (局部_索引1, "进口啤酒", 1, 1, , , )
        树形框_商品类别.扩展 (局部_索引1)

        树形框_商品类别.加入项目 (局部_索引, "白酒类", 2, 2, , , )



        返回 (0)
    }

    方法 方法_显示商品列表
    参数 参数_分类ID <类型 = 文本型>
    {
        变量 局部_记录集 <类型 = 记录集类>
        变量 局部_位置 <类型 = 整数>
        调试输出 ("select * from [商品信息] where [商品类别ID]=" + 参数_分类ID)

        如果真 (局部_记录集.从已有连接打开 ("select * from [商品信息] where [商品类别ID]=" + 参数_分类ID, 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败0", , )
            返回

        }
        局部_记录集.到首记录 ()
        超级列表框_显示.全部删除 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            局部_位置 = 超级列表框_显示.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_显示.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("商品名称"))
            超级列表框_显示.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("供应商名称"))
            超级列表框_显示.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("规格型号"))
            超级列表框_显示.置标题 (局部_位置, 3, 到文本 (局部_记录集.读小数数据 ("入库价")))
            超级列表框_显示.置标题 (局部_位置, 5, 局部_记录集.读文本数据 ("备注"))
            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()
    }

    方法 方法_显示类别
    参数 参数_树型框 <类型 = 树形框>
    参数 参数_当前选中项 <类型 = 整数>
    {
        变量 局部_索引 <类型 = 整数>

        变量 局部_记录集 <类型 = 记录集类>
        变量 局部_语句 <类型 = 文本型>
        如果真 (参数_当前选中项 != -1)
        {
            判断循环 (树形框_商品类别.取父项目 (参数_当前选中项 + 1) == 参数_当前选中项)
            {
                树形框_商品类别.删除项目 (参数_当前选中项 + 1)
            }

        }
        如果 (参数_当前选中项 == -1)
        {
            局部_语句 = "select *  from [商品类别] where [上级ID]=-1"
        }
        否则
        {
            局部_语句 = "select *  from [商品类别] where [上级ID]=" + 到文本 (参数_树型框.取项目数值 (参数_当前选中项))

        }
        调试输出 (局部_语句)

        如果真 (局部_记录集.从已有连接打开 (局部_语句, 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {

            信息框 ("查询失败1", , )

            返回
        }
        局部_记录集.到首记录 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("类别名称"), 2, 2, 局部_记录集.读整数数据 ("ID"), , )
            变量 局部_记录集1 <类型 = 记录集类>
            如果真 (局部_记录集1.从已有连接打开 ("select count(ID) as [总数] from [商品类别] where [上级ID]=" + 到文本 (局部_记录集.读整数数据 ("ID")), 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
            {
                信息框 ("查询失败2", , )
                返回  // day
            }
            局部_记录集1.到首记录 ()
            如果真 (局部_记录集1.记录数量 == 1)
            {
                如果真 (局部_记录集1.读整数数据 ("总数") > 0)
                {
                    参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                }
                局部_记录集1.关闭 ()
            }

            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()




    }

    方法 方法_连接数据库 <类型 = 逻辑型>
    {
        如果真 (取程序 ().数据库_全局ACCESS库.当前状态 == 数据库状态类型.关闭)
        {
            调试输出 (取当前目录 () + "\\..\\数据目录\\简易进销存.accdb")
            如果真 (取程序 ().数据库_全局ACCESS库.连接Access (取当前目录 () + "\\..\\数据目录\\简易进销存.accdb", , 真) == 假)
            {
                信息框 ("数据库连接失败", , )
                销毁 ()
                返回 (假)

            }

        }
        返回 (真)

    }

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // 树形框_商品类别.项目 = "商品类别\n2\n2\n0\n0\n1\n2\n1\n饮料类\n2\n2\n2\n0\n1\n2\n2\n果蔬饮料\n1\n1\n0\n0\n0\n1\n3\n碳酸饮料\n1\n1\n0\n0\n0\n1\n3\n功能饮料\n1\n1\n0\n0\n0\n1\n3\n茶饮料\n1\n1\n0\n0\n0\n1\n3\n啤酒类\n2\n2\n0\n0\n1\n2\n2\n国产啤酒\n1\n1\n0\n0\n0\n1\n3\n进口啤酒\n1\n1\n0\n0\n0\n1\n3\n白酒类\n1\n1\n0\n0\n0\n1\n2"
        返回 (0)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_添加)
        {
            如果真 (树形框_商品类别.现行选中项 == -1)
            {
                信息框 ("必须选择一个项目才可以在它的下面添加商品！", 信息框按钮.错误图标, )
                返回 (0)
            }

            成员_当前状态 = "添加"
            类_商品管理.成员_商品类别 = 树形框_商品类别.取项目文本 (树形框_商品类别.现行选中项)
            类_商品管理.成员_商品类别ID = 到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项))


            窗口_商品信息.创建窗口 (, , , , )

        }
        如果 (来源对象 == 超级按钮_修改)
        {
            如果真 (超级列表框_显示.现行选中项 == -1)
            {
                信息框 ("必须选择一个商品才可以修改！", 信息框按钮.错误图标, )
                返回 (0)
            }
            成员_当前状态 = "修改"
            窗口_商品信息.创建窗口 (, , , , )


        }
        否则 (来源对象 == 超级按钮_添加)
        {



        }
        否则 (来源对象 == 超级按钮_改)
        {
            // 局部_SQL语句 = "update  [供应商] set [供应商名称]='" + 编辑框_供应商名称.内容 + "',[联系人]='" + 编辑框_联系人.内容 + "' where ID=" + 编辑框_供应商名称.标记
            如果真 (树形框_商品类别.现行选中项 == -1)
            {
                信息框 ("必须选择一个项目才可以在它的下面添加子类别！", 信息框按钮.错误图标, )
                返回 (0)
            }
            变量 局部_文本 <类型 = 文本型>
            如果真 (输入框 (局部_文本, "请输入类别名称", "类别名称", 树形框_商品类别.取项目文本 (树形框_商品类别.现行选中项), ) == 假)
            {
                返回 (0)

            }
            调试输出 (局部_文本)
            变量 局部_SQL语句 <类型 = 文本型>
            变量 "// 局部_记录集" <类型 = 记录集类>
            变量 局部_影响行数 <类型 = 长整数类>
            局部_SQL语句 = "update  [商品类别] set [类别名称] ='" + 局部_文本 + "' where ID=" + 到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项))
            调试输出 (局部_SQL语句)

            取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , 局部_影响行数)
            调试输出 (局部_影响行数)
            树形框_商品类别.置项目文本 (树形框_商品类别.现行选中项, 局部_文本)



        }
        否则 (来源对象 == 超级按钮_删)
        {
            如果真 (树形框_商品类别.现行选中项 == -1)
            {
                信息框 ("必须选择一个项目才可以在它的下面添加子类别！", 信息框按钮.错误图标, )
                返回 (0)
            }
            如果真 (信息框 ("是否要删除选中的供应商，删除后无法恢复！", 信息框按钮.询问图标 + 信息框按钮.是否钮, ) == 返回按钮类型.否钮)
            {
                返回 (0)


            }
            变量 局部_记录集1 <类型 = 记录集类>
            如果真 (局部_记录集1.从已有连接打开 ("select count(ID) as [总数] from [商品类别] where [上级ID]=" + 到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项)), 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)  // day
                局部_记录集1.到首记录 ()
            }
            如果真 (局部_记录集1.记录数量 == 1)
            {
                如果 (局部_记录集1.读整数数据 ("总数") > 0)
                {
                    信息框 ("本类别下存在子类别，请先删除所有子类别，再删除本类别！", , )
                    局部_记录集1.关闭 ()
                    返回 (0)
                }
                否则
                {
                    局部_记录集1.关闭 ()

                }

            }




            变量 ""
            变量 ""
            变量 局部_SQL语句 <类型 = 文本型>
            变量 "// 局部_记录集" <类型 = 记录集类>
            局部_SQL语句 = "delete from [商品类别] where ID= " + 到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项))

            // 调试输出 (局部_SQL语句)

            取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
            树形框_商品类别.删除项目 (树形框_商品类别.现行选中项)

            // // 局部_记录集.取错误 ()
            // // 调试输出 (局部_记录集.状态)
            // // 数据库状态类型.
            // 超级列表框_显示.删除表项 (超级列表框_显示.现行选中项)



        }
        否则 (来源对象 == 超级按钮_增)
        {

            如果真 (树形框_商品类别.现行选中项 == -1)
            {
                信息框 ("必须选择一个项目才可以在它的下面添加子类别！", 信息框按钮.错误图标, )
                返回 (0)
            }

            变量 局部_文本 <类型 = 文本型>
            如果真 (输入框 (局部_文本, "请输入类别名称", "类别名称", , ) == 假)
            {
                返回 (0)

            }
            调试输出 (局部_文本)


            变量 局部_SQL语句 <类型 = 文本型>
            变量 "// 局部_记录集" <类型 = 记录集类>
            变量 局部_影响行数 <类型 = 长整数类>
            局部_SQL语句 = "insert into [商品类别] ([上级ID],[类别名称]) values ( " + 到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项)) + ",'" + 局部_文本 + "')"
            调试输出 (局部_SQL语句)

            取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , 局部_影响行数)
            调试输出 (局部_影响行数)

            // // 局部_记录集.取错误 ()
            // 调试输出 (局部_记录集.状态)



        }
        返回 (0)
    }

    方法 树形框_即将扩展 <接收事件 类型 = 整数 注释 = "当某项目即将被展开以显示出下属子项目时产生本事件,返回1中止展开,返回0则允许.">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 项目索引 <类型 = 整数 注释 = "提供即将扩展显示下属子项目的项目索引,从0开始.">
    {
        如果 (来源对象 == 树形框_商品类别)
        {
            如果真 (树形框_商品类别.现行选中项 == -1)
            {
                返回 (0)

            }
            方法_显示类别 (树形框_商品类别, 项目索引)


        }
        返回 (0)
    }

    方法 树形框_项目被选择 <接收事件 类型 = 整数 注释 = "当前选择项目被改变时产生此事件">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 选择方式 <类型 = 整数 注释 = "提供是如何操作导致当前选择项目被改变的:  0:键盘; 1:鼠标;  2:其它">
    {
        如果 (来源对象 == 树形框_商品类别)
        {
            如果真 (选择方式 == 2)
            {
                返回 (0)
            }
            方法_显示商品列表 (到文本 (树形框_商品类别.取项目数值 (树形框_商品类别.现行选中项)))


        }
        返回 (0)
    }
}

类 类_商品信息 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"645, 381\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"365, 311, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"181, 311, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_入库价 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"124, 120, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"21, 12, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "商品名称">
    变量 编辑框_品牌 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"124, 66, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"21, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "品牌">
    变量 编辑框_规格型号 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"437, 66, 192, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"333, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "规格型号">
    变量 编辑框_备注 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"124, 179, 505, 104\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 是否允许多行 = 真>
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"333, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "供应商">
    变量 组合框_供应商 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"437, 120, 192, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" "类型" = 不可编辑下拉式>
    变量 编辑框_商品名称 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"124, 12, 505, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"21, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "入库价">
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"21, 179, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "备注">

    #

    方法 类_商品信息_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_商品信息 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        方法_读取供应商 (组合框_供应商)

        如果真 (类_商品管理.成员_当前状态 == "修改")
        {
            编辑框_商品名称.标记 = 到文本 (取程序 ().窗口_商品管理.超级列表框_显示.取表项数值 (取程序 ().窗口_商品管理.超级列表框_显示.现行选中项))
            编辑框_商品名称.内容 = 取程序 ().窗口_商品管理.超级列表框_显示.取标题 (取程序 ().窗口_商品管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_品牌.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 1)
            // 编辑框_电话.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 2)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 组合框_供应商.
            // 组合框_供应商.内容 =
            组合框_供应商.选择 (取程序 ().窗口_商品管理.超级列表框_显示.取标题 (取程序 ().窗口_商品管理.超级列表框_显示.现行选中项, 1))



        }


        返回 (0)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {



        如果 (来源对象 == 超级按钮_保存)
        {

            如果 (类_商品管理.成员_当前状态 == "修改")
            {

                变量 局部_SQL语句 <类型 = 文本型>
                变量 局部_记录集 <类型 = 记录集类>
                局部_SQL语句 = "update  [商品信息] set [商品名称]='" + 编辑框_商品名称.内容 + "',[供应商名称]='" + 组合框_供应商.取项目文本 (组合框_供应商.现行选中项) + "',[供应商ID]=" + 到文本 (组合框_供应商.取项目数值 (组合框_供应商.现行选中项)) + " where ID=" + 编辑框_商品名称.标记

                调试输出 (局部_SQL语句)

                局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
                // 局部_记录集.取错误 ()
                调试输出 (局部_记录集.状态)
                // 数据库状态类型.




            }
            否则 (类_商品管理.成员_当前状态 == "添加")
            {
                变量 局部_SQL语句 <类型 = 文本型>
                变量 局部_记录集 <类型 = 记录集类>
                局部_SQL语句 = "insert into [商品信息] ([商品名称],[品牌],[供应商名称],[供应商ID],[商品类别],[商品类别ID],[入库价],[备注]) values ( '" + 编辑框_商品名称.内容 + "','" + 编辑框_品牌.内容 + "','" + 组合框_供应商.取项目文本 (组合框_供应商.现行选中项) + "'," + 到文本 (组合框_供应商.取项目数值 (组合框_供应商.现行选中项)) + ",'" + 类_商品管理.成员_商品类别 + "'," + 类_商品管理.成员_商品类别ID + "," + 到文本 (文本到小数 (编辑框_入库价.内容)) + ",'" + 编辑框_备注.内容 + "')"

                调试输出 (局部_SQL语句)

                局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
                // 局部_记录集.取错误 ()
                调试输出 (局部_记录集.状态)
                // 数据库状态类型.

            }





        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }

    方法 方法_读取供应商
    参数 参数_组合框 <类型 = 组合框>
    {
        变量 局部_记录集 <类型 = 记录集类>
        如果真 (局部_记录集.从已有连接打开 ("select * from [供应商]", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回

        }
        局部_记录集.到首记录 ()
        参数_组合框.清空 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            参数_组合框.加入项目 (局部_记录集.读文本数据 ("供应商名称"), 局部_记录集.读整数数据 ("ID"))
            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()

    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.世恒.视窗21天

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>
    变量 窗口_在线更新 <公开 类型 = 类_在线更新>
    变量 窗口_生成在线更新配置 <类型 = 类_生成在线更新配置>

    方法 启动方法 <公开 类型 = 整数>
    {
        // 窗口_生成在线更新配置.创建主窗口 ()
        窗口_在线更新.创建主窗口 ()
        // 主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"953, 595\"" 标题 = "我的主窗口">
{
    变量 画板_新图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"517, 7, 431, 150\"" 组件边框 = 单线边框式
            自动重画 = 真>
    变量 画板_原图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"5, 7, 431, 150\"" 组件边框 = 单线边框式
            底图 = "先学后付.png">
    变量 按钮_传统 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"445, 47, 64, 72\"" 标题 = "传统取点画点">
    变量 画板_多线程新图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"5, 191, 431, 150\"" 组件边框 = 单线边框式
            自动重画 = 真>
    变量 画板_灰度图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"517, 191, 431, 150\"" 组件边框 = 单线边框式
            自动重画 = 真>
    变量 画板_状态线程新图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"5, 367, 431, 150\"" 组件边框 = 单线边框式
            自动重画 = 真>
    变量 画板_增强灰度新图 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"517, 367, 431, 150\"" 组件边框 = 单线边框式
            自动重画 = 真>
    变量 按钮_多线程 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"445, 231, 64, 72\"" 标题 = "多线程取点画点">
    变量 按钮_状态线程 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"445, 399, 64, 72\"" 标题 = "状态线程取点画点">
    变量 画板_临时新图 <静态 类型 = 画板>
    变量 画板_临时原图 <静态 类型 = 画板>
    变量 画板_临时灰度图 <静态 类型 = 画板>
    变量 画板_临时状态图 <静态 类型 = 画板>

    方法 方法_取图画图 <静态 类型 = 整数>
    参数 参数_用户参数 <类型 = 变整数>
    {
        变量 局部_计次 <类型 = 整数>
        画板_临时新图.清除 (, , , )
        计次循环 (画板_临时原图.高度)
        {
            循环 (1, 画板_临时原图.宽度 + 1, 局部_计次)
            {
                // 取颜色值 (255, 0, 255)
                画板_临时新图.画点 (局部_计次, 取循环索引 () + 1, 画板_临时原图.取点 (局部_计次, 取循环索引 () + 1))

            }
        }

        返回 (0)
    }

    方法 方法_取图分段画图 <静态 类型 = 整数>
    参数 参数_用户参数 <类型 = 变整数>
    {
        变量 局部_计次 <类型 = 整数>
        画板_临时灰度图.清除 (, , , )
        计次循环 (15)
        {
            循环 (1, 画板_临时原图.宽度 + 1, 局部_计次)
            {
                // 取颜色值 (255, 0, 255)
                画板_临时灰度图.画点 (局部_计次, (整数)参数_用户参数 * 15 + 取循环索引 () + 1, 画板_临时原图.取点 (局部_计次, (整数)参数_用户参数 * 15 + 取循环索引 () + 1))



            }
        }

        返回 (0)
    }

    方法 方法_取图分段画灰度图 <静态 类型 = 整数>
    参数 参数_用户参数 <类型 = 变整数>
    {
        变量 局部_计次 <类型 = 整数>
        变量 局部_颜色 <类型 = 整数>
        变量 局部_R_红色素 <类型 = 整数>
        变量 局部_G_绿色素 <类型 = 整数>
        变量 局部_B_蓝色素 <类型 = 整数>
        变量 局部_颜色和值 <类型 = 整数>
        画板_临时灰度图.清除 (, , , )
        计次循环 (15)
        {
            循环 (1, 画板_临时原图.宽度 + 1, 局部_计次)
            {
                // 取颜色值 (255, 0, 255)
                局部_颜色 = 画板_临时原图.取点 (局部_计次, (整数)参数_用户参数 * 15 + 取循环索引 () + 1)
                局部_R_红色素 = 无符号字节到整数 (取字节集数据 (取字节集左边 (到字节集 (局部_颜色), 1), , 字节))
                局部_G_绿色素 = 无符号字节到整数 (取字节集数据 (取字节集中间 (到字节集 (局部_颜色), 1, 1), , 字节))
                局部_B_蓝色素 = 无符号字节到整数 (取字节集数据 (取字节集中间 (到字节集 (局部_颜色), 2, 1), , 字节))
                // 局部_颜色和值 = (整数)((局部_R_红色素 + 局部_G_绿色素 + 局部_B_蓝色素) / 3.0)
                局部_颜色和值 = (整数)(局部_R_红色素 * 0.299) + (整数)(局部_G_绿色素 * 0.587) + (整数)(局部_B_蓝色素 * 0.114)

                画板_临时灰度图.画点 (局部_计次, (整数)参数_用户参数 * 15 + 取循环索引 () + 1, 取颜色值 (局部_颜色和值, 局部_颜色和值, 局部_颜色和值))



            }
        }

        返回 (0)
    }

    方法 方法_取图分段画二分状态图 <静态>
    参数 参数_线程状态数据 <类型 = 线程状态类>
    {
        变量 局部_计次 <类型 = 整数>
        变量 局部_颜色 <类型 = 整数>
        变量 局部_R_红色素 <类型 = 整数>
        变量 局部_G_绿色素 <类型 = 整数>
        变量 局部_B_蓝色素 <类型 = 整数>
        变量 局部_颜色和值 <类型 = 整数>
        画板_临时状态图.清除 (, , , )
        变量 局部_位置值 <类型 = 整数>
        局部_位置值 = (整数)参数_线程状态数据.取用户值 ()

        计次循环 (15)
        {
            循环 (1, 画板_临时原图.宽度 + 1, 局部_计次)
            {
                // 取颜色值 (255, 0, 255)
                局部_颜色 = 画板_临时原图.取点 (局部_计次, (整数)局部_位置值 * 15 + 取循环索引 () + 1)
                局部_R_红色素 = 无符号字节到整数 (取字节集数据 (取字节集左边 (到字节集 (局部_颜色), 1), , 字节))
                局部_G_绿色素 = 无符号字节到整数 (取字节集数据 (取字节集中间 (到字节集 (局部_颜色), 1, 1), , 字节))
                局部_B_蓝色素 = 无符号字节到整数 (取字节集数据 (取字节集中间 (到字节集 (局部_颜色), 2, 1), , 字节))
                // 局部_颜色和值 = (整数)((局部_R_红色素 + 局部_G_绿色素 + 局部_B_蓝色素) / 3.0)
                局部_颜色和值 = (整数)(局部_R_红色素 * 0.299) + (整数)(局部_G_绿色素 * 0.587) + (整数)(局部_B_蓝色素 * 0.114)
                如果 (局部_颜色和值 >= 128)
                {
                    局部_颜色和值 = 255
                }
                否则
                {
                    局部_颜色和值 = 0
                }
                画板_临时状态图.画点 (局部_计次, (整数)局部_位置值 * 15 + 取循环索引 () + 1, 取颜色值 (局部_颜色和值, 局部_颜色和值, 局部_颜色和值))



            }
        }

    }

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {

        变量 局部_计次 <类型 = 整数>
        如果 (来源对象 == 按钮_状态线程)
        {
            画板_临时状态图 = 画板_状态线程新图
            画板_临时新图 = 画板_多线程新图
            画板_临时原图 = 画板_原图
            画板_临时灰度图 = 画板_灰度图
            变量 局部_增强位图 <类型 = 增强位图类>
            变量 局部_位图对象 <类型 = 位图对象类>
            变量 局部_图片数据 <类型 = 字节集类>
            变量 局部_结果位图 <类型 = 增强位图类>
            画板_原图.取图片 (局部_位图对象, , )
            局部_位图对象.取图片数据 (局部_图片数据, , )
            局部_增强位图.从字节集创建 (局部_图片数据)
            局部_增强位图.灰度 (局部_结果位图)
            局部_结果位图.到字节集 (局部_图片数据)
            画板_增强灰度新图.置底图数据 (局部_图片数据)

            // 画板_增强灰度新图.
            启动线程 (方法_取图画图, , , , )

            计次循环 (10)
            {
                启动线程 (方法_取图分段画灰度图, 取循环索引 (), , , )
            }

            计次循环 (10)
            {
                变量 局部_线程状态 <类型 = 线程状态类>
                // 局部_线程状态.置用户对象1 ()
                局部_线程状态.置用户值 (取循环索引 ())
                启动有状态线程 (局部_线程状态, 方法_取图分段画二分状态图, , )


            }





        }
        否则 (来源对象 == 按钮_多线程)
        {
            画板_临时新图 = 画板_多线程新图
            画板_临时原图 = 画板_原图
            画板_临时灰度图 = 画板_灰度图
            启动线程 (方法_取图画图, , , , )
            计次循环 (10)
            {
                启动线程 (方法_取图分段画灰度图, 取循环索引 (), , , )

            }


        }
        否则 (来源对象 == 按钮_传统)
        {
            画板_新图.清除 (, , , )
            计次循环 (画板_原图.高度)
            {
                循环 (1, 画板_原图.宽度 + 1, 局部_计次)
                {
                    // 取颜色值 (255, 0, 255)
                    画板_新图.画点 (局部_计次, 取循环索引 () + 1, 画板_原图.取点 (局部_计次, 取循环索引 () + 1))

                }
                处理事件 ()

            }

        }
        变量 ""
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.世恒.视窗21天

类 类_在线更新 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1007, 665\"" 底色 = 0xA78227>
{
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"47, 19, 328, 80\"" 标题 = "简 易 进 销 存"
            字体 = "方正小标宋简体, 40, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边 文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227>
    变量 超级按钮_退出 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"855, 63, 142, 50\"" 按钮风格 = 平面风格
            按钮类型 = 通常 使用默认色 = 假 标题 = "退  出" 通常图片 = "..\\..\\相关素材\\背景\\taobao_xp_cm_button_download_click.9.png"
            对齐方式 = 图文混排 字体 = "微软雅黑, 20, 0, 0, 0, 0, 0" 通常前景色 = 0xFFFFFF 点燃前景色 = 0xFFFFFF 焦点前景色 = 0xFFFFFF
            点燃图片 = "..\\..\\相关素材\\背景\\taobao_xp_cm_button_download.9.png" 可视 = 真>
    变量 超级按钮_更新 <类型 = 超级按钮 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"685, 63, 142, 50\"" 按钮风格 = 平面风格
            按钮类型 = 通常 使用默认色 = 假 标题 = "更新" 通常图片 = "..\\..\\相关素材\\背景\\taobao_xp_cm_button_download_click.9.png"
            对齐方式 = 图文混排 字体 = "微软雅黑, 20, 0, 0, 0, 0, 0" 通常前景色 = 0xFFFFFF 点燃前景色 = 0xFFFFFF 焦点前景色 = 0xFFFFFF
            点燃图片 = "..\\..\\相关素材\\背景\\taobao_xp_cm_button_download.9.png" 可视 = 真>
    变量 成员_登录次数 <类型 = 整数>
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"383, 19, 214, 80\"" 标题 = "在线更新系统"
            字体 = "方正小标宋简体, 20, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边 文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227>
    变量 标签3 <类型 = 标签 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"285, 575, 437, 64\""
            标题 = "火山视窗开发  世恒教育出品\r\nwww.shteach.com" 字体 = "方正小标宋简体, 26, 1, 0, 0, 0, 0" 横向对齐方式 = 居中 纵向对齐方式 = 底边
            文本颜色 = 0xFFFFFF 背景颜色 = 0xA78227 是否自动折行 = 真>
    变量 超级列表框_文件列表 <类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"13, 119, 984, 432\""
            "类型" = 报表列表框 显示表格线 = 真 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0"
            报表列 = "0\n-1\n0\n200\n文件名\n0\n-1\n0\n300\n本地路径\n0\n-1\n0\n120\n文件大小\n0\n-1\n0\n120\n下载进度\n0\n-1\n0\n120\n更新状态\n0\n-1\n0\n10\n下载地址\n0\n-1\n0\n10\nMD5"
            单一选择 = 真 整行选择 = 真>
    变量 成员_用户名 <类型 = 文本型 值 = "超级管理员">
    变量 成员_密码 <类型 = 文本型 注释 = "这里记录的密码不是" 注释 = "明文密码而是MD5并且" 注释 = "取出第9开始的16位字符">
    变量 成员_权限 <类型 = 文本型>
    变量 超级列表框_虚构 <公开 静态 类型 = 超级列表框>
    变量 成员_网络传输对象数组 <公开 静态 类型 = 对象数组类>

    方法 类_在线更新_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_在线更新 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // {"文件数":3,"版本名称":"V1.1","版本号":"1.1","根部网址":"http://zwbcwang.h902.000pc.net/","更新时间":"2022-07-29 23:11:29","更新内容":"1、主程序界面修改；\r\n2、数据库结构调整；\r\n3、主要是测试在线升级。","文件列表":[{"原始文件名":"简易进销存.exe","本地路径":"简易进销存.exe","保存文件名":"upload/202207292236447545.rar","文件大小":"8034K","MD5":"c4ca4238a0b923820dcc509a6f75849b"},{"原始文件名":"权限管理.dll","本地路径":"插件目录\\权限管理.dll","保存文件名":"upload/20220729223324333.rar","文件大小":"3432K","MD5":"56ca4238a0b92382sscc509a6f7585gh"},{"原始文件名":"进货管理.dll","本地路径":"插件目录\\进货管理.dll","保存文件名":"upload/20220729223378905.rar","文件大小":"6422K","MD5":"67ka4238a0b92382sscc509a6f7545ho"}]}
        超级列表框_虚构 = 超级列表框_文件列表
        变量 局部_JSON文本 <类型 = 文本型
                值 = "{\"文件数\":3,\"版本名称\":\"V1.1\",\"版本号\":\"1.1\",\"根部网址\":\"http://zwbcwang.h902.000pc.net/\",\"更新时间\":\"2022-07-29 23:11:29\",\"更新内容\":\"1、主程序界面修改；\\r\\n2、数据库结构调整；\\r\\n3、主要是测试在线升级。\",\"文件列表\":[{\"原始文件名\":\"简易进销存.exe\",\"本地路径\":\"简易进销存.exe\",\"保存文件名\":\"upload/202207292236447545.rar\",\"文件大小\":\"8034K\",\"MD5\":\"c4ca4238a0b923820dcc509a6f75849b\"},{\"原始文件名\":\"权限管理.dll\",\"本地路径\":\"插件目录\\\\权限管理.dll\",\"保存文件名\":\"upload/20220729223324333.rar\",\"文件大小\":\"3432K\",\"MD5\":\"56ca4238a0b92382sscc509a6f7585gh\"},{\"原始文件名\":\"进货管理.dll\",\"本地路径\":\"插件目录\\\\进货管理.dll\",\"保存文件名\":\"upload/20220729223378905.rar\",\"文件大小\":\"6422K\",\"MD5\":\"67ka4238a0b92382sscc509a6f7545ho\"}]}">
        变量 局部_网络访问 <类型 = 网络访问类>
        变量 局部_响应 <类型 = 网页访问响应类>
        变量 局部_解密后字节集 <类型 = 字节集类>
        局部_响应 = 局部_网络访问.网页访问 ("http://zwbcwang.h902.000pc.net/update/update.json", , , , , , , , , , , )
        局部_解密后字节集 = 加解密类.解密_RC4 (局部_响应.请求结果, "12345abc67890def")
        局部_JSON文本 = UTF8到文本 (局部_解密后字节集)
        调试输出 (局部_JSON文本)

        // http://zwbcwang.h902.000pc.net/update/update.json

        方法_解析显示升级数据 (超级列表框_文件列表, 局部_JSON文本)

        返回 (0)
    }

    方法 方法_解析显示升级数据
    参数 参数_超级列表框 <类型 = 超级列表框>
    参数 参数_JSON数据 <类型 = 文本型>
    {
        变量 局部_JSON对象 <类型 = JSON对象类>
        变量 局部_JSON数组 <类型 = JSON数组类>
        变量 局部_JSON数组内对象 <类型 = JSON对象类>
        变量 局部_键名组 <类型 = 文本数组类>
        变量 局部_索引 <类型 = 整数>
        局部_JSON对象.创建自文本 (参数_JSON数据)
        调试输出 (局部_JSON对象.取文本值 ("版本号"))
        调试输出 (局部_JSON对象.取文本值 ("更新内容"))
        局部_JSON对象.取所有键名 (局部_键名组)
        调试输出 (局部_键名组)

        调试输出 (局部_JSON对象.取整数值 ("文件数"))
        计次循环 (局部_JSON对象.取整数值 ("文件数"))
        {
            调试输出 (局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].本地路径"))
            调试输出 (局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].MD5"))
            // 文件列表.[0].本地路径
            // 文件列表.[1].本地路径
            局部_索引 = 参数_超级列表框.插入表项 (, , , , , )
            参数_超级列表框.置标题 (局部_索引, 0, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].原始文件名"))
            参数_超级列表框.置标题 (局部_索引, 1, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].本地路径"))
            参数_超级列表框.置标题 (局部_索引, 2, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].文件大小"))
            参数_超级列表框.置标题 (局部_索引, 5, 局部_JSON对象.取文本值 ("根部网址") + 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].保存文件名"))
            参数_超级列表框.置标题 (局部_索引, 6, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].MD5"))

        }

        局部_JSON对象.取数组值 ("文件列表", 局部_JSON数组)
        调试输出 ("局部_JSON数组.成员数")
        调试输出 (局部_JSON数组.成员数)
        计次循环 (局部_JSON数组.成员数)
        {
            局部_JSON数组.取对象值 (取循环索引 (), 局部_JSON数组内对象)
            调试输出 (局部_JSON数组内对象.取文本值 ("本地路径"))
            局部_JSON数组内对象.取所有键名 (局部_键名组)
            调试输出 (局部_键名组)


        }





    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_更新)
        {
            创建目录 (取当前目录 () + "\\临时目录")
            计次循环 (超级列表框_文件列表.取表项数 ())
            {
                变量 局部_线程状态 <类型 = 线程状态类>
                变量 局部_位置 <类型 = 整数>
                局部_位置 = 成员_网络传输对象数组.加入新成员 (网络传输类, )
                调试输出 ("局部_位置")
                调试输出 (局部_位置)
                局部_线程状态.置用户值 (局部_位置)
                启动有状态线程 (局部_线程状态, 方法_网络传输下载, , )

            }

        }
        否则 (来源对象 == 超级按钮_退出)
        {
            删除目录 (取当前目录 () + "\\临时目录\\", 目录删除模式.全部删除, )

            销毁 ()

        }
        返回 (0)
    }

    方法 方法_网络传输下载 <静态>
    参数 参数_线程状态 <类型 = 线程状态类>
    {
        变量 局部_网络传输 <类型 = 网络传输类>
        变量 局部_位置 <类型 = 整数>
        局部_位置 = (整数)参数_线程状态.取用户值 ()
        局部_网络传输 = (网络传输类)成员_网络传输对象数组.取成员 (局部_位置)
        局部_网络传输.地址 = 超级列表框_虚构.取标题 (局部_位置, 5)
        // 调试输出 (局部_网络传输.地址)
        局部_网络传输.进度反馈 = 真
        局部_网络传输.置传输进度回调函数 (方法_进度反馈, 局部_位置)
        局部_网络传输.置请求方式 ("GET")

        变量 局部_结果 <类型 = 字节集类>
        变量 局部_响应头 <类型 = 文本数组类>
        局部_网络传输.发送请求 (局部_结果, 局部_响应头)
        // 创建目录 ()
        变量 局部_保存地址 <类型 = 文本型>
        局部_保存地址 = 取当前目录 () + "\\临时目录\\" + 超级列表框_虚构.取标题 (局部_位置, 1) + ".rar"
        创建目录 (取文本左边 (局部_保存地址, 倒找文本 (局部_保存地址, "\\", , )))
        写到文件 (局部_保存地址, 局部_结果, )
        调试输出 (取字节集长度 (局部_结果))
        调试输出 (局部_响应头)
        超级列表框_虚构.置标题 (局部_位置, 3, "下载完成")

        变量 局部_压缩文件 <类型 = RAR文件解压类>
        局部_压缩文件.打开文件 (局部_保存地址, )
        局部_压缩文件.解压所有文件 (取文本左边 (局部_保存地址, 倒找文本 (局部_保存地址, "\\", , )))

        超级列表框_虚构.置标题 (局部_位置, 4, "解压完成")
        如果 (复制文件 (取当前目录 () + "\\临时目录\\" + 超级列表框_虚构.取标题 (局部_位置, 1), 取当前目录 () + "\\" + 超级列表框_虚构.取标题 (局部_位置, 1), ))
        {
            超级列表框_虚构.置标题 (局部_位置, 4, "更新完成")
        }
        否则
        {
            超级列表框_虚构.置标题 (局部_位置, 4, "更新失败")

        }
        // 移动文件 (, )
        延时 (500)
        调试输出 ("删除文件 (局部_保存地址)")
        调试输出 (局部_保存地址)
        删除文件 (局部_保存地址)
        删除文件 (取当前目录 () + "\\临时目录\\" + 超级列表框_虚构.取标题 (局部_位置, 1))
        // 删除文件 (局部_保存地址)

    }

    方法 网络传输类_传输进度发生改变 <接收事件 类型 = 整数 注释 = "当传输进度发生改变时,本事件将被调用多次直到整个传输结束.">
    参数 来源对象 <类型 = 网络传输类 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 下载总量 <类型 = 长整数 注释 = "预计需要下载的字节数.">
    参数 当前下载 <类型 = 长整数 注释 = "当前已下载的字节数.">
    参数 上传总量 <类型 = 长整数 注释 = "预计需要上传的字节数.">
    参数 当前上传 <类型 = 长整数 注释 = "当前已上传的字节数.">
    {
        // 如果 (来源对象 == 局部_网络传输)
        {

        }
        返回 (0)
    }

    方法 方法_进度反馈 <静态 类型 = 整数 @视窗.前缀文本 = "@CDECL">
    参数 参数_用户数据 <类型 = 变整数 注释 = "设置回调函数所传入的\"用户数据\"参数.">
    参数 参数_下载总量 <类型 = 长整数 注释 = "预计所需下载数据的总尺寸.">
    参数 参数_当前下载 <类型 = 长整数 注释 = "当前所下载的数据尺寸.">
    参数 参数_上传总量 <类型 = 长整数 注释 = "预计所需上传数据的总尺寸.">
    参数 参数_当前上传 <类型 = 长整数 注释 = "当前所上传的数据尺寸.">
    {
        超级列表框_虚构.置标题 ((整数)参数_用户数据, 3, 到文本 ((整数)(100 * (小数)参数_当前下载 / 参数_下载总量)) + "%")
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.世恒.视窗21天

类 类_生成在线更新配置 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"827, 541\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"725, 463, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_生成 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"613, 463, 96, 32\"" 标题 = "生成"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_版本名称 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"365, 63, 136, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"262, 63, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "版本名称">
    变量 编辑框_版本号 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"124, 63, 129, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"13, 63, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "版本号">
    变量 编辑框_更新内容 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"124, 111, 697, 104\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 是否允许多行 = 真>
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"509, 63, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "更新时间">
    变量 编辑框_根部网址 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"125, 12, 696, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"13, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "根部网址">
    变量 超级列表框_文件列表 <类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"13, 231, 808, 216\""
            "类型" = 报表列表框 显示表格线 = 真 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0"
            报表列 = "0\n-1\n0\n150\n文件名\n0\n-1\n0\n200\n本地路径\n0\n-1\n0\n90\n文件大小\n0\n-1\n0\n160\n保存文件名\n0\n-1\n0\n120\nMD5\n0\n-1\n0\n50\n原始路径\n0\n-1\n0\n50\n压缩后路径"
            单一选择 = 真 整行选择 = 真>
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"13, 111, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "更新内容">
    变量 日期框_更新时间 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"629, 63, 192, 32\"">
    变量 超级按钮_获取目录 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"13, 463, 96, 32\"" 标题 = "获取目录"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_获取文件 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"125, 463, 96, 32\"" 标题 = "获取文件"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_上传文件 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"237, 463, 96, 32\"" 标题 = "上传文件"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 进度条1 <类型 = 进度条 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"357, 463, 232, 32\"" 显示方式 = 连续 最小位置 = 0
            最大位置 = 100 方向 = 横向 可视 = 假>
    变量 成员_网页访问 <公开 静态 类型 = 网络访问类>
    变量 超级列表框_文件列表临时 <静态 类型 = 超级列表框>
    变量 成员_网络访问对象数组 <公开 静态 类型 = 对象数组类>

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_上传文件)
        {
            // 进度条1.可视 = 真
            // 挂接事件 (成员_网页访问, 111)
            // 启动线程 (方法_文件下载, , , , )
            超级列表框_文件列表临时 = 超级列表框_文件列表

            计次循环 (超级列表框_文件列表.取表项数 ())
            {
                变量 局部_位置 <类型 = 整数>
                局部_位置 = 成员_网络访问对象数组.加入新成员 (网络访问类, )
                挂接事件 ((网络访问类)成员_网络访问对象数组.取成员 (局部_位置), 300 + 取循环索引 ())
                启动线程 (方法_文件上传, 取循环索引 (), , , )


            }




            // 局部_网页访问




        }
        否则 (来源对象 == 超级按钮_获取目录)
        {
            变量 局部_目录 <类型 = 文本型>
            局部_目录 = 浏览文件夹 ("请选择要加入升级配置的文件目录：", )
            调试输出 (局部_目录)
            超级列表框_文件列表.全部删除 ()
            方法_寻找文件 (局部_目录, "")



        }
        否则 (来源对象 == 超级按钮_获取文件)
        {


            // 运行 ("C:\\Program Files\\WinRAR\\WinRAR.exe a -ep J:\\volpc21days\\第20天_在线更新\\升级文件\\插件目录\\进货管理.rar J:\\volpc21days\\第20天_在线更新\\升级文件\\插件目录\\进货管理.dll", 真, 程序窗口显示方式.隐藏窗口)

            变量 局部_压缩文件 <类型 = RAR文件解压类>
            局部_压缩文件.打开文件 ("J:\\volpc21days\\第20天_在线更新\\升级文件\\插件目录\\进货管理.rar", )
            局部_压缩文件.解压所有文件 ("J:\\volpc21days\\第20天_在线更新\\升级文件\\插件目录\\")








        }
        否则 (来源对象 == 超级按钮_生成)
        {
            变量 局部_JSON对象 <类型 = JSON对象类>
            变量 局部_JSON数组 <类型 = JSON数组类>

            局部_JSON对象.置入整数值 ("文件数", 超级列表框_文件列表.取表项数 ())
            局部_JSON对象.置入文本值 ("版本名称", 编辑框_版本名称.内容)
            局部_JSON对象.置入文本值 ("版本号", 编辑框_版本号.内容)
            局部_JSON对象.置入文本值 ("根部网址", 编辑框_根部网址.内容)
            局部_JSON对象.置入文本值 ("更新时间", 时间到文本 (日期框_更新时间.今天, , ))
            局部_JSON对象.置入文本值 ("更新内容", 编辑框_更新内容.内容)

            // 调试输出 (局部_JSON对象.取文本值 ("更新内容"))

            计次循环 (超级列表框_文件列表.取表项数 ())
            {
                变量 局部_JSON数组内对象 <类型 = JSON对象类>
                局部_JSON数组内对象.置入文本值 ("原始文件名", 超级列表框_文件列表.取标题 (取循环索引 (), 0))
                局部_JSON数组内对象.置入文本值 ("本地路径", 超级列表框_文件列表.取标题 (取循环索引 (), 1))
                局部_JSON数组内对象.置入文本值 ("保存文件名", 超级列表框_文件列表.取标题 (取循环索引 (), 3))
                局部_JSON数组内对象.置入文本值 ("文件大小", 超级列表框_文件列表.取标题 (取循环索引 (), 2))
                局部_JSON数组内对象.置入文本值 ("MD5", 超级列表框_文件列表.取标题 (取循环索引 (), 4))
                局部_JSON数组.置入对象值 (局部_JSON数组内对象, )

            }
            局部_JSON对象.置入数组值 ("文件列表", 局部_JSON数组)

            // {"文件数":3,"版本名称":"V1.1","版本号":"1.1","根部网址":"http://zwbcwang.h902.000pc.net/","更新时间":"2022-07-29 23:11:29","更新内容":"1、主程序界面修改；\r\n2、数据库结构调整；\r\n3、主要是测试在线升级。","文件列表":[{"原始文件名":"简易进销存.exe","本地路径":"简易进销存.exe","保存文件名":"upload/202207292236447545.rar","文件大小":"8034K","MD5":"c4ca4238a0b923820dcc509a6f75849b"},{"原始文件名":"权限管理.dll","本地路径":"插件目录\\权限管理.dll","保存文件名":"upload/20220729223324333.rar","文件大小":"3432K","MD5":"56ca4238a0b92382sscc509a6f7585gh"},{"原始文件名":"进货管理.dll","本地路径":"插件目录\\进货管理.dll","保存文件名":"upload/20220729223378905.rar","文件大小":"6422K","MD5":"67ka4238a0b92382sscc509a6f7545ho"}]}
            调试输出 (局部_JSON对象.到可读文本 (真, ))
            变量 局部_JSON文本1 <类型 = 文本型
                    值 = "{\r\n \"文件列表\" : \r\n [\r\n  {\r\n   \"MD5\" : \"1082CFA81392E573E7BD0BB9424AB221\",\r\n   \"保存文件名\" : \"upload/202207310213061964.rar\",\r\n   \"原始文件名\" : \"Ry4S.dll\",\r\n   \"文件大小\" : \"36239\",\r\n   \"本地路径\" : \"Ry4S.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"64C58EB4B1680C6DE8DC813EE6DBB1B8\",\r\n   \"保存文件名\" : \"upload/202207310213061774.rar\",\r\n   \"原始文件名\" : \"SCDLL32.dll\",\r\n   \"文件大小\" : \"46418\",\r\n   \"本地路径\" : \"SCDLL32.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"897714613082E421EE99BDC73AB58E28\",\r\n   \"保存文件名\" : \"upload/202207310213067767.rar\",\r\n   \"原始文件名\" : \"登录信息.ini\",\r\n   \"文件大小\" : \"167\",\r\n   \"本地路径\" : \"登录信息.ini\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D17911719FEA56172E7C0A363906742D\",\r\n   \"保存文件名\" : \"upload/202207310213069163.rar\",\r\n   \"原始文件名\" : \"简易进销存.exe\",\r\n   \"文件大小\" : \"175677\",\r\n   \"本地路径\" : \"简易进销存.exe\"\r\n  },\r\n  {\r\n   \"MD5\" : \"497436889DCC07258B7AD2D605020720\",\r\n   \"保存文件名\" : \"upload/202207310213076438.rar\",\r\n   \"原始文件名\" : \"grmysql6.dll\",\r\n   \"文件大小\" : \"840469\",\r\n   \"本地路径\" : \"插件目录\\\\grmysql6.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"8690644B0CF6C751CA3F841373BDD4CC\",\r\n   \"保存文件名\" : \"upload/202207310213079455.rar\",\r\n   \"原始文件名\" : \"供应商管理.dll\",\r\n   \"文件大小\" : \"1071715\",\r\n   \"本地路径\" : \"插件目录\\\\供应商管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"0E1A82249BF2138423066F85D38C5A97\",\r\n   \"保存文件名\" : \"upload/202207310213071418.rar\",\r\n   \"原始文件名\" : \"客户管理.dll\",\r\n   \"文件大小\" : \"884430\",\r\n   \"本地路径\" : \"插件目录\\\\客户管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D44436595BE63C566108A9C2509D7CC0\",\r\n   \"保存文件名\" : \"upload/202207310213075963.rar\",\r\n   \"原始文件名\" : \"进货管理.dll\",\r\n   \"文件大小\" : \"790515\",\r\n   \"本地路径\" : \"插件目录\\\\进货管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"BAE460E44E852657714FE91070C368E4\",\r\n   \"保存文件名\" : \"upload/202207310213066928.rar\",\r\n   \"原始文件名\" : \"简易进销存.accdb\",\r\n   \"文件大小\" : \"38450\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.accdb\"\r\n  },\r\n  {\r\n   \"MD5\" : \"FB4724ACBBD7E918815A3BD01FA7BE9F\",\r\n   \"保存文件名\" : \"upload/202207310213061124.rar\",\r\n   \"原始文件名\" : \"简易进销存.mdb\",\r\n   \"文件大小\" : \"29970\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.mdb\"\r\n  }\r\n ],\r\n \"文件数\" : 10,\r\n \"更新时间\" : \"2022年7月31日2时12分13秒\",\r\n \"根部网址\" : \"http://zwbcwang.h902.000pc.net/update/\",\r\n \"版本号\" : \"1.1\",\r\n \"版本名称\" : \"V1.1\"\r\n}">
            变量 局部_加密后字节集 <类型 = 字节集类>
            变量 局部_解密后字节集 <类型 = 字节集类>
            局部_加密后字节集 = 加解密类.加密_RC4 (文本到UTF8 (局部_JSON文本1, ), "12345abc67890def")
            局部_解密后字节集 = 加解密类.解密_RC4 (局部_加密后字节集, "12345abc67890def")
            写到文件 (取当前目录 () + "\\update.json", 局部_加密后字节集, )
            写到文件 (取当前目录 () + "\\update_ok.json", 局部_解密后字节集, )




        }


        返回 (0)


    }

    方法 方法_文件下载 <静态 类型 = 整数>
    参数 参数_用户数据 <类型 = 变整数>
    {
        // 局部_访问响应 = 局部_网页访问.网页访问 ("https://baike.baidu.com/item/curl/10098606?fr=aladdin", , , , , , , , , , , )
        // 挂接事件 (局部_网页访问, 111)
        变量 局部_访问响应 <类型 = 网页访问响应类>

        //局部_访问响应 = 成员_网页访问.网页访问 ("http://doc.voldp.com/grammar.htm", , , , , , , , , , , )
        //"username=张三&password=123abc"
        // 调试输出 (局部_访问响应.响应头)
        // 调试输出 (局部_访问响应.响应码)
        // 调试输出 (局部_访问响应.请求结果)
        // 写到文件 (取当前目录 () + "\\grammar.htm", 局部_访问响应.请求结果, )
        局部_访问响应 = 成员_网页访问.网页访问2 ("http://zwbcwang.h902.000pc.net/update/upload/jyjxc.rar", , , , , , , , , , , )
        调试输出 (局部_访问响应.响应头)
        调试输出 (局部_访问响应.响应码)
        调试输出 (局部_访问响应.请求结果)
        写到文件 (取当前目录 () + "\\jyjxc.rar", 局部_访问响应.请求结果, )
        // 启动线程 (, , , , )

        返回 (0)
    }

    方法 方法_文件上传 <静态 类型 = 整数>
    参数 参数_用户数据 <类型 = 变整数>
    {
        // 局部_访问响应 = 局部_网页访问.网页访问 ("https://baike.baidu.com/item/curl/10098606?fr=aladdin", , , , , , , , , , , )
        // 挂接事件 (局部_网页访问, 111)
        变量 局部_访问响应 <类型 = 网页访问响应类>

        // 局部_访问响应 = 局部_网页访问.网页访问 ("http://doc.voldp.com/grammar.htm", , , , , , , , , , , )
        // 调试输出 (局部_访问响应.响应头)
        // 调试输出 (局部_访问响应.响应码)
        // 调试输出 (局部_访问响应.请求结果)
        // 写到文件 (取当前目录 () + "\\grammar.htm", 局部_访问响应.请求结果, )
        变量 局部_上传数据字节集 <类型 = 字节集类>
        变量 局部_协议头 <类型 = 文本数组类>
        变量 局部_协议头文本 <类型 = 文本型
                值 = "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\r\nAccept-Encoding: gzip, deflate\r\nAccept-Language: zh-CN,zh;q=0.9\r\nCache-Control: max-age=0\r\nConnection: keep-alive\r\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarynCkGO9IQT8rpQzw8\r\nHost: zwbcwang.h902.000pc.net\r\nOrigin: http://zwbcwang.h902.000pc.net\r\nReferer: http://zwbcwang.h902.000pc.net/update/up.php\r\nUpgrade-Insecure-Requests: 1\r\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.87 Safari/537.36 SE 2.X MetaSr 1.0\r\n">
        变量 局部_简化协议头文本 <类型 = 文本型
                值 = "Content-Type: multipart/form-data; boundary=----WebKitFormBoundarynCkGO9IQT8rpQzw8\r\n\r\n">
        变量 局部_自定义简化协议头文本 <类型 = 文本型 值 = "Content-Type: multipart/form-data; boundary=----shteach123456\r\n\r\n">

        分割文本 (局部_自定义简化协议头文本, "\r\n", 局部_协议头, , )

        变量 局部_文件路径 <类型 = 文本型>

        局部_文件路径 = 超级列表框_文件列表临时.取标题 ((整数)参数_用户数据, 6)

        局部_上传数据字节集 = 文本到UTF8 ("------shteach123456", 假)
        // 局部_上传数据字节集 = 文本到UTF8 ("------WebKitFormBoundarynCkGO9IQT8rpQzw8", 假)
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("Content-Disposition: form-data; name=\"wenjian\"; filename=\"" + 取文件名无路径部分 (局部_文件路径) + "\"", 假))
        // 局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))
        // 局部_上传数据字节集.添加字节集 (文本到UTF8 ("Content-Type: multipart/form-data", 假))
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))

        局部_上传数据字节集.添加字节集 (读入文件 (局部_文件路径, ))
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))
        局部_上传数据字节集.添加字节集 (文本到UTF8 ("\r\n", 假))

        局部_上传数据字节集.添加字节集 (文本到UTF8 ("------shteach123456--", 假))
        // 局部_上传数据字节集.添加字节集 (文本到UTF8 ("------WebKitFormBoundarynCkGO9IQT8rpQzw8--", 假))




        变量 局部_网络访问 <类型 = 网络访问类>
        局部_网络访问 = (网络访问类)成员_网络访问对象数组.取成员 ((整数)参数_用户数据)
        局部_访问响应 = 局部_网络访问.网页访问2 ("http://zwbcwang.h902.000pc.net/update/up.php", 网页访问方式.POST, 局部_上传数据字节集, 局部_协议头, , , , , , , , )


        调试输出 (局部_访问响应.响应头)
        调试输出 (局部_访问响应.响应码)
        调试输出 (UTF8到文本 (局部_访问响应.请求结果))
        变量 局部_返回文本 <类型 = 文本型>
        局部_返回文本 = UTF8到文本 (局部_访问响应.请求结果)
        子文本替换 (局部_返回文本, "文件上传成功，地址为：", "", , , )
        超级列表框_文件列表临时.置标题 ((整数)参数_用户数据, 3, 局部_返回文本)


        // 文件上传成功,地址为:upload/202207310100411046.rar
        // 写到文件 (取当前目录 () + "\\jyjxc.rar", 局部_访问响应.请求结果, )
        // 启动线程 (, , , , )

        返回 (0)
    }

    方法 方法_寻找文件
    参数 参数_目录 <类型 = 文本型>
    参数 参数_子目录 <类型 = 文本型>
    {
        变量 局部_文件寻找 <类型 = 文件查找类>
        变量 局部_文件名 <类型 = 文本型>
        如果真 (取文本右边 (参数_目录, 1) != "\\")
        {
            参数_目录 = 参数_目录 + "\\"
        }
        // 调试输出 (参数_目录)
        // 调试输出 (参数_目录 + "*.*")
        局部_文件名 = 局部_文件寻找.寻找文件 (参数_目录 + "*.*", , 文件属性.子目录)
        变量 局部_本地路径 <类型 = 文本型>

        判断循环 (局部_文件名 != "")
        {
            如果 (参数_子目录 != "")
            {
                调试输出 (参数_子目录 + "\\" + 局部_文件名)
                局部_本地路径 = 参数_子目录 + "\\" + 局部_文件名

            }
            否则
            {
                调试输出 (局部_文件名)
                局部_本地路径 = 局部_文件名
            }
            变量 局部_索引 <类型 = 整数>
            局部_索引 = 超级列表框_文件列表.插入表项 (, , , , , )
            超级列表框_文件列表.置标题 (局部_索引, 0, 局部_文件名)
            超级列表框_文件列表.置标题 (局部_索引, 1, 局部_本地路径)
            变量 ""
            删除文件 (参数_目录 + 局部_文件名 + ".rar")
            运行 ("C:\\Program Files\\WinRAR\\WinRAR.exe a -ep " + 参数_目录 + 局部_文件名 + ".rar" + " " + 参数_目录 + 局部_文件名, 真, 程序窗口显示方式.隐藏窗口)

            超级列表框_文件列表.置标题 (局部_索引, 4, 加解密类.取数据MD5 (读入文件 (参数_目录 + 局部_文件名 + ".rar", )))
            超级列表框_文件列表.置标题 (局部_索引, 2, 到文本 (取文件尺寸 (参数_目录 + 局部_文件名 + ".rar")))
            超级列表框_文件列表.置标题 (局部_索引, 5, 参数_目录 + 局部_文件名)
            超级列表框_文件列表.置标题 (局部_索引, 6, 参数_目录 + 局部_文件名 + ".rar")


            // C:\Program Files\WinRAR
            // WinRAR a help *.hlp








            局部_文件名 = 局部_文件寻找.寻找文件 ("", , 文件属性.子目录)

        }
        局部_文件名 = 局部_文件寻找.寻找文件 (参数_目录 + "*.*", 文件属性.子目录, )
        判断循环 (局部_文件名 != "")
        {
            // 调试输出 (参数_目录 + 局部_文件名)
            如果真 (取文本左边 (局部_文件名, 1) != ".")
            {
                //.
                //..
                方法_寻找文件 (参数_目录 + 局部_文件名, 局部_文件名)

            }
            局部_文件名 = 局部_文件寻找.寻找文件 ("", 文件属性.子目录, )

        }




    }

    #

    变量 局部_JSON文本 <类型 = 文本型
            值 = "{\"文件数\":3,\"版本名称\":\"V1.1\",\"版本号\":\"1.1\",\"根部网址\":\"http://zwbcwang.h902.000pc.net/\",\"更新时间\":\"2022-07-29 23:11:29\",\"更新内容\":\"1、主程序界面修改；\\r\\n2、数据库结构调整；\\r\\n3、主要是测试在线升级。\",\"文件列表\":[{\"原始文件名\":\"简易进销存.exe\",\"本地路径\":\"简易进销存.exe\",\"保存文件名\":\"upload/202207292236447545.rar\",\"文件大小\":\"8034K\",\"MD5\":\"c4ca4238a0b923820dcc509a6f75849b\"},{\"原始文件名\":\"权限管理.dll\",\"本地路径\":\"插件目录\\\\权限管理.dll\",\"保存文件名\":\"upload/20220729223324333.rar\",\"文件大小\":\"3432K\",\"MD5\":\"56ca4238a0b92382sscc509a6f7585gh\"},{\"原始文件名\":\"进货管理.dll\",\"本地路径\":\"插件目录\\\\进货管理.dll\",\"保存文件名\":\"upload/20220729223378905.rar\",\"文件大小\":\"6422K\",\"MD5\":\"67ka4238a0b92382sscc509a6f7545ho\"}]}">

    # 方法_解析显示升级数据 (超级列表框_文件列表, 局部_JSON文本)
    # 返回 (0)

    方法 方法_解析显示升级数据
    参数 参数_超级列表框 <类型 = 超级列表框>
    参数 参数_JSON数据 <类型 = 文本型>
    {
        变量 局部_JSON对象 <类型 = JSON对象类>
        变量 局部_JSON数组 <类型 = JSON数组类>
        变量 局部_JSON数组内对象 <类型 = JSON对象类>
        变量 局部_键名组 <类型 = 文本数组类>
        变量 局部_索引 <类型 = 整数>
        局部_JSON对象.创建自文本 (参数_JSON数据)
        调试输出 (局部_JSON对象.取文本值 ("版本号"))
        调试输出 (局部_JSON对象.取文本值 ("更新内容"))
        局部_JSON对象.取所有键名 (局部_键名组)
        调试输出 (局部_键名组)
        调试输出 (局部_JSON对象.取整数值 ("文件数"))
        计次循环 (局部_JSON对象.取整数值 ("文件数"))
        {
            调试输出 (局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].本地路径"))
            调试输出 (局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].MD5"))
            // 文件列表.[0].本地路径
            // 文件列表.[1].本地路径
            局部_索引 = 参数_超级列表框.插入表项 (, , , , , )
            参数_超级列表框.置标题 (局部_索引, 0, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].原始文件名"))
            参数_超级列表框.置标题 (局部_索引, 1, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].本地路径"))
            参数_超级列表框.置标题 (局部_索引, 2, 局部_JSON对象.取文本值 ("//文件列表.[" + 到文本 (取循环索引 ()) + "].文件大小"))

        }
        局部_JSON对象.取数组值 ("文件列表", 局部_JSON数组)
        调试输出 ("局部_JSON数组.成员数")
        调试输出 (局部_JSON数组.成员数)
        计次循环 (局部_JSON数组.成员数)
        {
            局部_JSON数组.取对象值 (取循环索引 (), 局部_JSON数组内对象)
            调试输出 (局部_JSON数组内对象.取文本值 ("本地路径"))
            局部_JSON数组内对象.取所有键名 (局部_键名组)
            调试输出 (局部_键名组)

        }



    }

    方法 网络访问类_访问进度改变 <接收事件 类型 = 整数 注释 = "在发送请求过程中如果请求进度发生改变,将会响应本事件.">
    参数 来源对象 <类型 = 网络访问类 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 下载总量 <类型 = 长整数 注释 = "预计需要下载的字节数.">
    参数 当前下载 <类型 = 长整数 注释 = "当前已下载的字节数.">
    参数 上传总量 <类型 = 长整数 注释 = "预计需要上传的字节数.">
    参数 当前上传 <类型 = 长整数 注释 = "当前已上传的字节数.">
    {
        如果 (标记值 == 111)
        {
            进度条1.位置 = (整数)(100 * (小数)当前下载 / 下载总量)
            如果真 (当前下载 == 下载总量 && 下载总量 != 0 && 当前下载 != 0)
            {
                进度条1.可视 = 假

            }
            调试输出 (下载总量, 当前下载)
            调试输出 ("--------")

        }
        否则 (标记值 == 222)
        {
            // 进度条1.位置 = (整数)(100 * (小数)当前上传 / 上传总量)
            // 如果真 (当前上传 == 上传总量 && 上传总量 != 0 && 当前上传 != 0)
            {
                // 进度条1.可视 = 假

            }
            // 调试输出 (上传总量, 当前上传)
            // 调试输出 ("--------")

        }
        否则 (标记值 >= 300)
        {
            超级列表框_文件列表.置标题 (标记值 % 300, 3, 到文本 ((整数)(100 * (小数)当前上传 / 上传总量)) + "%")

            // 进度条1.位置 = (整数)(100 * (小数)当前上传 / 上传总量)
            // 如果真 (当前上传 == 上传总量 && 上传总量 != 0 && 当前上传 != 0)
            {
                // 进度条1.可视 = 假

            }
            // 调试输出 (上传总量, 当前上传)
            // 调试输出 ("--------")

        }



        返回 (0)
    }

    方法 类_生成在线更新配置_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_生成在线更新配置 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 局部_JSON文本1 <类型 = 文本型
                值 = "{\r\n \"文件列表\" : \r\n [\r\n  {\r\n   \"MD5\" : \"1082CFA81392E573E7BD0BB9424AB221\",\r\n   \"保存文件名\" : \"upload/202207310213061964.rar\",\r\n   \"原始文件名\" : \"Ry4S.dll\",\r\n   \"文件大小\" : \"36239\",\r\n   \"本地路径\" : \"Ry4S.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"64C58EB4B1680C6DE8DC813EE6DBB1B8\",\r\n   \"保存文件名\" : \"upload/202207310213061774.rar\",\r\n   \"原始文件名\" : \"SCDLL32.dll\",\r\n   \"文件大小\" : \"46418\",\r\n   \"本地路径\" : \"SCDLL32.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"897714613082E421EE99BDC73AB58E28\",\r\n   \"保存文件名\" : \"upload/202207310213067767.rar\",\r\n   \"原始文件名\" : \"登录信息.ini\",\r\n   \"文件大小\" : \"167\",\r\n   \"本地路径\" : \"登录信息.ini\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D17911719FEA56172E7C0A363906742D\",\r\n   \"保存文件名\" : \"upload/202207310213069163.rar\",\r\n   \"原始文件名\" : \"简易进销存.exe\",\r\n   \"文件大小\" : \"175677\",\r\n   \"本地路径\" : \"简易进销存.exe\"\r\n  },\r\n  {\r\n   \"MD5\" : \"497436889DCC07258B7AD2D605020720\",\r\n   \"保存文件名\" : \"upload/202207310213076438.rar\",\r\n   \"原始文件名\" : \"grmysql6.dll\",\r\n   \"文件大小\" : \"840469\",\r\n   \"本地路径\" : \"插件目录\\\\grmysql6.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"8690644B0CF6C751CA3F841373BDD4CC\",\r\n   \"保存文件名\" : \"upload/202207310213079455.rar\",\r\n   \"原始文件名\" : \"供应商管理.dll\",\r\n   \"文件大小\" : \"1071715\",\r\n   \"本地路径\" : \"插件目录\\\\供应商管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"0E1A82249BF2138423066F85D38C5A97\",\r\n   \"保存文件名\" : \"upload/202207310213071418.rar\",\r\n   \"原始文件名\" : \"客户管理.dll\",\r\n   \"文件大小\" : \"884430\",\r\n   \"本地路径\" : \"插件目录\\\\客户管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D44436595BE63C566108A9C2509D7CC0\",\r\n   \"保存文件名\" : \"upload/202207310213075963.rar\",\r\n   \"原始文件名\" : \"进货管理.dll\",\r\n   \"文件大小\" : \"790515\",\r\n   \"本地路径\" : \"插件目录\\\\进货管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"BAE460E44E852657714FE91070C368E4\",\r\n   \"保存文件名\" : \"upload/202207310213066928.rar\",\r\n   \"原始文件名\" : \"简易进销存.accdb\",\r\n   \"文件大小\" : \"38450\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.accdb\"\r\n  },\r\n  {\r\n   \"MD5\" : \"FB4724ACBBD7E918815A3BD01FA7BE9F\",\r\n   \"保存文件名\" : \"upload/202207310213061124.rar\",\r\n   \"原始文件名\" : \"简易进销存.mdb\",\r\n   \"文件大小\" : \"29970\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.mdb\"\r\n  }\r\n ],\r\n \"文件数\" : 10,\r\n \"更新时间\" : \"2022年7月31日2时12分13秒\",\r\n \"根部网址\" : \"http://zwbcwang.h902.000pc.net/update/\",\r\n \"版本号\" : \"1.1\",\r\n \"版本名称\" : \"V1.1\"\r\n}">
        变量 局部_加密后字节集 <类型 = 字节集类>
        变量 局部_解密后字节集 <类型 = 字节集类>
        局部_加密后字节集 = 加解密类.加密_RC4 (文本到UTF8 (局部_JSON文本1, ), "12345abc67890def")
        局部_解密后字节集 = 加解密类.解密_RC4 (局部_加密后字节集, "12345abc67890def")
        写到文件 (取当前目录 () + "\\update.json", 局部_加密后字节集, )
        写到文件 (取当前目录 () + "\\update_ok.json", 局部_解密后字节集, )


        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 动态库程序类>
{
    变量 数据库_全局ACCESS库 <公开 类型 = 数据库类>
    变量 窗口_客户管理 <公开 类型 = 类_客户管理>
    变量 窗口_客户信息 <公开 类型 = 类_客户信息>

    方法 启动方法 <公开 类型 = 整数>
    {
        返回 (1)
    }

    方法 方法_客户管理 <公开 静态 类型 = 逻辑型 注释 = "一个输出方法模板" @输出名 = "jyjxc_khgl" @视窗.输出 = 真>
    {
        返回 (取程序 ().窗口_客户管理.创建主窗口 (, , , , ))

        // 请在其中填入自己的方法内容
    }

    方法 方法_客户信息 <公开 静态 类型 = 逻辑型 注释 = "一个输出方法模板" @输出名 = "jyjxc_khxx" @视窗.输出 = 真>
    {
        返回 (取程序 ().窗口_客户信息.创建主窗口 (, , , , ))
        // 请在其中填入自己的方法内容
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_客户管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 底色 = 0xFFFFFF 窗口边框 = 无边框
        可否移动 = 真 随意移动 = 真>
{
    变量 ""
    变量 成员_标签数组 <类型 = "标签 [4]">
    变量 成员_表格组件数组 <类型 = 对象数组类>
    变量 局部_一行 <类型 = 类_表格行布局>
    变量 画板1 <类型 = 画板 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"557, 511, 416, 232\"" 自动重画 = 真 绘画单位 = 像素点
            刷子类型 = 空刷子 可视 = 假>
    变量 成员_表格行 <类型 = 对象数组类>
    变量 ""
    变量 ""
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"10, 13, 210, 50\"" 标题 = "总数量"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"274, 13, 210, 50\"" 标题 = "合作中"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"274, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"538, 13, 210, 50\"" 标题 = "终止中"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"538, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"803, 13, 210, 50\"" 标题 = "30天内到期"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"803, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"803, 126, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"917, 126, 96, 32\"" 标题 = "添加"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"10, 126, 649, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"677, 126, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 图片框1 <类型 = 图片框 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"221, 591, 132, 132\"" 可视 = 假>
    变量 ""
    变量 ""
    变量 ""
    变量 窗口_客户信息 <公开 类型 = 类_客户信息>
    变量 成员_当前状态 <公开 类型 = 文本型>
    变量 ""
    变量 外形框_表头 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"10, 167, 1004, 38\"" 线条颜色 = 0xE4E4E4
            背景颜色 = 0xF2F2F2 外形 = 矩形 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 标签_客户名称 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 117\r\nparent_id = 116\r\npos = \"749, 2, 214, 33\"" 字体 = "微软雅黑, 14, 1, 0, 0, 0, 0"
            背景颜色 = 0xF2F2F2 横向对齐方式 = 左边 组件边框 = 无边框 标题 = "操作">
    变量 标签_联系人 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 118\r\nparent_id = 116\r\npos = \"256, 2, 144, 33\"" 字体 = "微软雅黑, 14, 1, 0, 0, 0, 0"
            背景颜色 = 0xF2F2F2 横向对齐方式 = 左边 组件边框 = 无边框 标题 = "联系人">
    变量 标签_电话 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 119\r\nparent_id = 116\r\npos = \"415, 2, 155, 33\"" 字体 = "微软雅黑, 14, 1, 0, 0, 0, 0"
            背景颜色 = 0xF2F2F2 横向对齐方式 = 左边 组件边框 = 无边框 标题 = "电话">
    变量 标签_合同起始 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 120\r\nparent_id = 116\r\npos = \"584, 2, 144, 33\"" 字体 = "微软雅黑, 14, 1, 0, 0, 0, 0"
            背景颜色 = 0xF2F2F2 横向对齐方式 = 左边 组件边框 = 无边框 标题 = "合同起始">
    变量 外形框3 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 121\r\nparent_id = 116\r\npos = \"246, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 外形框4 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 122\r\nparent_id = 116\r\npos = \"408, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 外形框5 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 123\r\nparent_id = 116\r\npos = \"575, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 选择框_选择 <公开 类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 124\r\nparent_id = 116\r\npos = \"6, 3, 22, 31\""
            选中 = 真 组件边框 = 无边框 背景颜色 = 0xF2F2F2>
    变量 外形框6 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 125\r\nparent_id = 116\r\npos = \"740, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 标签_合同起始2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 126\r\nparent_id = 116\r\npos = \"37, 2, 176, 33\""
            字体 = "微软雅黑, 14, 1, 0, 0, 0, 0" 背景颜色 = 0xF2F2F2 横向对齐方式 = 左边 组件边框 = 无边框 标题 = "客户名称">
    变量 ""
    变量 ""
    变量 ""

    方法 类_客户管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_客户管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        成员_标签数组 [0] = 标签_客户名称
        成员_标签数组 [1] = 标签_联系人
        成员_标签数组 [2] = 标签_电话
        成员_标签数组 [3] = 标签_合同起始
        调试输出 (取数组成员数 (成员_标签数组))

        成员_表格组件数组.加入成员 (标签_合同起始)
        // 成员_表格组件数组.加入成员 (超级按钮_名片)
        成员_表格组件数组.加入成员 (选择框_选择)
        // 成员_表格组件数组.加入成员 (超级按钮_删除)
        // 成员_表格组件数组.加入成员 (编辑框_排序)
        成员_表格组件数组.加入成员 (标签_电话)
        // /成员_表格组件数组.加入成员 (超级按钮_修改)
        成员_表格组件数组.加入成员 (标签_客户名称)
        成员_表格组件数组.加入成员 (标签_联系人)
        调试输出 (成员_表格组件数组.取成员数 ())
        // 方法_连接数据库 ()
        方法_显示客户列表 ("客户")
        方法_统计客户 ()


        返回 (0)



        画板1.画笔粗细 = 5
        画板1.画笔颜色 = 颜色类.红色
        画板1.画矩形 (5, 5, 300, 120)
        画板1.画笔粗细 = 1
        画板1.画笔类型 = 画笔类型.点线
        画板1.画笔颜色 = 颜色类.紫色
        画板1.画矩形 (15, 15, 290, 110)
        画板1.文本颜色 = 颜色类.蓝色
        画板1.字体 = "隶书,40"
        画板1.定位写出 ((300 - 画板1.取宽度 ("火山视窗")) / 2, 20, "火山视窗", )
        变量 局部_高度 <类型 = 整数>
        局部_高度 = 画板1.取高度 ("火山视窗")

        画板1.文本颜色 = 颜色类.墨绿色
        画板1.字体 = "宋体,20"
        画板1.定位写出 ((300 - 画板1.取宽度 ("中文编程领导者")) / 2, 20 + 局部_高度 + 5, "中文编程领导者", )



        方法_连接数据库 ()
        方法_显示客户列表 ("客户")


        返回 (0)
    }

    方法 方法_连接数据库 <类型 = 逻辑型>
    {
        如果真 (取程序 ().数据库_全局ACCESS库.当前状态 == 数据库状态类型.关闭)
        {
            调试输出 (取当前目录 () + "\\数据目录\\简易进销存.accdb")
            如果真 (取程序 ().数据库_全局ACCESS库.连接Access (取当前目录 () + "\\数据目录\\简易进销存.accdb", , 真) == 假)
            {
                信息框 ("数据库连接失败", , )
                销毁 ()
                返回 (假)

            }

        }
        返回 (真)

    }

    方法 方法_统计客户
    {
        变量 局部_记录集 <类型 = 记录集类>
        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [客户]", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [客户] where [是否合作]=true", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [客户] where [是否合作]=false", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()

        如果真 (局部_记录集.从已有连接打开 ("select count(ID) as [总数] from [客户] where datediff('d',now(),[合同终止])<=30", 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回  // day
        }
        局部_记录集.到首记录 ()
        如果真 (局部_记录集.记录数量 == 1)
        {
            标签_紫色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))

        }
        局部_记录集.关闭 ()


    }

    方法 方法_显示客户列表
    参数 参数_SQL语句 <类型 = 文本型>
    {
        变量 局部_记录集 <类型 = 记录集类>
        变量 局部_位置 <类型 = 整数>
        如果真 (局部_记录集.从已有连接打开 (参数_SQL语句, 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
        {
            信息框 ("查询失败", , )
            返回

        }
        局部_记录集.到首记录 ()
        成员_表格行.删除所有成员 ()
        计次循环 ((整数)局部_记录集.记录数量)
        {
            局部_位置 = 成员_表格行.加入新成员 (类_表格行布局, )
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).创建容器组件 (本对象, 外形框_表头.左边, 外形框_表头.顶边 + 外形框_表头.高度 + 局部_位置 * 37, )
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).标签_客户名称.标题 = 局部_记录集.读文本数据 ("客户名称")
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).标签_联系人.标题 = 局部_记录集.读文本数据 ("联系人")
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).标签_电话.标题 = 局部_记录集.读文本数据 ("电话")
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).标签_合同起始.标题 = 局部_记录集.读文本数据 ("合同起始")
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).选择框_选择.选中 = 局部_记录集.读逻辑型数据 ("是否合作")
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_修改.标记 = "修改"
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_删除.标记 = "删除"
            ((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_名片.标记 = "名片"
            挂接事件 (((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_修改, 局部_记录集.读整数数据 ("ID"))
            挂接事件 (((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_删除, 局部_记录集.读整数数据 ("ID"))
            挂接事件 (((类_表格行布局)成员_表格行.取成员 (局部_位置)).超级按钮_名片, 局部_记录集.读整数数据 ("ID"))

            // 超级列表框_显示.置标题 (局部_位置, 5, 选择 (到文本 (局部_记录集.读逻辑型数据 ("是否合作")) == "1", "是", "否"))

            // 局部_位置 = 超级列表框_显示.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            // 超级列表框_显示.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("供应商名称"))
            // 超级列表框_显示.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("联系人"))
            // 超级列表框_显示.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("电话"))
            // 超级列表框_显示.置标题 (局部_位置, 3, 到文本 (局部_记录集.读小数数据 ("进货折扣")))
            // 超级列表框_显示.置标题 (局部_位置, 4, 到文本 (局部_记录集.读整数数据 ("信誉等级")))
            // 超级列表框_显示.置标题 (局部_位置, 5, 选择 (到文本 (局部_记录集.读逻辑型数据 ("是否合作")) == "1", "是", "否"))
            // 超级列表框_显示.置标题 (局部_位置, 6, 局部_记录集.读文本数据 ("合同起始"))
            // 超级列表框_显示.置标题 (局部_位置, 7, 局部_记录集.读文本数据 ("合同终止"))

            // 超级列表框_显示.置标题 (局部_位置, 8, 局部_记录集.读文本数据 ("备注"))

            局部_记录集.到下一行 ()

        }
        局部_记录集.关闭 ()
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        调试输出 ("标记：", 来源对象.标记, 标记值)



        如果 (标记值 >= 1)
        {
            如果 (来源对象.标记 == "修改")
            {
                变量 局部_记录集 <类型 = 记录集类>
                如果真 (局部_记录集.从已有连接打开 ("select *  from [客户] where [ID]=" + 到文本 (标记值), 取程序 ().数据库_全局ACCESS库, , , 记录集编辑锁类型.开放式锁定, ) == 假)
                {
                    信息框 ("查询失败", , )
                    返回 (0)
                }
                局部_记录集.到首记录 ()
                如果真 (局部_记录集.记录数量 == 1)
                {
                    变量 局部_字节集 <类型 = 字节集类>
                    局部_字节集.从文件读字节集 (取当前目录 () + "\\src\\相关素材\\客户LOGO\\百度.png", )
                    调试输出 (局部_记录集.写字节集数据 ("客户LOGO", 局部_字节集))
                    调试输出 (局部_记录集.更新 (, ))
                    调试输出 ("写字节集数据")



                }
                局部_记录集.关闭 ()



            }
            否则 (来源对象.标记 == "名片")
            {
                变量 局部_记录集 <类型 = 记录集类>
                如果真 (局部_记录集.从已有连接打开 ("select *  from [客户] where [ID]=" + 到文本 (标记值), 取程序 ().数据库_全局ACCESS库, , , , ) == 假)
                {
                    信息框 ("查询失败", , )
                    返回 (0)
                }
                局部_记录集.到首记录 ()
                变量 局部_字节集 <类型 = 字节集类>
                如果真 (局部_记录集.记录数量 == 1)
                {
                    局部_字节集 = 局部_记录集.读字节集数据 ("客户LOGO")
                    // 调试输出 (局部_字节集)
                    图片框1.置底图数据 (局部_字节集)
                    调试输出 ("客户LOGO")

                }
                变量 局部_文本 <类型 = 文本型>
                局部_文本 = 局部_记录集.读文本数据 ("客户名称")
                画板1.清除 (, , , )

                画板1.画笔粗细 = 1
                画板1.画笔颜色 = 颜色类.黑色
                画板1.画矩形 (5, 5, 400, 200)
                画板1.文本颜色 = 颜色类.蓝色
                画板1.字体 = "隶书,40"
                画板1.定位写出 ((400 - 画板1.取宽度 (局部_文本) - 61) / 2, 20, 局部_文本, )
                画板1.字体 = "隶书,20"
                局部_文本 = 局部_记录集.读文本数据 ("联系人")
                画板1.定位写出 ((400 - 画板1.取宽度 (局部_文本) - 61) / 2, 90, 局部_文本, )

                局部_文本 = 局部_记录集.读文本数据 ("电话")
                画板1.定位写出 ((400 - 画板1.取宽度 (局部_文本) - 61) / 2, 150, 局部_文本, )
                变量 "// 局部_高度" <类型 = 整数>
                // 局部_高度 = 画板1.取高度 ("火山视窗")

                // 画板1.文本颜色 = 颜色类.墨绿色
                // 画板1.字体 = "宋体,20"
                // 画板1.定位写出 ((300 - 画板1.取宽度 ("中文编程领导者")) / 2, 20 + 局部_高度 + 5, "中文编程领导者", )
                变量 局部_位图对象 <类型 = 位图对象类>
                局部_位图对象 = 位图对象类.载入位图数据 (局部_字节集)

                调试输出 (局部_字节集)

                画板1.画图片 (局部_位图对象, 15, 15, 61, 61, 图像复制方法.拷贝)

                局部_记录集.关闭 ()









            }
            否则 (来源对象.标记 == "删除")
            {

                如果真 (信息框 ("是否要删除当前的客户，删除后无法恢复！", 信息框按钮.询问图标 + 信息框按钮.是否钮, ) == 返回按钮类型.否钮)
                {
                    返回 (0)

                }
                变量 局部_SQL语句 <类型 = 文本型>
                变量 局部_记录集 <类型 = 记录集类>
                局部_SQL语句 = "delete from [客户] where ID= " + 到文本 (标记值)
                调试输出 (局部_SQL语句)
                局部_记录集 = 取程序 ().数据库_全局ACCESS库.执行SQL (局部_SQL语句, , )
                // 局部_记录集.取错误 ()
                // 调试输出 (局部_记录集.状态)
                // 数据库状态类型.
                方法_显示客户列表 ("客户")



            }







        }
        否则
        {
            如果 (来源对象 == 超级按钮_添加)
            {
                成员_当前状态 = "添加"
                窗口_客户信息.创建窗口 (, , , , )

            }
            否则 (来源对象 == 超级按钮_查询)
            {
                变量 局部_SQL语句 <类型 = 文本型>

                如果 (选择框_模糊查找.选中 == 假)
                {
                    局部_SQL语句 = "select * from [客户] where  [客户名称]='" + 编辑框_关键字.内容 + "' or [联系人]='" + 编辑框_关键字.内容 + "' or [电话]='" + 编辑框_关键字.内容 + "' or [备注]='" + 编辑框_关键字.内容 + "'"
                    方法_显示客户列表 (局部_SQL语句)
                    调试输出 (局部_SQL语句)
                }
                否则
                {
                    局部_SQL语句 = "select * from [客户] where  [客户名称] like '%" + 编辑框_关键字.内容 + "%' or [联系人] like '%" + 编辑框_关键字.内容 + "%' or [电话] like '%" + 编辑框_关键字.内容 + "%' or [备注] like '%" + 编辑框_关键字.内容 + "%'"
                    方法_显示客户列表 (局部_SQL语句)
                    调试输出 (局部_SQL语句)

                    // 324212321324
                }



            }


        }


        返回 (0)
    }
}

类 类_表格行布局 <基础类 = 组件布局器 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1008, 38\"" 底色 = 0xFFFFFF>
{
    变量 外形框2 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"0, 0, 1004, 38\"" 线条颜色 = 0xC0C0C0
            背景颜色 = 0xFFFFFF 外形 = 矩形 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 标签_客户名称 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 102\r\nparent_id = 101\r\npos = \"33, 2, 198, 33\"" 字体 = "微软雅黑, 14, 0, 0, 0, 0, 0"
            背景颜色 = 0xFFFFFF 横向对齐方式 = 左边 组件边框 = 无边框>
    变量 标签_联系人 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 103\r\nparent_id = 101\r\npos = \"256, 2, 144, 33\"" 字体 = "微软雅黑, 14, 0, 0, 0, 0, 0"
            背景颜色 = 0xFFFFFF 横向对齐方式 = 左边 组件边框 = 无边框>
    变量 标签_电话 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 104\r\nparent_id = 101\r\npos = \"412, 2, 155, 33\"" 字体 = "微软雅黑, 14, 0, 0, 0, 0, 0"
            背景颜色 = 0xFFFFFF 横向对齐方式 = 左边 组件边框 = 无边框>
    变量 标签_合同起始 <公开 类型 = 标签 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 105\r\nparent_id = 101\r\npos = \"583, 2, 144, 33\"" 字体 = "微软雅黑, 14, 0, 0, 0, 0, 0"
            背景颜色 = 0xFFFFFF 横向对齐方式 = 左边 组件边框 = 无边框>
    变量 外形框3 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\nparent_id = 101\r\npos = \"246, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 外形框4 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\nparent_id = 101\r\npos = \"408, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 外形框5 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\nparent_id = 101\r\npos = \"575, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>
    变量 选择框_选择 <公开 类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\nparent_id = 101\r\npos = \"6, 3, 22, 31\""
            选中 = 真 组件边框 = 无边框 背景颜色 = 0xFFFFFF>
    变量 外形框1 <类型 = 外形框 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\nparent_id = 101\r\npos = \"744, 2, 198, 34\""
            线条颜色 = 0xFFFFFF 背景颜色 = 0xFFFFFF>
    变量 超级按钮_修改 <公开 类型 = 超级按钮 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 111\r\nparent_id = 110\r\npos = \"5, 3, 50, 28\"" 标题 = "修改" 使用默认色 = 假 通常前景色 = 0xFFFFFF
            通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF 焦点前景色 = 0x00D8D8
            字体 = "微软雅黑, 14, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <公开 类型 = 超级按钮 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 112\r\nparent_id = 110\r\npos = \"70, 3, 50, 28\"" 标题 = "删除" 使用默认色 = 假
            通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF 焦点前景色 = 0x00D8D8
            字体 = "微软雅黑, 14, 0, 0, 0, 0, 0">
    变量 超级按钮_名片 <公开 类型 = 超级按钮 折叠2 隐藏值属性 = "0"
            @视窗.布局 = "id = 113\r\nparent_id = 110\r\npos = \"134, 3, 50, 28\"" 标题 = "名片" 使用默认色 = 假
            通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF 焦点前景色 = 0x00D8D8
            字体 = "微软雅黑, 14, 0, 0, 0, 0, 0">
    变量 外形框6 <类型 = 外形框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\nparent_id = 101\r\npos = \"740, 1, 1, 40\""
            线条颜色 = 0xC0C0C0 背景颜色 = 0xFFFFFF 外形 = 纵向线 线型 = 直线 组件边框 = 无边框 线宽 = 1>

    #

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // 信息框 (来源对象.标记, , )
        返回 (0)
    }
}

类 类_客户信息 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"645, 459\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"365, 391, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"181, 391, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_进货折扣 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"124, 120, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"21, 12, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "客户名称">
    变量 编辑框_联系人 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"124, 66, 200, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"21, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "联系人">
    变量 编辑框_电话 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"437, 66, 192, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签3 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"333, 66, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "电话">
    变量 编辑框_备注 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"124, 231, 505, 104\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"333, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "客户LOGO">
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"21, 174, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合同起始">
    变量 日期框_合同起始 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"124, 174, 184, 32\"">
    变量 标签6 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"333, 174, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合同终止">
    变量 日期框_合同终止 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"445, 174, 184, 32\"">
    变量 选择框_是否合作 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"124, 351, 112, 32\"" 标题 = "是否合作"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_客户名称 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"124, 12, 505, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"21, 120, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "进货折扣">
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"21, 231, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "备注">
    变量 图片框1 <类型 = 图片框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 119\r\npos = \"445, 103, 61, 61\"" 组件边框 = 单线边框式
            显示方式 = 图片居中>
    变量 成员_图片数据 <类型 = 字节集类>

    #

    方法 类_客户信息_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_客户信息 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // 如果真 (类_供应商管理.成员_当前状态 == "修改")
        {
            // 编辑框_供应商名称.标记 = 到文本 (取程序 ().窗口_供应商管理.超级列表框_显示.取表项数值 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项))
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_联系人.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 1)
            // 编辑框_电话.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 2)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)
            // 编辑框_供应商名称.内容 = 取程序 ().窗口_供应商管理.超级列表框_显示.取标题 (取程序 ().窗口_供应商管理.超级列表框_显示.现行选中项, 0)





        }


        返回 (0)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_保存)
        {


            如果 (取程序 ().窗口_客户管理.成员_当前状态 == "添加")
            {

                变量 局部_记录集 <类型 = 记录集类>
                如果真 (局部_记录集.从已有连接打开 ("客户", 取程序 ().数据库_全局ACCESS库, , , 记录集编辑锁类型.开放式锁定, ) == 假)
                {
                    信息框 ("打开失败", , )
                    返回 (0)
                }
                局部_记录集.添加空记录 ()
                局部_记录集.写文本数据 ("客户名称", 编辑框_客户名称.内容)
                局部_记录集.写文本数据 ("联系人", 编辑框_联系人.内容)
                局部_记录集.写文本数据 ("合同起始", 时间到文本 (日期框_合同起始.今天, 时间转换部分.日期部分, ))
                局部_记录集.写逻辑型数据 ("是否合作", 选择框_是否合作.选中)
                局部_记录集.写字节集数据 ("客户LOGO", 成员_图片数据)
                如果真 (局部_记录集.更新 (, ) == 假)
                {
                    信息框 ("添加失败", , )


                }

                局部_记录集.关闭 ()
            }



        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }

    方法 图片框_被双击 <接收事件 类型 = 整数 注释 = "当鼠标左键被双击时事件被触发" 返回值注释 = "本事件的处理方法如果返回非0整数值,表明事件已经得到处理且不再需要后续处理.">
    参数 来源对象 <类型 = 图片框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 横向位置 <类型 = 整数 注释 = "事件触发时的鼠标横向坐标位置,相对所处用户区的左边.">
    参数 纵向位置 <类型 = 整数 注释 = "事件触发时的鼠标纵向坐标位置,相对所处用户区的顶边.">
    参数 辅助键状态 <类型 = 整数 注释 = "事件触发时的辅助键组合状态,为\"辅助键状态\"类中各常量值的组合.">
    {
        如果 (来源对象 == 图片框1)
        {
            变量 局部_对话框 <类型 = 通用对话框>
            局部_对话框.类型 = 通用对话框类型.打开文件
            // 局部_对话框.过滤器
            如果真 (局部_对话框.打开 (本对象) == 假)
            {
                返回 (0)

            }
            成员_图片数据 = 读入文件 (局部_对话框.文件名, )
            图片框1.置底图数据 (成员_图片数据)


        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.无名.菜鸟驿站 <注释 = "火山菜鸟驿站：http://www.vowm.cn">

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数 注释 = "火山菜鸟驿站：http://www.vowm.cn">
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "火山菜鸟驿站：http://www.vowm.cn" 标题 = "文件枚举测试" @视窗.布局 = "client_size = \"594, 282\"">
{
    变量 按钮1 <类型 = 按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"13, 14, 112, 40\"" 标题 = "文件枚举">
    变量 编辑框1 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"141, 14, 424, 240\"" 是否允许多行 = 真 滚动条 = 纵向滚动条
            字体 = "Arial Narrow, 12, 0, 0, 0, 0, 0">

    方法 按钮_被单击 <接收事件 类型 = 整数 注释 = "火山菜鸟驿站：http://www.vowm.cn">
    参数 来源对象 <类型 = 按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 按钮1)
        {
            变量 目录 <类型 = 文本型>
            目录 = 浏览文件夹 ("选择要枚举文件的目录")
            如果 (目录 != "")
            {
                变量 文本数组 <类型 = 文本数组类>
                文本数组 = 文件枚举 (目录)
                计次循环 (文本数组.取成员数 ())
                {
                    编辑框1.加入文本行 (文本数组.取成员 (取循环索引 ()))
                }
            }
        }
        返回 (0)
    }

    方法 文件枚举 <类型 = 文本数组类 注释 = "火山菜鸟驿站：http://www.vowm.cn" 返回值注释 = "枚举某个文件夹下的所有文件和文件夹。">
    参数 要枚举的目录 <类型 = 文本型>
    参数 是否包含目录枚举 <类型 = 逻辑型 @默认值 = 真>
    参数 是否包含路径 <类型 = 逻辑型 @默认值 = 真>
    {
        如果 (是否以文本结束 (要枚举的目录, "\\") == 假)
        {
            要枚举的目录 = 要枚举的目录 + "\\"
        }
        变量 结果数组 <类型 = 文本数组类>
        变量 文件查找 <类型 = 文件查找类>
        变量 临时文本 <类型 = 文本型>
        临时文本 = 文件查找.寻找文件 (要枚举的目录 + "*.*", 选择 (是否包含目录枚举, 文件属性.子目录 + 文件属性.存档文件, -1))
        判断循环 (文本是否为空 (临时文本) == 假)
        {
            结果数组.加入成员 (选择 (是否包含路径, 要枚举的目录 + 临时文本, 临时文本))
            临时文本 = 文件查找.寻找文件 ("", 选择 (是否包含目录枚举, 文件属性.子目录 + 文件属性.存档文件, -1))
        }
        返回 (结果数组)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 动态库程序类>
{
    变量 数据库_全局Mysql库 <公开 类型 = Mysql数据库类>
    变量 窗口_权限管理 <公开 类型 = 类_权限管理>

    方法 启动方法 <公开 类型 = 整数>
    {
        返回 (1)
    }
}

类 部件类_权限管理 <公开 注释 = "在部件DLL中,所有公开类中的公开方法均会被输出,具体请阅读用户开发手册中的相关内容.">
{
    方法 外部接口_权限管理 <公开 静态>
    参数 参数_Mysql数据库 <类型 = Mysql数据库类>
    {
        取程序 ().数据库_全局Mysql库 = 参数_Mysql数据库
        取程序 ().窗口_权限管理.创建主窗口 (, , , , )


    }
}

类 类_权限管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 740\"" 底色 = 0xFFFFFF>
{
    变量 树形框_权限列表 <类型 = 树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"413, 23, 600, 640\""
            字体 = ", 14, 0, 0, 0, 0, 0" 显示根部线 = 真 显示连线 = 真 显示加减框 = 真 是否有检查框 = 真
            图片组 = "..\\..\\相关素材\\col_icons.png">
    变量 ""
    变量 超级列表框_管理员列表 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"13, 23, 384, 640\""
            "类型" = 报表列表框 报表列 = "0\n-1\n0\n160\n管理员名称\n0\n-1\n0\n200\n管理员密码" 整行选择 = 真 显示表格线 = 真
            字体 = ", 12, 0, 0, 0, 0, 0" 始终显示选择项 = 真>
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"589, 687, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"331, 687, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 ""
    变量 "//窗口_商品信息" <公开 类型 = 类_商品信息>

    方法 类_权限管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_权限管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        方法_管理员列表 ()


        // 方法_显示权限 (树形框_权限列表, -1)
        // 树形框_权限列表.扩展 (0)

        返回 (0)
    }

    方法 方法_管理员列表
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_位置 <类型 = 整数>
        变量 局部_语句 <类型 = 文本型>
        局部_语句 = "SELECT  *  FROM `gly` "
        调试输出 (局部_语句)
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        超级列表框_管理员列表.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_管理员列表.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_管理员列表.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("用户名"))
            超级列表框_管理员列表.置标题 (局部_位置, 1, 取重复文本 ("*", 取文本长度 (局部_记录集.读文本数据 ("密码"))))

        }
        局部_记录集.关闭 ()


    }

    方法 方法_显示权限
    参数 参数_树型框 <类型 = 树形框>
    参数 参数_当前权限 <类型 = 文本型>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_语句 <类型 = 文本型>
        变量 局部_树型框数据文本 <类型 = 文本型>
        变量 局部_层次 <类型 = 整数>
        变量 局部_文本数组 <类型 = 文本数组类>
        局部_语句 = "SELECT * FROM `qxb` ORDER BY `权限编号` ASC "
        调试输出 (局部_语句)
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            // 顶层\n0\n-1\n0\n0\n1\n0\n1\n
            // 顶层\n2\n2\n ID\n0\n展开\n2\n层次
            局部_层次 = 分割文本 (局部_记录集.读文本数据 ("权限编号"), ".", 局部_文本数组, , )
            如果 (局部_记录集.行数 - 1 != 取循环索引 ())
            {
                如果 (寻找文本 (参数_当前权限, "," + 局部_记录集.读文本数据 ("权限编号") + ",", , ) != -1)
                {
                    局部_树型框数据文本 = 局部_树型框数据文本 + "(" + 局部_记录集.读文本数据 ("权限编号") + ")" + 局部_记录集.读文本数据 ("权限名") + "\n2\n2\n" + 到文本 (局部_记录集.读整数数据 ("ID")) + "\n0\n1\n1" + "\n" + 到文本 (局部_层次) + "\n"
                }
                否则
                {
                    局部_树型框数据文本 = 局部_树型框数据文本 + "(" + 局部_记录集.读文本数据 ("权限编号") + ")" + 局部_记录集.读文本数据 ("权限名") + "\n2\n2\n" + 到文本 (局部_记录集.读整数数据 ("ID")) + "\n0\n1\n0" + "\n" + 到文本 (局部_层次) + "\n"

                }

            }
            否则
            {
                如果 (寻找文本 (参数_当前权限, "," + 局部_记录集.读文本数据 ("权限编号") + ",", , ) != -1)
                {
                    局部_树型框数据文本 = 局部_树型框数据文本 + "(" + 局部_记录集.读文本数据 ("权限编号") + ")" + 局部_记录集.读文本数据 ("权限名") + "\n2\n2\n" + 到文本 (局部_记录集.读整数数据 ("ID")) + "\n0\n1\n1" + "\n" + 到文本 (局部_层次)
                }
                否则
                {
                    局部_树型框数据文本 = 局部_树型框数据文本 + "(" + 局部_记录集.读文本数据 ("权限编号") + ")" + 局部_记录集.读文本数据 ("权限名") + "\n2\n2\n" + 到文本 (局部_记录集.读整数数据 ("ID")) + "\n0\n1\n0" + "\n" + 到文本 (局部_层次)


                }

            }
        }
        局部_记录集.关闭 ()
        // 信息框 (局部_树型框数据文本, , )
        参数_树型框.项目 = 局部_树型框数据文本


        返回




    }

    方法 超级列表框_左键单击表项 <接收事件 类型 = 整数 注释 = "  当用鼠标左键单击某表项时即产生此事件,接收到此事件后读取" 注释 = "\"现行选中项\"属性即可获得被单击表项的索引.">
    参数 来源对象 <类型 = 超级列表框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级列表框_管理员列表)
        {

            变量 局部_当前权限 <类型 = 文本型>
            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "SELECT  *  FROM `gly` where `ID`=" + 到文本 (超级列表框_管理员列表.取表项数值 (超级列表框_管理员列表.现行选中项))
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            如果真 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                局部_当前权限 = 局部_记录集.读文本数据 ("权限")
            }

            局部_记录集.关闭 ()
            方法_显示权限 (树形框_权限列表, 局部_当前权限)
        }
        返回 (0)

    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        否则 (来源对象 == 超级按钮_保存)
        {
            变量 局部_当前权限 <类型 = 文本型>
            局部_当前权限 = ","
            变量 局部_文本 <类型 = 文本型>

            计次循环 (树形框_权限列表.取项目数 ())
            {
                如果真 (树形框_权限列表.取检查框状态 (取循环索引 ()) == 1)
                {
                    局部_文本 = 树形框_权限列表.取项目文本 (取循环索引 ())
                    局部_当前权限 = 局部_当前权限 + 取文本中间 (局部_文本, 1, 寻找文本 (局部_文本, ")", , ) - 1) + ","

                }
                // (1000)测试

            }
            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "update `gly` set  `权限`= '" + 局部_当前权限 + "' where `ID`=" + 到文本 (超级列表框_管理员列表.取表项数值 (超级列表框_管理员列表.现行选中项))
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("保存权限失败", 信息框按钮.错误图标, )
                返回 (0)
            }
            信息框 ("保存权限成功", 信息框按钮.信息图标, )
            返回 (0)




        }
        返回 (0)
    }

    方法 树形框_检查框状态被改变 <接收事件 类型 = 整数 注释 = "  当用户操作(如被鼠标单击或按下键盘空格键)导致检查框选中状态被改变时"
            注释 = "产生此事件. 仅在属性\"是否有检查框\"值为真的情况下才可能产生此事件.通" 注释 = "过代码设置检查框状态不会触发此事件.">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 表项索引 <类型 = 整数 注释 = "提供其检查框状态发生变化的表项索引,从0开始.">
    参数 检查框状态 <类型 = 整数 注释 = "0:未选中; 1:选中; 2:半选中">
    {
        如果 (来源对象 == 树形框_权限列表)
        {

            如果真 (树形框_权限列表.取检查框状态 (表项索引) == 1)
            {
                变量 局部_上层项目 <类型 = 整数>
                局部_上层项目 = 树形框_权限列表.取父项目 (表项索引)
                树形框_权限列表.置检查框状态 (局部_上层项目, 1, 假)
                判断循环 (局部_上层项目 != -1)
                {
                    局部_上层项目 = 树形框_权限列表.取父项目 (局部_上层项目)
                    树形框_权限列表.置检查框状态 (局部_上层项目, 1, 假)


                }

            }

        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

# ===

类 我的主窗口 <基础类 = 窗口 注释 = "样例主窗口" @视窗.布局 = "client_size = \"968, 572\"" 标题 = "我的主窗口">
{
    常量 常量_版本号 <类型 = 小数 值 = 1.0>

    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"228, 218, 512, 136\""
            字体 = ", 36, 0, 0, 0, 0, 0" 标题 = "当前版本号：V1.0" 横向对齐方式 = 居中>

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 我的主窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 "// 局部_JSON文本1" <类型 = 文本型
                值 = "{\r\n \"文件列表\" : \r\n [\r\n  {\r\n   \"MD5\" : \"1082CFA81392E573E7BD0BB9424AB221\",\r\n   \"保存文件名\" : \"upload/202207310213061964.rar\",\r\n   \"原始文件名\" : \"Ry4S.dll\",\r\n   \"文件大小\" : \"36239\",\r\n   \"本地路径\" : \"Ry4S.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"64C58EB4B1680C6DE8DC813EE6DBB1B8\",\r\n   \"保存文件名\" : \"upload/202207310213061774.rar\",\r\n   \"原始文件名\" : \"SCDLL32.dll\",\r\n   \"文件大小\" : \"46418\",\r\n   \"本地路径\" : \"SCDLL32.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"897714613082E421EE99BDC73AB58E28\",\r\n   \"保存文件名\" : \"upload/202207310213067767.rar\",\r\n   \"原始文件名\" : \"登录信息.ini\",\r\n   \"文件大小\" : \"167\",\r\n   \"本地路径\" : \"登录信息.ini\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D17911719FEA56172E7C0A363906742D\",\r\n   \"保存文件名\" : \"upload/202207310213069163.rar\",\r\n   \"原始文件名\" : \"简易进销存.exe\",\r\n   \"文件大小\" : \"175677\",\r\n   \"本地路径\" : \"简易进销存.exe\"\r\n  },\r\n  {\r\n   \"MD5\" : \"497436889DCC07258B7AD2D605020720\",\r\n   \"保存文件名\" : \"upload/202207310213076438.rar\",\r\n   \"原始文件名\" : \"grmysql6.dll\",\r\n   \"文件大小\" : \"840469\",\r\n   \"本地路径\" : \"插件目录\\\\grmysql6.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"8690644B0CF6C751CA3F841373BDD4CC\",\r\n   \"保存文件名\" : \"upload/202207310213079455.rar\",\r\n   \"原始文件名\" : \"供应商管理.dll\",\r\n   \"文件大小\" : \"1071715\",\r\n   \"本地路径\" : \"插件目录\\\\供应商管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"0E1A82249BF2138423066F85D38C5A97\",\r\n   \"保存文件名\" : \"upload/202207310213071418.rar\",\r\n   \"原始文件名\" : \"客户管理.dll\",\r\n   \"文件大小\" : \"884430\",\r\n   \"本地路径\" : \"插件目录\\\\客户管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"D44436595BE63C566108A9C2509D7CC0\",\r\n   \"保存文件名\" : \"upload/202207310213075963.rar\",\r\n   \"原始文件名\" : \"进货管理.dll\",\r\n   \"文件大小\" : \"790515\",\r\n   \"本地路径\" : \"插件目录\\\\进货管理.dll\"\r\n  },\r\n  {\r\n   \"MD5\" : \"BAE460E44E852657714FE91070C368E4\",\r\n   \"保存文件名\" : \"upload/202207310213066928.rar\",\r\n   \"原始文件名\" : \"简易进销存.accdb\",\r\n   \"文件大小\" : \"38450\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.accdb\"\r\n  },\r\n  {\r\n   \"MD5\" : \"FB4724ACBBD7E918815A3BD01FA7BE9F\",\r\n   \"保存文件名\" : \"upload/202207310213061124.rar\",\r\n   \"原始文件名\" : \"简易进销存.mdb\",\r\n   \"文件大小\" : \"29970\",\r\n   \"本地路径\" : \"数据目录\\\\简易进销存.mdb\"\r\n  }\r\n ],\r\n \"文件数\" : 10,\r\n \"更新时间\" : \"2022年7月31日2时12分13秒\",\r\n \"根部网址\" : \"http://zwbcwang.h902.000pc.net/update/\",\r\n \"版本号\" : \"1.1\",\r\n\"更新内容\": \"1、主程序界面修改；\\r\\n2、数据库结构调整；\\r\\n3、主要是测试在线升级。\",\r\n \"版本名称\" : \"V1.1\"\r\n}">
        变量 "// 局部_加密后字节集" <类型 = 字节集类>
        变量 "// 局部_解密后字节集" <类型 = 字节集类>
        // 局部_加密后字节集 = 加解密类.加密_RC4 (文本到UTF8 (局部_JSON文本1, ), "12345abc67890def")
        // 局部_解密后字节集 = 加解密类.解密_RC4 (局部_加密后字节集, "12345abc67890def")
        // 写到文件 (取当前目录 () + "\\update.json", 局部_加密后字节集, )
        // 写到文件 (取当前目录 () + "\\update_ok.json", 局部_解密后字节集, )
        // 返回 (0)






        标签1.标题 = "当前版本号：V" + 到文本 (数值到格式文本 (常量_版本号, 1, ))
        变量 局部_JSON文本 <类型 = 文本型
                值 = "{\"文件数\":3,\"版本名称\":\"V1.1\",\"版本号\":\"1.1\",\"根部网址\":\"http://zwbcwang.h902.000pc.net/\",\"更新时间\":\"2022-07-29 23:11:29\",\"更新内容\":\"1、主程序界面修改；\\r\\n2、数据库结构调整；\\r\\n3、主要是测试在线升级。\",\"文件列表\":[{\"原始文件名\":\"简易进销存.exe\",\"本地路径\":\"简易进销存.exe\",\"保存文件名\":\"upload/202207292236447545.rar\",\"文件大小\":\"8034K\",\"MD5\":\"c4ca4238a0b923820dcc509a6f75849b\"},{\"原始文件名\":\"权限管理.dll\",\"本地路径\":\"插件目录\\\\权限管理.dll\",\"保存文件名\":\"upload/20220729223324333.rar\",\"文件大小\":\"3432K\",\"MD5\":\"56ca4238a0b92382sscc509a6f7585gh\"},{\"原始文件名\":\"进货管理.dll\",\"本地路径\":\"插件目录\\\\进货管理.dll\",\"保存文件名\":\"upload/20220729223378905.rar\",\"文件大小\":\"6422K\",\"MD5\":\"67ka4238a0b92382sscc509a6f7545ho\"}]}">
        变量 局部_网络访问 <类型 = 网络访问类>
        变量 局部_响应 <类型 = 网页访问响应类>
        变量 局部_解密后字节集 <类型 = 字节集类>
        局部_响应 = 局部_网络访问.网页访问 ("http://zwbcwang.h902.000pc.net/update/update.json", , , , , , , , , , , )
        局部_解密后字节集 = 加解密类.解密_RC4 (局部_响应.请求结果, "12345abc67890def")
        局部_JSON文本 = UTF8到文本 (局部_解密后字节集)
        调试输出 (局部_JSON文本)
        变量 局部_JSON对象 <类型 = JSON对象类>
        变量 局部_JSON数组 <类型 = JSON数组类>
        变量 局部_JSON数组内对象 <类型 = JSON对象类>
        变量 局部_键名组 <类型 = 文本数组类>
        变量 局部_索引 <类型 = 整数>
        局部_JSON对象.创建自文本 (局部_JSON文本)

        调试输出 (文本到小数 (局部_JSON对象.取文本值 ("版本号")))

        // 信息框 (局部_JSON对象.取文本值 ("更新内容"))

        如果真 (文本到小数 (局部_JSON对象.取文本值 ("版本号")) > 常量_版本号)
        {
            如果真 (信息框 ("发现文件有更新，是否现在更新？\r\n更新内容：\r\n" + 局部_JSON对象.取文本值 ("更新内容"), 信息框按钮.是否钮 + 信息框按钮.询问图标, ) == 返回按钮类型.是钮)
            {
                运行 (取当前目录 () + "\\在线更新.exe", , )
                结束 ()

            }

        }


        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 程序类>
{
    变量 主窗口 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        炫彩_初始化 ()  // 炫彩三部曲中的第一部->初始化UI库,参数1默认为空,即为:假=GDI+渲染,否则:真=D2D渲染
        // 炫彩界面\炫彩系统配置
        炫彩_添加搜索路径 (取当前目录 () + "\\..\\炫彩界面\\炫彩系统配置")
        // 炫彩_添加搜索路径 ("E:\\火山\\炫彩基础示例\\第18例与设计器交互\\与火山PC模块交互")
        // 如xml文件不在当前目录,需添加搜索路径
        主窗口.创建 (, )


        炫彩_运行 ()  // 炫彩三部曲中的第二部->运行UI库
        炫彩_退出 ()  // 炫彩三部曲中的第三部->退出UI库
        返回 (0)
    }
}

类 我的主窗口 <基础类 = 炫彩可设计类 隐藏值属性 = "0"
        @设计内容 = "\"main.xml\",炫彩窗口_系统设置窗口,炫彩编辑框_宽度,炫彩单选框_窗口最大化,炫彩单选框_按照上次设置,炫彩单选框_固定设置,炫彩编辑框_高度,炫彩选择框_子窗口嵌入主窗口,炫彩选择框_不显示欢迎窗口,炫彩选择框_按下ESC键关闭窗口,炫彩选择框_记录上次登录的用户名,炫彩选择框_记录上次登录的用户密码,炫彩选择框_使用ACCESS数据库,炫彩选择框_使用Mysql数据库,炫彩按钮_保存,炫彩按钮_关闭">
{
    变量 炫彩窗口_系统设置窗口 <公开 类型 = xc.gui.普通窗口 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩编辑框_宽度 <公开 类型 = xc.gui.炫彩编辑框 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩单选框_窗口最大化 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩单选框_按照上次设置 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩单选框_固定设置 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩编辑框_高度 <公开 类型 = xc.gui.炫彩编辑框 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_子窗口嵌入主窗口 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_不显示欢迎窗口 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_按下ESC键关闭窗口 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_记录上次登录的用户名 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_记录上次登录的用户密码 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_使用ACCESS数据库 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩选择框_使用Mysql数据库 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩按钮_保存 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">
    变量 炫彩按钮_关闭 <公开 类型 = xc.gui.炫彩按钮 注释 = "炫彩设计器生成,请勿手动修改" @自动生成 = "炫彩界面库">

    方法 创建完成 <公开 注释 = "窗口或布局创建完成" @虚拟方法 = 可覆盖>
    {
        炫彩窗口_系统设置窗口.显示 ()  // 记得调用对象.显示()方法
        // 备注:一定要先打开炫彩设计器,在来火山PC右键打开
        // 在设计器设计好后,可点击保存(或右键同步到火山PC)即可
        // 如需在编辑设计器,需在从火山PC右键打开.不能直接win状态跳转到设计器.多次也一样----切记
        变量 局部_当前管理员 <类型 = 文本型>
        局部_当前管理员 = "超级管理员"
        局部_当前管理员 = "小张"
        局部_当前管理员 = "小王"
        // 局部_登录次数 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "登录次数", ))
        炫彩单选框_窗口最大化.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "窗口最大化", ) == "1")
        炫彩单选框_按照上次设置.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按照上次设置", ) == "1")
        炫彩单选框_固定设置.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "固定设置", ) == "1")
        炫彩编辑框_宽度.文本 = 读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "宽度", )
        炫彩编辑框_高度.文本 = 读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "高度", )
        炫彩选择框_子窗口嵌入主窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "子窗口嵌入主窗口", ) == "1")
        炫彩选择框_不显示欢迎窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "不显示欢迎窗口", ) == "1")
        炫彩选择框_按下ESC键关闭窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按下ESC键关闭窗口", ) == "1")
        炫彩选择框_记录上次登录的用户名.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户名", ) == "1")
        炫彩选择框_记录上次登录的用户密码.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户密码", ) == "1")

    }

    方法 炫彩按钮_按钮_点击 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 炫彩按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 按钮句柄 <类型 = 变整数>
    参数 是否拦截 <类型 = 逻辑型类 注释 = "是否拦截.值=真">
    {
        如果 (来源对象 == 炫彩按钮_保存)
        {
            变量 局部_当前管理员 <类型 = 文本型>
            变量 局部_登录次数 <类型 = 整数>
            局部_当前管理员 = "超级管理员"
            局部_当前管理员 = "小张"
            // 局部_当前管理员 = "小王"
            // 局部_登录次数 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "登录次数", ))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "窗口最大化", 选择 (炫彩单选框_窗口最大化.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按照上次设置", 选择 (炫彩单选框_按照上次设置.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "固定设置", 选择 (炫彩单选框_固定设置.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "宽度", 炫彩编辑框_宽度.文本)
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "高度", 炫彩编辑框_高度.文本)
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "子窗口嵌入主窗口", 选择 (炫彩选择框_子窗口嵌入主窗口.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "不显示欢迎窗口", 选择 (炫彩选择框_不显示欢迎窗口.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按下ESC键关闭窗口", 选择 (炫彩选择框_按下ESC键关闭窗口.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "子窗口嵌入主窗口", 选择 (炫彩选择框_子窗口嵌入主窗口.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户名", 选择 (炫彩选择框_记录上次登录的用户名.是否选中 (), "1", "0"))
            写配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户密码", 选择 (炫彩选择框_记录上次登录的用户密码.是否选中 (), "1", "0"))
            炫彩按钮_保存.启用 (假)

        }
        否则 (来源对象 == 炫彩按钮_关闭)
        {
            炫彩窗口_系统设置窗口.关闭 ()

        }
        返回 (0)
    }

    方法 普通窗口_窗口_绘制完成并已显示 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 普通窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 窗口句柄 <类型 = 变整数>
    参数 是否拦截 <类型 = 逻辑型类 注释 = "是否拦截.值=真">
    {
        如果 (来源对象 == 炫彩窗口_系统设置窗口)
        {
            变量 "// 局部_当前管理员" <类型 = 文本型>
            // 局部_当前管理员 = "超级管理员"
            // 局部_当前管理员 = "小张"
            // 局部_当前管理员 = "小王"
            // // 局部_登录次数 = 文本到整数 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "登录次数", ))
            // 炫彩单选框_窗口最大化.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "窗口最大化", ) == "1")
            // 炫彩单选框_固定设置.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "固定设置", ) == "1")
            // 炫彩单选框_按照上次设置.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按照上次设置", ) == "1")
            // 炫彩编辑框_宽度.文本 = 读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "宽度", )
            // 炫彩编辑框_高度.文本 = 读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "高度", )
            // 炫彩选择框_子窗口嵌入主窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "子窗口嵌入主窗口", ) == "1")
            // 炫彩选择框_不显示欢迎窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "不显示欢迎窗口", ) == "1")
            // 炫彩选择框_按下ESC键关闭窗口.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "按下ESC键关闭窗口", ) == "1")
            // 炫彩选择框_记录上次登录的用户名.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户名", ) == "1")
            // 炫彩选择框_记录上次登录的用户密码.置选中 (读配置项 (取运行目录 () + "登录信息.ini", 局部_当前管理员, "记录上次登录的用户密码", ) == "1")


        }
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 启动类 <公开 基础类 = 窗口程序类>
{
    方法 启动方法 <公开 类型 = 整数>
    {
        调试输出 (类_进制转换.方法_十进制转二进制 (210))
        调试输出 (类_进制转换.方法_二进制转十进制 ("11010010"))
        // 调试输出 (类_进制转换.方法_十进制转二进制 (123))
        调试输出 (类_进制转换.方法_十六进制转十进制 ("D2"))
        调试输出 (类_进制转换.方法_十进制转十六进制 (210))
        调试输出 (类_进制转换.方法_十六进制转二进制 ("D2"))
        调试输出 (类_进制转换.方法_二进制转十六进制 ("11010010"))
        调试输出 (类_进制转换.方法_十进制转十六进制 (1234567890))
        // 499602D2
        调试输出 (类_进制转换.方法_十六进制转十进制 ("499602D2"))
        // 调试输出 (123)
        @ ::MessageBox(NULL,L"我是C++代码信息框",L"我是标题",MB_OK);

        调试输出 (二进制转十进制 ("11010010"))
        调试输出 (世恒_二进制转十进制 ("11010010"))
        // 到文本 ()
        // 飞天加密狗操作 (, , , , , , , , )

        // 二进制转十六进制
        变量 局部_Word程序 <类型 = Word程序>
        变量 局部_Word文档集 <类型 = Word文档集>
        变量 局部_Word文档 <类型 = Word文档>
        如果真 (局部_Word程序.获取 () == 假)
        {
            局部_Word程序.创建 ()

        }
        局部_Word程序.可视 = 真
        局部_Word文档集 = 局部_Word程序.文档集
        局部_Word文档 = 局部_Word文档集.添加新文档 ()
        局部_Word文档集.输入文字 ("测试一下666")


        返回 (1)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容 - 访问本程序中的接口需要引用模块"世恒封装的类库".

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 Word程序 <公开>
{
    变量 Word程序变量 <类型 = COM对象类>

    方法 获取 <公开 类型 = 逻辑型>
    {
        返回 (Word程序变量.获取 ("word.Application"))
    }

    方法 创建 <公开 类型 = 逻辑型>
    {
        返回 (Word程序变量.创建 ("word.Application", ""))



        // 如果真 (成员_程序对象.获取 ("word.Application") == 假)
        {
            // 如果真 (成员_程序对象.创建 ("word.Application", ) == 假)
            {
                // 信息框 ("创建文档对象失败", , )
                // 返回 (0)
            }

        }
        // 成员_程序对象.写属性 ("visible", 真)
        // // 成员_文档对象.获取 ("", )
        // 成员_文档对象集 = 成员_程序对象.读无参数对象型属性 ("Documents", COM对象类)
        // // 成员_文档对象 = 成员_文档对象集.读对象型属性 ("item", COM对象类, 1)
        // 成员_文档对象 = 成员_文档对象集.读无参数对象型属性 ("Add", COM对象类)

    }

    方法 可视 <公开 属性读 类型 = 逻辑型>
    {
        返回 (Word程序变量.读无参数属性 ("visible", 逻辑型))
    }

    方法 可视 <公开 属性写>
    参数 是否可视 <类型 = 逻辑型>
    {
        Word程序变量.写属性 ("visible", 是否可视)


    }

    方法 文档集 <公开 属性读 类型 = Word文档集>
    {
        变量 局部_Word文档集 <类型 = Word文档集>
        局部_Word文档集.置程序 (Word程序变量)
        局部_Word文档集.置文档集 (Word程序变量.读无参数对象型属性 ("Documents", COM对象类))
        返回 (局部_Word文档集)



    }

    # 如果真 (成员_程序对象.获取 ("word.Application") == 假)
    # 成员_程序对象.写属性 ("visible", 真)
    # // 成员_文档对象.获取 ("", )
    # 成员_文档对象集 = 成员_程序对象.读无参数对象型属性 ("Documents", COM对象类)
    # // 成员_文档对象 = 成员_文档对象集.读对象型属性 ("item", COM对象类, 1)
    # 成员_文档对象 = 成员_文档对象集.读无参数对象型属性 ("Add", COM对象类)
    #
}

类 Word文档集 <公开>
{
    变量 Word文档集变量 <类型 = COM对象类>
    变量 Word程序 <类型 = COM对象类>

    方法 置文档集 <公开>
    参数 文档集 <类型 = COM对象类>
    {
        Word文档集变量 = 文档集
    }

    方法 添加新文档 <公开 类型 = Word文档>
    {

        变量 局部_Word文档 <类型 = Word文档>
        局部_Word文档.置文档 (Word文档集变量.读无参数对象型属性 ("Add", COM对象类))
        返回 (局部_Word文档)
        变量 ""

    }

    方法 置程序 <公开>
    参数 word对象 <类型 = COM对象类>
    {
        Word程序 = word对象

    }

    方法 输入文字 <公开>
    参数 输入的文本 <类型 = 文本型>
    {
        Word程序.读无参数对象型属性 ("Selection", COM对象类).对象型方法 ("TypeText", COM对象类, 输入的文本)

        // Word文档变量.对象型方法 ("TypeText", COM对象类, 输入的文本)
    }
}

类 Word文档 <公开>
{
    变量 Word文档变量 <类型 = COM对象类>

    方法 置文档 <公开>
    参数 Word文档 <类型 = COM对象类>
    {
        Word文档变量 = Word文档
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容 - 访问本程序中的接口需要引用模块"世恒封装的类库".

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_磁卡操作 <公开 @视窗.附属文件 = "SCDLL32.dll">
{
    变量 成员_rHandle_COM句柄 <公开 静态 类型 = 整数>
    变量 成员_pSNR_序列号 <公开 静态 类型 = 字节集类>
    变量 成员_pSNR_序列号_文本 <公开 静态 类型 = 文本型>
    变量 成员_块数据 <公开 静态 类型 = 字节集类>

    方法 方法_打开串口 <公开 静态 类型 = 整数 注释 = "功能说明：此函数用来通过串口与读写器建立通讯链路。传输协议为：波特率为才57600bps，数据位为8 位，1个停止位，无奇偶校验位。"
            注释 = "                在调用其它函数功能前，一定要先进行串行口的联接。"
            注释 = "       函数原型：Function InitPort(Const iPort: Integer;Out rHandle:Thandle): Integer;StdCall;"
            注释 = " 参    数：port: 端口号1 到 9" 注释 = "                 rHandle： COM句柄"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe:=InitPort(1,rHandle);"
            @输出名 = "InitPort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_iPort_串口号 <类型 = 整数>
    参数 参数_rHandle_COM句柄 <类型 = 变整数>
    {

    }

    方法 方法_关闭串口 <公开 静态 类型 = 整数 注释 = "功能说明： 关闭串口"
            注释 = "       函数原型：Function ClosePort(Const Handle:THandle):integer;StdCall;"
            注释 = "       参    数：rHandle： 所要关闭COM的句柄" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe:=ClosePort(rHandle);" @输出名 = "ClosePort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {

    }

    方法 方法_寻找卡 <公开 静态 类型 = 整数 注释 = "  功能说明：查询感应区内是否有卡"
            注释 = "       函数原型：Function SC_Request(Const Handle:THandle ):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "       返 回 值： 返回值为：4表示8Kbit(1K字节)"
            注释 = "返回值为：2表示32Kbit(4K字节卡)" 注释 = "返回值为：1 表示无卡" 注释 = "       举    例：iRe := SC_Request(rHandle);"
            @输出名 = "SC_Request" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {
        // 返回值为:4表示8Kbit(1K字节)
        // 返回值为:2表示32Kbit(4K字节卡)
        // 返回值为:1 表示无卡

    }

    方法 方法_读卡序列号 <公开 静态 类型 = 整数 注释 = " 功能说明：读取卡片的4字节16进制序列号 使用此函数之前先调用 SC_Request()"
            注释 = "       函数原型：Function SC_GetSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节16进制的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：GetMem(pSNR,16);"
            注释 = "                 iRe:=SC_GetSnr(rHandle,pSNR);" @输出名 = "SC_GetSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_选择卡 <公开 静态 类型 = 整数 注释 = " 功能说明：选择要操作的卡 ，使用此函数之前先调用SC_GetSnr()"
            注释 = "       函数原型：Function SC_SelectSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。32Kbit(4k字节)的卡片返回1正确"
            注释 = "       举    例：iRe:=SC_SelectSnr(rHandle,pSNR);" @输出名 = "SC_SelectSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_核对秘钥 <公开 静态 类型 = 整数
            注释 = "功能说明：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "函数原型：Function SC_EncryptAuth (Const Handle:THandle;" 注释 = "iSector:integer;"
            注释 = "iMode:integer;pKey:Pchar):integer;stdcall;" 注释 = "参数：" 注释 = "rHandle：COM的句柄"
            注释 = "iSector：核对密钥的扇区号0~15" 注释 = "iMode：卡密钥的类型及A密钥60或B密钥61，通常使用A密钥60，"
            注释 = "pKey：卡密钥初始为12个FFFFFFFFFFFF" 注释 = "返回值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "举例：GetMem(pSNR,64);"
            注释 = "     iMode := 60;" 注释 = "     iSector := 0;" 注释 = "     pKey := Pchar(\'FFFFFFFFFFFF\');"
            注释 = "     iRe:= SC_EncryptAuth ( rHandle, iSector, iMode,pKey);" @输出名 = "SC_EncryptAuth"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iSector_扇区 <类型 = 整数>
    参数 参数_iMode_模式 <类型 = 整数 @默认值 = 60>
    参数 参数_pKey_秘钥 <类型 = 变整数>
    {

    }

    方法 方法_读块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：读卡一个块的16字节数据；"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENRead(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：存放读取的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： GetMem(pData,64);"
            注释 = "iBlock := 1;" 注释 = "iRe:= SC_RFRead(rHandle, iBlock, pData);" @输出名 = "SC_ENRead"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_写块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：写一个块数据，写入数据必须是16个字节的十六进制。"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENWrite(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：要写入的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： iBlock := 1;"
            注释 = "pData := Pchar(\'11223344556677889900AABBCCDDEEFF\');"
            注释 = "iRe:= SC_ENWrite ( rHandle,iBlock,pData);" @输出名 = "SC_ENWrite" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_鸣叫 <公开 静态 类型 = 整数 注释 = " 功能说明： 控制蜂鸣器的蜂鸣时间" 注释 = "       函数原型："
            注释 = "Function SC_Beep(Const Handle:THandle;" 注释 = "icount:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "icount: 固定为0" 注释 = "iTimes: 1 到 255" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe := SC_Beep(rHandle,0,3); //蜂鸣一声 短" 注释 = "" 注释 = "     报警声实现："
            注释 = "     iRe := SC_Beep(rHandle,0,25);" 注释 = "     sleep(1000); //延时的时间要大于，SC_Beep 的时间，否则会造成连续蜂鸣。"
            注释 = "     iRe := SC_Beep(rHandle,0,25);" @输出名 = "SC_Beep" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_icount_固定值 <类型 = 整数 @默认值 = 0>
    参数 参数_iTimes_长度 <类型 = 整数 @默认值 = 1>
    {

    }

    方法 方法_LED数码管显示 <公开 静态 类型 = 整数 注释 = "SC_LEDDSP()：LED数码管显示(此函数只对SC1023、SC1024、SC1025三种型号有效)"
            注释 = "     功能说明：可显示8位 数字和部分英文、字符" 注释 = "       函数原型：Function SC_LEDDSP(Const Handle:THandle;"
            注释 = "pData:Pchar;idot:integer):integer;stdcall;" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  pData ：可以显示的数据，空格表示 不显示" 注释 = "0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F、b、"
            注释 = "c、H、h、L、n、N、o、P、P、r、t、U、-、=、y、j" 注释 = ""
            注释 = "                  iDot  ：小数点的位置，值为0 ~ 8  ，0表示不显示" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例： iRe:= SC_LEDDSP( rHandle,12345678,6);" 注释 = ""
            注释 = "                  清屏：iRe:= SC_LEDDSP( rHandle,        ,0);" 注释 = "" @输出名 = "SC_LEDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    参数 参数_iDot_小数点位置 <类型 = 整数 @默认值 = 0>
    {

    }

    方法 方法_显示ASCII字符 <公开 静态 类型 = 整数 注释 = "SC_LCDDSP()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示ASCII字符" 注释 = "函数原型：Function SC_LCDDSP(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "参    数："
            注释 = "                 rHandle：COM的句柄" 注释 = "                 iline: 显示在第几行"
            注释 = "                 ilen : 显示字符长度" 注释 = "                 pData: 可以显示ASCII，如英文，标点符号等" 注释 = ""
            注释 = "     返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "     举    例： iRe:= SC_LCDDSP( rHandle,91,7,Pchar(\'ABCDEFG\'));" @输出名 = "SC_LCDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_显示中文 <公开 静态 类型 = 整数 注释 = "SC_LCDDSPCN()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示中文" 注释 = "函数原型：Function SC_LCDDSPCN(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "    参    数： rHandle：COM的句柄"
            注释 = "               iline: 显示在第几行" 注释 = "               ilen : 显示字符长度"
            注释 = "               pData: 汉字显示" 注释 = "" 注释 = "   返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "   举    例： iRe:= SC_LCDDSPCN( rHandle,91,6,Pchar(\'中文显示测试\'));" @输出名 = "SC_LCDDSPCN"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_指示灯控制 <公开 静态 类型 = 整数 注释 = "SC_LED()：指示灯控制" 注释 = "     功能说明： 控制红色和绿色指示灯、蜂鸣器" 注释 = "       函数原型："
            注释 = "Function SC_LED(Const Handle:THandle;" 注释 = "iType:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "iType:  1  //代表红色LED指示灯" 注释 = "2  //代表绿色LED指示灯" 注释 = "3  //代表红色和绿色LED指示灯" 注释 = "4  //代表 蜂鸣"
            注释 = "5  //代表 红色LED指示灯和蜂鸣" 注释 = "6  //代表 绿色LED指示灯和蜂鸣" 注释 = "7  //代表 红色和绿色LED指示灯和蜂鸣"
            注释 = "8  //代表 红色指示灯常亮" 注释 = "9  //代表 红色关闭" 注释 = "10 //代表 绿色指示灯常亮" 注释 = "11 //代表 绿色关闭"
            注释 = "12 //代表 红色和绿色指示灯常亮" 注释 = "13 //代表 红色和绿色指示灯关闭" 注释 = "iTimes: 1 到 255"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe := SC_LED(rHandle,1,5); //闪红色指示灯"
            注释 = "" 注释 = "     闪烁两下:：" 注释 = "     iRe := SC_LED(rHandle,1,5);"
            注释 = "     sleep(300); //延时的时间要大于，SC_LED的时间，否则会造成LED灯常亮。" 注释 = "     iRe := SC_LED (rHandle,1,5);"
            注释 = "" @输出名 = "SC_LED" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iType_类型 <类型 = 整数>
    参数 参数_iTimes_事件 <类型 = 整数 @默认值 = 1>
    {

    }
}

类 ""

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容 - 访问本程序中的接口需要引用模块"世恒封装的类库".

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_进制转换 <公开 @全局类 = 真>
{
    方法 方法_十进制转二进制 <公开 静态 类型 = 文本型 折叠 "">
    参数 参数_整数 <类型 = 整数>
    {
        变量 局部_文本 <类型 = 文本型>
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @  int n = 0;
        // @  scanf("%d", &n);//获得一个十进制的数字
        @  n = @<参数_整数>;

        @  int i = 0;
        @  int arr[32];//用整型数组来表示二进制
        @ while (n)  // 只要n不是0就可以继续计算
        @  {
        @   i++;
        @   arr[i] = n % 2;//给数组每一位上赋值
        @   n = n / 2;//赋值后就自动消去一位
        @  }
        @  for (int j = i; j > 0; j--)
        @  {
        // @   printf("%d", arr[j]);
        @    @<局部_文本>.AddText(arr[j]);
        @  }
        // @  return @<局部_文本>;
        返回 (局部_文本)


        // 11010010
        // @ }





    }

    方法 方法_二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 方法_十进制转十六进制 <公开 静态 类型 = 文本型 折叠 @禁止流程检查 = 真>
    参数 参数_整数 <类型 = 整数>
    {
        @ #include<stdio.h>
        // @ int main()
        // @ {
        @  int a = 0;
        @  int arr[32] = { 0 };//将转换后的十六进制数放进数组arr。
        @  int y = 0;
        // @  scanf("%d", &a);//获取一个十进制数
        @  a =@<参数_整数>;
        @  while (a != 0)
        @  {
        @   y++;
        @   arr[y] = a % 16;
        @   a = a / 16;
        @   if (arr[y] > 9)
        @   {
        @    arr[y] = 'A' + (arr[y] - 10);
        @   }
        @   else
        @   {
        @    arr[y] = '0' + arr[y];
        @   }
        @  }
        变量 局部_文本 <类型 = 文本型>
        @  for (int i = y; i > 0; i--)
        @  { //'A' 65
        @  // printf("%c", arr[i]);
        @ @<局部_文本>.AddText((TCHAR)arr[i]);
        @  }
        @  return @<局部_文本>;
        // @ }
        @ 
    }

    方法 方法_十六进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_十六进制文本串 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        @ #include<math.h>//千万别忘了引这个库
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * a= GetMbsText (@<参数_十六进制文本串>.GetText (), memBuf, &npResultTextLength);

        // @  char a[20];//输入十六进制数
        @  int b[20] = { 0 };//将十六进制数转成int类型
        @  int i, j, sum=0;//这里的sum别忘了初始化。
        @  int c = 0;//最终的十进制数
        // @  gets(a);
        @  //将其从char类型转成int类型,并存入数组b[]中。
        @  while (a[sum] != '\0')
        @  {
        @   if ((a[sum] >= 'a') && (a[sum] <= 'f'))
        @   {
        @    b[sum] = a[sum] - 'a' + 10;
        @    sum++;
        @    continue;
        @   }
        @   if ((a[sum] >= 'A') && (a[sum] <= 'F'))
        @   {
        @    b[sum] = a[sum] - 'A' + 10;
        @    sum++;
        @    continue;
        @   }
        @    b[sum] = a[sum] - '0';
        @    sum++;
        @  }
        @    //将每一位都转成16进制
        @  for(i = 0; i < sum; i++)//十进制转十六进制和十六进制转十进制是互逆的
        @  {
        @   b[sum - 1 - i] = b[sum - 1 - i] * pow(16, i);
        @  }
        @  //直接累加
        @  for (j = 0;j<sum;j++) 
        @  {
        @   c = c + b[j];
        @  }
        @  //printf("%d", c);
        @  return c;
        // @ }

    }

    方法 方法_十六进制转二进制 <公开 静态 类型 = 文本型 折叠>
    参数 参数_十六进制 <类型 = 文本型>
    {
        返回 (方法_十进制转二进制 (方法_十六进制转十进制 (参数_十六进制)))

    }

    方法 二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 世恒_二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 方法_二进制转十六进制 <公开 静态 类型 = 文本型 折叠>
    参数 参数_二进制 <类型 = 文本型>
    {
        返回 (方法_十进制转十六进制 (方法_二进制转十进制 (参数_二进制)))


    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容 - 访问本程序中的接口需要引用模块"世恒封装的类库".

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_飞天加密狗 <公开 @全局类 = 真 @视窗.附属文件 = "Ry4S.dll">
{
    变量 成员_handle <公开 静态 类型 = 整数>
    变量 成员_lp1 <公开 静态 类型 = 长整数>
    变量 成员_lp2 <公开 静态 类型 = 长整数>
    变量 成员_p1 <公开 静态 类型 = 整数>
    变量 成员_p2 <公开 静态 类型 = 整数>
    变量 成员_p3 <公开 静态 类型 = 整数>
    变量 成员_p4 <公开 静态 类型 = 整数>
    变量 成员_buffer <公开 静态 类型 = 字节集类>

    常量 BY_FIND <公开 类型 = 整数 值 = 1>
    常量 BY_OPEN <公开 类型 = 整数 值 = 3>
    常量 BY_CLOSE <公开 类型 = 整数 值 = 4>
    常量 BY_READ_EX <公开 类型 = 整数 值 = 46>
    常量 BY_WRITE_EX <公开 类型 = 整数 值 = 47>

    # .版本 2
    #
    # .常量 BY_FIND, "1"
    # .常量 BY_OPEN, "3"
    # .常量 BY_CLOSE, "4"
    # .常量 BY_READ_EX, "46"
    # .常量 BY_WRITE_EX, "47"
    #

    方法 飞天加密狗操作 <公开 静态 类型 = 整数 注释 = ".DLL命令 飞天加密狗操作, 整数型, \"Ry4S.dll\", \"Rockey\""
            注释 = "    .参数 function, 整数型, , 功能值" 注释 = "    .参数 handle, 整数型, 传址" 注释 = "    .参数 lp1, 长整数型, 传址"
            注释 = "    .参数 lp2, 长整数型, 传址" 注释 = "    .参数 p1, 整数型, 传址" 注释 = "    .参数 p2, 整数型, 传址"
            注释 = "    .参数 p3, 整数型, 传址" 注释 = "    .参数 p4, 整数型, 传址" 注释 = "    .参数 buffer, 字节集, 传址, 数据的缓冲区"
            @输出名 = "Rockey" @视窗.输入 = "Ry4S.dll" "" "" "" "">
    参数 参数_function <类型 = 整数>
    参数 参数_handle <类型 = 变整数>
    参数 参数_lp1 <类型 = 变整数>
    参数 参数_lp2 <类型 = 变整数>
    参数 参数_p1 <类型 = 变整数>
    参数 参数_p2 <类型 = 变整数>
    参数 参数_p3 <类型 = 变整数>
    参数 参数_p4 <类型 = 变整数>
    参数 参数_buffer <类型 = 变整数>
    {

    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 Word程序 <公开>
{
    变量 Word程序变量 <类型 = COM对象类>

    方法 获取 <公开 类型 = 逻辑型>
    {
        返回 (Word程序变量.获取 ("word.Application"))
    }

    方法 创建 <公开 类型 = 逻辑型>
    {
        返回 (Word程序变量.创建 ("word.Application", ""))



        // 如果真 (成员_程序对象.获取 ("word.Application") == 假)
        {
            // 如果真 (成员_程序对象.创建 ("word.Application", ) == 假)
            {
                // 信息框 ("创建文档对象失败", , )
                // 返回 (0)
            }

        }
        // 成员_程序对象.写属性 ("visible", 真)
        // // 成员_文档对象.获取 ("", )
        // 成员_文档对象集 = 成员_程序对象.读无参数对象型属性 ("Documents", COM对象类)
        // // 成员_文档对象 = 成员_文档对象集.读对象型属性 ("item", COM对象类, 1)
        // 成员_文档对象 = 成员_文档对象集.读无参数对象型属性 ("Add", COM对象类)

    }

    方法 可视 <公开 属性读 类型 = 逻辑型>
    {
        返回 (Word程序变量.读无参数属性 ("visible", 逻辑型))
    }

    方法 可视 <公开 属性写>
    参数 是否可视 <类型 = 逻辑型>
    {
        Word程序变量.写属性 ("visible", 是否可视)


    }

    方法 文档集 <公开 属性读 类型 = Word文档集>
    {
        变量 局部_Word文档集 <类型 = Word文档集>
        局部_Word文档集.置程序 (Word程序变量)
        局部_Word文档集.置文档集 (Word程序变量.读无参数对象型属性 ("Documents", COM对象类))
        返回 (局部_Word文档集)



    }

    # 如果真 (成员_程序对象.获取 ("word.Application") == 假)
    # 成员_程序对象.写属性 ("visible", 真)
    # // 成员_文档对象.获取 ("", )
    # 成员_文档对象集 = 成员_程序对象.读无参数对象型属性 ("Documents", COM对象类)
    # // 成员_文档对象 = 成员_文档对象集.读对象型属性 ("item", COM对象类, 1)
    # 成员_文档对象 = 成员_文档对象集.读无参数对象型属性 ("Add", COM对象类)
    #
}

类 Word文档集 <公开>
{
    变量 Word文档集变量 <类型 = COM对象类>
    变量 Word程序 <类型 = COM对象类>

    方法 置文档集 <公开>
    参数 文档集 <类型 = COM对象类>
    {
        Word文档集变量 = 文档集
    }

    方法 添加新文档 <公开 类型 = Word文档>
    {

        变量 局部_Word文档 <类型 = Word文档>
        局部_Word文档.置文档 (Word文档集变量.读无参数对象型属性 ("Add", COM对象类))
        返回 (局部_Word文档)
        变量 ""

    }

    方法 置程序 <公开>
    参数 word对象 <类型 = COM对象类>
    {
        Word程序 = word对象

    }

    方法 输入文字 <公开>
    参数 输入的文本 <类型 = 文本型>
    {
        Word程序.读无参数对象型属性 ("Selection", COM对象类).对象型方法 ("TypeText", COM对象类, 输入的文本)

        // Word文档变量.对象型方法 ("TypeText", COM对象类, 输入的文本)
    }
}

类 Word文档 <公开>
{
    变量 Word文档变量 <类型 = COM对象类>

    方法 置文档 <公开>
    参数 Word文档 <类型 = COM对象类>
    {
        Word文档变量 = Word文档
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_磁卡操作 <公开 @视窗.附属文件 = "SCDLL32.dll">
{
    变量 成员_rHandle_COM句柄 <公开 静态 类型 = 整数>
    变量 成员_pSNR_序列号 <公开 静态 类型 = 字节集类>
    变量 成员_pSNR_序列号_文本 <公开 静态 类型 = 文本型>
    变量 成员_块数据 <公开 静态 类型 = 字节集类>

    方法 方法_打开串口 <公开 静态 类型 = 整数 注释 = "功能说明：此函数用来通过串口与读写器建立通讯链路。传输协议为：波特率为才57600bps，数据位为8 位，1个停止位，无奇偶校验位。"
            注释 = "                在调用其它函数功能前，一定要先进行串行口的联接。"
            注释 = "       函数原型：Function InitPort(Const iPort: Integer;Out rHandle:Thandle): Integer;StdCall;"
            注释 = " 参    数：port: 端口号1 到 9" 注释 = "                 rHandle： COM句柄"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe:=InitPort(1,rHandle);"
            @输出名 = "InitPort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_iPort_串口号 <类型 = 整数>
    参数 参数_rHandle_COM句柄 <类型 = 变整数>
    {

    }

    方法 方法_关闭串口 <公开 静态 类型 = 整数 注释 = "功能说明： 关闭串口"
            注释 = "       函数原型：Function ClosePort(Const Handle:THandle):integer;StdCall;"
            注释 = "       参    数：rHandle： 所要关闭COM的句柄" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe:=ClosePort(rHandle);" @输出名 = "ClosePort" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {

    }

    方法 方法_寻找卡 <公开 静态 类型 = 整数 注释 = "  功能说明：查询感应区内是否有卡"
            注释 = "       函数原型：Function SC_Request(Const Handle:THandle ):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "       返 回 值： 返回值为：4表示8Kbit(1K字节)"
            注释 = "返回值为：2表示32Kbit(4K字节卡)" 注释 = "返回值为：1 表示无卡" 注释 = "       举    例：iRe := SC_Request(rHandle);"
            @输出名 = "SC_Request" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    {
        // 返回值为:4表示8Kbit(1K字节)
        // 返回值为:2表示32Kbit(4K字节卡)
        // 返回值为:1 表示无卡

    }

    方法 方法_读卡序列号 <公开 静态 类型 = 整数 注释 = " 功能说明：读取卡片的4字节16进制序列号 使用此函数之前先调用 SC_Request()"
            注释 = "       函数原型：Function SC_GetSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节16进制的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：GetMem(pSNR,16);"
            注释 = "                 iRe:=SC_GetSnr(rHandle,pSNR);" @输出名 = "SC_GetSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_选择卡 <公开 静态 类型 = 整数 注释 = " 功能说明：选择要操作的卡 ，使用此函数之前先调用SC_GetSnr()"
            注释 = "       函数原型：Function SC_SelectSnr(Const Handle:THandle; pSNR:Pchar):integer;stdcall;" 注释 = ""
            注释 = "       参    数： rHandle：COM的句柄" 注释 = "                  pSNR：4个字节的卡片序列号 ，例如：90A00438"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。32Kbit(4k字节)的卡片返回1正确"
            注释 = "       举    例：iRe:=SC_SelectSnr(rHandle,pSNR);" @输出名 = "SC_SelectSnr" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pSNR_序列号 <类型 = 变整数>
    {

    }

    方法 方法_核对秘钥 <公开 静态 类型 = 整数
            注释 = "功能说明：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "函数原型：Function SC_EncryptAuth (Const Handle:THandle;" 注释 = "iSector:integer;"
            注释 = "iMode:integer;pKey:Pchar):integer;stdcall;" 注释 = "参数：" 注释 = "rHandle：COM的句柄"
            注释 = "iSector：核对密钥的扇区号0~15" 注释 = "iMode：卡密钥的类型及A密钥60或B密钥61，通常使用A密钥60，"
            注释 = "pKey：卡密钥初始为12个FFFFFFFFFFFF" 注释 = "返回值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "举例：GetMem(pSNR,64);"
            注释 = "     iMode := 60;" 注释 = "     iSector := 0;" 注释 = "     pKey := Pchar(\'FFFFFFFFFFFF\');"
            注释 = "     iRe:= SC_EncryptAuth ( rHandle, iSector, iMode,pKey);" @输出名 = "SC_EncryptAuth"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iSector_扇区 <类型 = 整数>
    参数 参数_iMode_模式 <类型 = 整数 @默认值 = 60>
    参数 参数_pKey_秘钥 <类型 = 变整数>
    {

    }

    方法 方法_读块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：读卡一个块的16字节数据；"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENRead(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：存放读取的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： GetMem(pData,64);"
            注释 = "iBlock := 1;" 注释 = "iRe:= SC_RFRead(rHandle, iBlock, pData);" @输出名 = "SC_ENRead"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_写块数据 <公开 静态 类型 = 整数 注释 = " 功能说明：写一个块数据，写入数据必须是16个字节的十六进制。"
            注释 = "注意：IC卡带有密钥保护，所以 在对卡进行读写前，要进行 核对密钥，核对正确后才可以对卡进行读写，否则无法对卡进行读写操作，但可以读取卡片的物理序列号。"
            注释 = "       函数原型：Function SC_ENWrite(Const Handle:THandle;"
            注释 = "iBlock:integer;pData:Pchar):integer;stdcall;" 注释 = "" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  iBlock：所要读取的块号，值范围0~63块" 注释 = "pData ：要写入的16个字节块数据。"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例： iBlock := 1;"
            注释 = "pData := Pchar(\'11223344556677889900AABBCCDDEEFF\');"
            注释 = "iRe:= SC_ENWrite ( rHandle,iBlock,pData);" @输出名 = "SC_ENWrite" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iBlock_块号 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_鸣叫 <公开 静态 类型 = 整数 注释 = " 功能说明： 控制蜂鸣器的蜂鸣时间" 注释 = "       函数原型："
            注释 = "Function SC_Beep(Const Handle:THandle;" 注释 = "icount:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "icount: 固定为0" 注释 = "iTimes: 1 到 255" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例：iRe := SC_Beep(rHandle,0,3); //蜂鸣一声 短" 注释 = "" 注释 = "     报警声实现："
            注释 = "     iRe := SC_Beep(rHandle,0,25);" 注释 = "     sleep(1000); //延时的时间要大于，SC_Beep 的时间，否则会造成连续蜂鸣。"
            注释 = "     iRe := SC_Beep(rHandle,0,25);" @输出名 = "SC_Beep" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_icount_固定值 <类型 = 整数 @默认值 = 0>
    参数 参数_iTimes_长度 <类型 = 整数 @默认值 = 1>
    {

    }

    方法 方法_LED数码管显示 <公开 静态 类型 = 整数 注释 = "SC_LEDDSP()：LED数码管显示(此函数只对SC1023、SC1024、SC1025三种型号有效)"
            注释 = "     功能说明：可显示8位 数字和部分英文、字符" 注释 = "       函数原型：Function SC_LEDDSP(Const Handle:THandle;"
            注释 = "pData:Pchar;idot:integer):integer;stdcall;" 注释 = "       参    数： rHandle：COM的句柄"
            注释 = "                  pData ：可以显示的数据，空格表示 不显示" 注释 = "0、1、2、3、4、5、6、7、8、9、A、B、C、D、E、F、b、"
            注释 = "c、H、h、L、n、N、o、P、P、r、t、U、-、=、y、j" 注释 = ""
            注释 = "                  iDot  ：小数点的位置，值为0 ~ 8  ，0表示不显示" 注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "       举    例： iRe:= SC_LEDDSP( rHandle,12345678,6);" 注释 = ""
            注释 = "                  清屏：iRe:= SC_LEDDSP( rHandle,        ,0);" 注释 = "" @输出名 = "SC_LEDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    参数 参数_iDot_小数点位置 <类型 = 整数 @默认值 = 0>
    {

    }

    方法 方法_显示ASCII字符 <公开 静态 类型 = 整数 注释 = "SC_LCDDSP()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示ASCII字符" 注释 = "函数原型：Function SC_LCDDSP(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "参    数："
            注释 = "                 rHandle：COM的句柄" 注释 = "                 iline: 显示在第几行"
            注释 = "                 ilen : 显示字符长度" 注释 = "                 pData: 可以显示ASCII，如英文，标点符号等" 注释 = ""
            注释 = "     返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "     举    例： iRe:= SC_LCDDSP( rHandle,91,7,Pchar(\'ABCDEFG\'));" @输出名 = "SC_LCDDSP"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_显示中文 <公开 静态 类型 = 整数 注释 = "SC_LCDDSPCN()：ASCII字符显示(此函数只对SC1026、SC1027、SC1028三种型号有效)"
            注释 = "功能说明：显示中文" 注释 = "函数原型：Function SC_LCDDSPCN(Const Handle:THandle;"
            注释 = "iline:integer;ilen:integer;sData:pchar):integer;stdcall;" 注释 = "    参    数： rHandle：COM的句柄"
            注释 = "               iline: 显示在第几行" 注释 = "               ilen : 显示字符长度"
            注释 = "               pData: 汉字显示" 注释 = "" 注释 = "   返 回 值：返回值为0，表示操作正确；为其它值时表示出错。"
            注释 = "   举    例： iRe:= SC_LCDDSPCN( rHandle,91,6,Pchar(\'中文显示测试\'));" @输出名 = "SC_LCDDSPCN"
            @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iline_第几行 <类型 = 整数>
    参数 参数_ilen_字符长度 <类型 = 整数>
    参数 参数_pData_数据 <类型 = 变整数>
    {

    }

    方法 方法_指示灯控制 <公开 静态 类型 = 整数 注释 = "SC_LED()：指示灯控制" 注释 = "     功能说明： 控制红色和绿色指示灯、蜂鸣器" 注释 = "       函数原型："
            注释 = "Function SC_LED(Const Handle:THandle;" 注释 = "iType:integer;"
            注释 = "iTimes:integer):integer;stdcall;" 注释 = "       参    数：rHandle：COM的句柄"
            注释 = "iType:  1  //代表红色LED指示灯" 注释 = "2  //代表绿色LED指示灯" 注释 = "3  //代表红色和绿色LED指示灯" 注释 = "4  //代表 蜂鸣"
            注释 = "5  //代表 红色LED指示灯和蜂鸣" 注释 = "6  //代表 绿色LED指示灯和蜂鸣" 注释 = "7  //代表 红色和绿色LED指示灯和蜂鸣"
            注释 = "8  //代表 红色指示灯常亮" 注释 = "9  //代表 红色关闭" 注释 = "10 //代表 绿色指示灯常亮" 注释 = "11 //代表 绿色关闭"
            注释 = "12 //代表 红色和绿色指示灯常亮" 注释 = "13 //代表 红色和绿色指示灯关闭" 注释 = "iTimes: 1 到 255"
            注释 = "       返 回 值：返回值为0，表示操作正确；为其它值时表示出错。" 注释 = "       举    例：iRe := SC_LED(rHandle,1,5); //闪红色指示灯"
            注释 = "" 注释 = "     闪烁两下:：" 注释 = "     iRe := SC_LED(rHandle,1,5);"
            注释 = "     sleep(300); //延时的时间要大于，SC_LED的时间，否则会造成LED灯常亮。" 注释 = "     iRe := SC_LED (rHandle,1,5);"
            注释 = "" @输出名 = "SC_LED" @视窗.输入 = "SCDLL32.dll">
    参数 参数_rHandle_COM句柄 <类型 = 整数>
    参数 参数_iType_类型 <类型 = 整数>
    参数 参数_iTimes_事件 <类型 = 整数 @默认值 = 1>
    {

    }
}

类 ""

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_进制转换 <公开 @全局类 = 真>
{
    方法 方法_十进制转二进制 <公开 静态 类型 = 文本型 折叠 "">
    参数 参数_整数 <类型 = 整数>
    {
        变量 局部_文本 <类型 = 文本型>
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @  int n = 0;
        // @  scanf("%d", &n);//获得一个十进制的数字
        @  n = @<参数_整数>;

        @  int i = 0;
        @  int arr[32];//用整型数组来表示二进制
        @ while (n)  // 只要n不是0就可以继续计算
        @  {
        @   i++;
        @   arr[i] = n % 2;//给数组每一位上赋值
        @   n = n / 2;//赋值后就自动消去一位
        @  }
        @  for (int j = i; j > 0; j--)
        @  {
        // @   printf("%d", arr[j]);
        @    @<局部_文本>.AddText(arr[j]);
        @  }
        // @  return @<局部_文本>;
        返回 (局部_文本)


        // 11010010
        // @ }





    }

    方法 方法_二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 方法_十进制转十六进制 <公开 静态 类型 = 文本型 @禁止流程检查 = 真>
    参数 参数_整数 <类型 = 整数>
    {
        @ #include<stdio.h>
        // @ int main()
        // @ {
        @  int a = 0;

        @  int arr[32] = { 0 };//将转换后的十六进制数放进数组arr。
        @  int y = 0;
        // @  scanf("%d", &a);//获取一个十进制数
        @  a =@<参数_整数>;
        @  while (a != 0)
        @  {
        @   y++;
        @   arr[y] = a % 16;
        @   a = a / 16;
        @   if (arr[y] > 9)
        @   {
        @    arr[y] = 'A' + (arr[y] - 10);
        @   }
        @   else
        @   {
        @    arr[y] = '0' + arr[y];
        @   }
        @  }
        变量 局部_文本 <类型 = 文本型>
        @  for (int i = y; i > 0; i--)
        @  { //'A' 65
        @  // printf("%c", arr[i]);
        @ @<局部_文本>.AddText((TCHAR)arr[i]);
        @  }
        @  return @<局部_文本>;
        // @ }
        @ 
    }

    方法 方法_十六进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_十六进制文本串 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        @ #include<math.h>//千万别忘了引这个库
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * a= GetMbsText (@<参数_十六进制文本串>.GetText (), memBuf, &npResultTextLength);

        // @  char a[20];//输入十六进制数
        @  int b[20] = { 0 };//将十六进制数转成int类型
        @  int i, j, sum=0;//这里的sum别忘了初始化。
        @  int c = 0;//最终的十进制数
        // @  gets(a);
        @  //将其从char类型转成int类型,并存入数组b[]中。
        @  while (a[sum] != '\0')
        @  {
        @   if ((a[sum] >= 'a') && (a[sum] <= 'f'))
        @   {
        @    b[sum] = a[sum] - 'a' + 10;
        @    sum++;
        @    continue;
        @   }
        @   if ((a[sum] >= 'A') && (a[sum] <= 'F'))
        @   {
        @    b[sum] = a[sum] - 'A' + 10;
        @    sum++;
        @    continue;
        @   }
        @    b[sum] = a[sum] - '0';
        @    sum++;
        @  }
        @    //将每一位都转成16进制
        @  for(i = 0; i < sum; i++)//十进制转十六进制和十六进制转十进制是互逆的
        @  {
        @   b[sum - 1 - i] = b[sum - 1 - i] * pow(16, i);
        @  }
        @  //直接累加
        @  for (j = 0;j<sum;j++) 
        @  {
        @   c = c + b[j];
        @  }
        @  //printf("%d", c);
        @  return c;
        // @ }

    }

    方法 方法_十六进制转二进制 <公开 静态 类型 = 文本型 折叠>
    参数 参数_十六进制 <类型 = 文本型>
    {
        返回 (方法_十进制转二进制 (方法_十六进制转十进制 (参数_十六进制)))

    }

    方法 二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 世恒_二进制转十进制 <公开 静态 类型 = 整数 折叠 @禁止流程检查 = 真>
    参数 参数_二进制文本 <类型 = 文本型>
    {
        @ #include<stdio.h>
        @ #include<stdlib.h>
        @ #include<string.h>
        // @ int main()
        // @ {
        @ @an<CVolMem> memBuf;
        @ INT_P npResultTextLength;
        @ const char * arr= GetMbsText (@<参数_二进制文本>.GetText (), memBuf, &npResultTextLength);
        // @  char arr[1001];//创建一个数组char arr[1001]用来接收要转换进制的数。(注意是char类型的数组哦)
        // @  while (gets(arr) != NULL)
        // @  {
        @   int len, i, sum = 0, num, j;//初始化变量。num是每一位的数值,sum是每一位数值最后的加和。
        @   
        @   len = strlen(arr);//len是输入的字符数组的长度。
        @   for (i = 0; i < len; i++)
        @   {
        @    num = 1;
        @    if (arr[i] == '1')//如果位上是1那么就进行次方运算,如果是0的话就不用管(0不参与计算)
        @    {
        @     for (j = 1; j <= len - i - 1; j++)//j是每一位上的2的次方的个数。
        @     {
        @      num = num * 2;
        @     }
        @     sum = sum + num;//sum就是最后的十进制的值。
        @    }
        @   }
        // @   printf("%d\n", sum);
        // @  }
        @  return sum;
        // @ }



    }

    方法 方法_二进制转十六进制 <公开 静态 类型 = 文本型 折叠>
    参数 参数_二进制 <类型 = 文本型>
    {
        返回 (方法_十进制转十六进制 (方法_二进制转十进制 (参数_二进制)))


    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 类_飞天加密狗 <公开 @全局类 = 真 @视窗.附属文件 = "Ry4S.dll">
{
    变量 成员_handle <公开 静态 类型 = 整数>
    变量 成员_lp1 <公开 静态 类型 = 长整数>
    变量 成员_lp2 <公开 静态 类型 = 长整数>
    变量 成员_p1 <公开 静态 类型 = 整数>
    变量 成员_p2 <公开 静态 类型 = 整数>
    变量 成员_p3 <公开 静态 类型 = 整数>
    变量 成员_p4 <公开 静态 类型 = 整数>
    变量 成员_buffer <公开 静态 类型 = 字节集类>

    常量 BY_FIND <公开 类型 = 整数 值 = 1>
    常量 BY_OPEN <公开 类型 = 整数 值 = 3>
    常量 BY_CLOSE <公开 类型 = 整数 值 = 4>
    常量 BY_READ_EX <公开 类型 = 整数 值 = 46>
    常量 BY_WRITE_EX <公开 类型 = 整数 值 = 47>

    # .版本 2
    #
    # .常量 BY_FIND, "1"
    # .常量 BY_OPEN, "3"
    # .常量 BY_CLOSE, "4"
    # .常量 BY_READ_EX, "46"
    # .常量 BY_WRITE_EX, "47"
    #

    方法 飞天加密狗操作 <公开 静态 类型 = 整数 注释 = ".DLL命令 飞天加密狗操作, 整数型, \"Ry4S.dll\", \"Rockey\""
            注释 = "    .参数 function, 整数型, , 功能值" 注释 = "    .参数 handle, 整数型, 传址" 注释 = "    .参数 lp1, 长整数型, 传址"
            注释 = "    .参数 lp2, 长整数型, 传址" 注释 = "    .参数 p1, 整数型, 传址" 注释 = "    .参数 p2, 整数型, 传址"
            注释 = "    .参数 p3, 整数型, 传址" 注释 = "    .参数 p4, 整数型, 传址" 注释 = "    .参数 buffer, 字节集, 传址, 数据的缓冲区"
            @输出名 = "Rockey" @视窗.输入 = "Ry4S.dll" "" "" "" "">
    参数 参数_function <类型 = 整数>
    参数 参数_handle <类型 = 变整数>
    参数 参数_lp1 <类型 = 变整数>
    参数 参数_lp2 <类型 = 变整数>
    参数 参数_p1 <类型 = 变整数>
    参数 参数_p2 <类型 = 变整数>
    参数 参数_p3 <类型 = 变整数>
    参数 参数_p4 <类型 = 变整数>
    参数 参数_buffer <类型 = 变整数>
    {

    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

类 启动类 <公开 基础类 = 动态库程序类>
{
    变量 窗口_菜单MDI <公开 类型 = 类_菜单MDI>
    变量 窗口_窗口1 <公开 类型 = 类_新的窗口>
    变量 窗口_窗口2 <公开 类型 = 类_新的窗口>
    变量 窗口_窗口3 <公开 类型 = 类_新的窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        返回 (1)
    }
}

类 部件类_系统设置 <公开 注释 = "在部件DLL中,所有公开类中的公开方法均会被输出,具体请阅读用户开发手册中的相关内容.">
{
    方法 外部接口_菜单MDI <公开 静态>
    {
        取程序 ().窗口_菜单MDI.创建有菜单主窗口 (类_主菜单, , , , )
    }
}

类 类_菜单MDI <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"958, 731\"">
{
    变量 图片框_父组件 <类型 = 图片框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"13, 15, 936, 320\"" 组件边框 = 浅凹入式>
    变量 选择夹1 <公开 类型 = 选择夹 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"13, 351, 936, 360\"" 表头方向 = 下>

    #

    方法 类_菜单MDI_接收到命令 <接收事件 类型 = 整数 注释 = "当本窗口上的菜单项(包括弹出子菜单)/工具条按钮被单击或者对应快捷键被按下时,发送此事件."
            返回值注释 = "所通知的对应命令被处理返回1,否则返回0.">
    参数 来源对象 <类型 = 类_菜单MDI 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 命令代码 <类型 = 整数 注释 = "  提供所对应命令的ID值,对于菜单项或其快捷键来说,就是对应菜单项设计时提供的引用常量ID值,"
            注释 = "对于工具条来说,就是对应按钮设计时提供的引用常量ID值.">
    {
        如果 (命令代码 == 类_主菜单.新建)
        {
            如果 (取程序 ().窗口_窗口1.是否为空 ())
            {
                取程序 ().窗口_窗口1.创建子窗口 (图片框_父组件, , , , , )
                取程序 ().窗口_菜单MDI.选择夹1.添加子夹 ("子夹1", , 类_第一个子夹, )

            }
            否则 (取程序 ().窗口_窗口2.是否为空 ())
            {
                取程序 ().窗口_窗口2.创建子窗口 (图片框_父组件, , , , , )
                取程序 ().窗口_菜单MDI.选择夹1.添加子夹 ("子夹2", , 类_第二个子夹, )
                // 取程序 ().窗口_菜单MDI.选择夹1.现行子夹 = 1
                // 取程序 ().窗口_菜单MDI.选择夹1.删除子夹 ()
                // 取程序 ().窗口_菜单MDI.选择夹1.sc
            }
            否则 (取程序 ().窗口_窗口3.是否为空 ())
            {
                取程序 ().窗口_窗口3.创建子窗口 (图片框_父组件, , , , , )
                取程序 ().窗口_菜单MDI.选择夹1.添加子夹 ("子夹3", , 类_第三个子夹, )



            }

        }
        否则 (命令代码 == 类_主菜单.打开)
        {

        }
        否则 (命令代码 == 类_主菜单.退出)
        {
            销毁 ()
        }
        否则 (命令代码 == 类_主菜单.关于)
        {
            方法_调用windows关于 (取窗口句柄 (), 取字节集指针 (文本到多字节 ("简易进销存", )), 取字节集指针 (文本到多字节 ("努力成为您生意的好帮手", )), 方法_加载图标 (0, 32516))

        }

        返回 (0)
    }

    方法 方法_加载图标 <公开 静态 类型 = 整数 注释 = "HICON LoadIcon(HINSTANCE hInstance,LPCTSTR lpIconName);"
            @输出名 = "LoadIconA" @视窗.输入 = "user32.dll">
    参数 参数_hInstance_句柄 <类型 = 整数>
    参数 参数_lpIconName_图表号 <类型 = 整数>
    {

    }

    方法 方法_调用windows关于 <公开 静态 类型 = 整数
            注释 = "Declare Sub ShellAbout Lib \"shell.dll\" (ByVal hWndOwner As Integer,"
            注释 = "ByVal lpszAppName As String, By lpszMoreInfo As String," 注释 = "ByVal hIcon As Integer)"
            @输出名 = "ShellAboutA" @视窗.输入 = "shell32.dll">
    参数 参数_hWndOwner_句柄 <类型 = 整数>
    参数 参数_lpszAppName_标题 <类型 = 变整数>
    参数 参数_lpszMoreInfo_描述 <类型 = 变整数>
    参数 参数_hIcon_图标 <类型 = 整数>
    {

    }
}

类 类_主菜单 <基础类 = 菜单类 隐藏值属性 = "0"
        @设计内容 = "1\r\n0\r\n文件(&F)\r\n文件\r\n20000\r\n\r\n\r\n0\r\n0\r\n0\r\n0\r\n0\r\n1\r\n新建\r\n新建\r\n20001\r\n\r\nN\r\n1\r\n0\r\n0\r\n0\r\n0\r\n1\r\n打开\r\n打开\r\n20002\r\n\r\nO\r\n1\r\n0\r\n0\r\n0\r\n0\r\n1\r\n\r\n\r\n0\r\n\r\n\r\n0\r\n0\r\n1\r\n0\r\n0\r\n1\r\n退出\r\n退出\r\n20004\r\n\r\n\r\n0\r\n0\r\n0\r\n0\r\n0\r\n0\r\n帮助(&H)\r\n帮助\r\n20005\r\n\r\n\r\n0\r\n0\r\n0\r\n0\r\n0\r\n1\r\n帮助\r\n帮助页面\r\n20006\r\n\r\n\r\n0\r\n0\r\n0\r\n0\r\n0\r\n1\r\n关于\r\n关于\r\n20007\r\n\r\nI\r\n1\r\n0\r\n0\r\n0\r\n0">
{
    常量 文件 <公开 类型 = 整数 值 = 20000 注释 = "文件(&F)" @自动生成 = "mfc">
    常量 新建 <公开 类型 = 整数 值 = 20001 注释 = "新建" @自动生成 = "mfc">
    常量 打开 <公开 类型 = 整数 值 = 20002 注释 = "打开" @自动生成 = "mfc">
    常量 退出 <公开 类型 = 整数 值 = 20004 注释 = "退出" @自动生成 = "mfc">
    常量 帮助 <公开 类型 = 整数 值 = 20005 注释 = "帮助(&H)" @自动生成 = "mfc">
    常量 帮助页面 <公开 类型 = 整数 值 = 20006 注释 = "帮助" @自动生成 = "mfc">
    常量 关于 <公开 类型 = 整数 值 = 20007 注释 = "关于" @自动生成 = "mfc">
    常量 _最小值 <公开 类型 = 整数 值 = 20000 注释 = "所有ID值中的最小值" @自动生成 = "mfc">
    常量 _最大值 <公开 类型 = 整数 值 = 20007 注释 = "所有ID值中的最大值" @自动生成 = "mfc">

    #
}

类 类_新的窗口 <基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"440, 264\"" 控制按钮 = 真 窗口边框 = 普通可调边框 最大化按钮 = 真
        最小化按钮 = 真 Esc键关闭 = 假>
{
    变量 编辑框1 <类型 = 编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"5, 7, 424, 256\"">

    #

    方法 类_新的窗口_尺寸被改变 <接收事件 类型 = 整数 注释 = "当本组件的尺寸被改变后发送此事件">
    参数 来源对象 <类型 = 类_新的窗口 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        编辑框1.移动 (, , 取用户区宽度 () - 编辑框1.左边 * 2, 取用户区高度 () - 编辑框1.顶边 * 2)

        返回 (0)
    }
}

类 类_第一个子夹 <基础类 = 组件布局器 隐藏值属性 = "0" @视窗.布局 = "client_size = \"641, 271\"">
{
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"40, 24, 400, 40\"" 标题 = "我是第一个里面的标签1">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"40, 88, 400, 72\"" 标题 = "我是第一个里面的标签2">
    变量 日期框1 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"216, 184, 240, 48\"">

    #
}

类 类_第二个子夹 <基础类 = 组件布局器 隐藏值属性 = "0" @视窗.布局 = "client_size = \"641, 271\"">
{
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"40, 24, 400, 40\"" 标题 = "我是第2个里面的标签1">
    变量 月历1 <类型 = 月历 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"48, 80, 328, 152\"">
    变量 超级编辑框1 <类型 = 超级编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"408, 32, 200, 208\"">

    #
}

类 类_第三个子夹 <基础类 = 组件布局器 隐藏值属性 = "0" @视窗.布局 = "client_size = \"641, 271\"">
{
    变量 超级编辑框1 <类型 = 超级编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"8, 8, 624, 256\"">

    #

    方法 类_第三个子夹_尺寸被改变 <接收事件 类型 = 整数 注释 = "当本组件的尺寸被改变后发送此事件">
    参数 来源对象 <类型 = 类_第三个子夹 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        超级编辑框1.移动 (, , 本对象.宽度 - 超级编辑框1.左边 * 2, 本对象.高度 - 超级编辑框1.顶边 * 2)
        返回 (0)
    }
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.测试 <注释 = "火山无名模块：http://m.vowm.cn">

类 启动类 <公开 基础类 = 窗口程序类>
{
    变量 主窗口对象 <类型 = 我的主窗口>

    方法 启动方法 <公开 类型 = 整数>
    {
        主窗口对象.创建主窗口 ()
        返回 (1)
    }
}

类 我的主窗口 <基础类 = 窗口 注释 = "火山无名模块：http://m.vowm.cn" 隐藏值属性 = "0" @视窗.布局 = "client_size = \"500, 350\"">
{
    变量 布局1 <类型 = 布局 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"69, 56, 264, 200\"">

    方法 我的主窗口_接收到命令 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 我的主窗口>
    参数 标记值 <类型 = 整数>
    参数 命令代码 <类型 = 整数>
    {
        如果 (命令代码 == 菜单操作.复制)
        {
            信息框 ("复制")
        }
        返回 (0)
    }

    方法 我的主窗口_创建完毕 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 我的主窗口>
    参数 标记值 <类型 = 整数>
    {
        挂接事件 (布局1.超级编辑框1)
        返回 (0)
    }

    方法 超级编辑框_鼠标右键被放开 <接收事件 类型 = 整数>
    参数 来源对象 <类型 = 超级编辑框>
    参数 标记值 <类型 = 整数>
    参数 横向位置 <类型 = 整数>
    参数 纵向位置 <类型 = 整数>
    参数 辅助键状态 <类型 = 整数>
    {
        如果 (来源对象 == 布局1.超级编辑框1)
        {
            弹出菜单 (菜单操作)
        }
        返回 (0)
    }
}

类 布局 <基础类 = 组件布局器 注释 = "火山无名模块：http://m.vowm.cn" 隐藏值属性 = "0" @视窗.布局 = "client_size = \"305, 252\"">
{
    变量 超级编辑框1 <公开 类型 = 超级编辑框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"32, 56, 232, 144\"">
}

类 菜单操作 <基础类 = 菜单类 注释 = "火山无名模块：http://m.vowm.cn" 隐藏值属性 = "0"
        @设计内容 = "1\n0\n编辑\n编辑\n20000\n\n\n0\n0\n0\n0\n0\n1\n复制\n复制\n20001\n\n\n0\n0\n0\n0\n0\n1\n粘贴\n粘贴\n20002\n\n\n0\n0\n0\n0\n0">
{
    常量 编辑 <公开 类型 = 整数 值 = 20000 注释 = "编辑" @自动生成 = "mfc">
    常量 复制 <公开 类型 = 整数 值 = 20001 注释 = "复制" @自动生成 = "mfc">
    常量 粘贴 <公开 类型 = 整数 值 = 20002 注释 = "粘贴" @自动生成 = "mfc">
    常量 _最小值 <公开 类型 = 整数 值 = 20000 注释 = "所有ID值中的最小值" @自动生成 = "mfc">
    常量 _最大值 <公开 类型 = 整数 值 = 20002 注释 = "所有ID值中的最大值" @自动生成 = "mfc">

    #
}

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 火山.程序

【分隔符】


###### 以下为一个火山软件开发平台系统类库程序的内容

<火山程序 类型 = "通常" 版本 = 1 />

包 ""

类 启动类 <公开 基础类 = 动态库程序类>
{
    变量 数据库_全局Mysql库 <公开 类型 = Mysql数据库类>
    变量 窗口_进货管理 <公开 类型 = 类_进货管理>
    变量 窗口_进货下单 <公开 类型 = 类_进货下单>
    变量 全局_权限 <公开 类型 = 文本型>
    变量 成员_宽度 <公开 类型 = 整数>
    变量 成员_高度 <公开 类型 = 整数>

    方法 启动方法 <公开 类型 = 整数>
    {
        变量 ""
        返回 (1)
    }
}

类 部件类_进货管理 <公开 注释 = "在部件DLL中,所有公开类中的公开方法均会被输出,具体请阅读用户开发手册中的相关内容.">
{
    方法 外部接口_进货管理 <公开 静态>
    参数 参数_父组件句柄 <类型 = 整数>
    参数 参数_Mysql数据库 <类型 = Mysql数据库类>
    参数 参数_权限串 <类型 = 文本型>
    {
        取程序 ().全局_权限 = 参数_权限串

        取程序 ().数据库_全局Mysql库 = 参数_Mysql数据库
        取程序 ().窗口_进货管理.创建主窗口 (, , , , )

        变量 局部_窗口位置 <类型 = 类_窗口位置数据>
        方法_取窗口尺寸 (参数_父组件句柄, 局部_窗口位置)
        取程序 ().成员_宽度 = 局部_窗口位置.成员_right_右边 - 局部_窗口位置.成员_left_左边
        取程序 ().成员_高度 = 局部_窗口位置.成员_bottom_底边 - 局部_窗口位置.成员_top_上边
        如果 (读配置项 (取运行目录 () + "登录信息.ini", "小王", "子窗口嵌入主窗口", "0") == "1")
        {
            取程序 ().窗口_进货管理.窗口边框 = 窗口边框类型.无边框
            方法_设置父窗口 (取程序 ().窗口_进货管理.取窗口句柄 (), 参数_父组件句柄)
            方法_移动窗口 (取程序 ().窗口_进货管理.取窗口句柄 (), 0, 0, 局部_窗口位置.成员_right_右边 - 局部_窗口位置.成员_left_左边, 局部_窗口位置.成员_bottom_底边 - 局部_窗口位置.成员_top_上边, 1)

        }
        否则
        {
            取程序 ().窗口_进货管理.窗口边框 = 窗口边框类型.普通可调边框
            方法_移动窗口 (取程序 ().窗口_进货管理.取窗口句柄 (), 局部_窗口位置.成员_left_左边, 局部_窗口位置.成员_top_上边, 局部_窗口位置.成员_right_右边 - 局部_窗口位置.成员_left_左边, 局部_窗口位置.成员_bottom_底边 - 局部_窗口位置.成员_top_上边, 1)


        }



    }

    方法 方法_移动窗口 <公开 静态 类型 = 整数 @输出名 = "MoveWindow" @视窗.输入 = "user32.dll">
    参数 参数_hWnd_窗口句柄 <类型 = 整数>
    参数 参数_x_左上角x <类型 = 整数>
    参数 参数_y_左上角y <类型 = 整数>
    参数 参数_Width_宽度 <类型 = 整数>
    参数 参数_Height_高度 <类型 = 整数>
    参数 参数_bRepaint_刷新 <类型 = 整数>
    {

    }

    方法 方法_设置父窗口 <公开 静态 类型 = 整数 @输出名 = "SetParent" @视窗.输入 = "user32.dll">
    参数 参数_hWndChild_子窗口句柄 <类型 = 整数>
    参数 参数_hWndNewParent_父窗口句柄 <类型 = 整数>
    {

    }

    方法 方法_取窗口尺寸 <公开 静态 类型 = 整数 @输出名 = "GetWindowRect" @视窗.输入 = "user32.dll">
    参数 参数_hwnd_窗口句柄 <类型 = 整数>
    参数 参数_lpRectt_位置数据 <类型 = 类_窗口位置数据 @视窗.输出参数 = 真>
    {

    }

    方法 外部接口_进货下单 <公开 静态>
    参数 参数_Mysql数据库 <类型 = Mysql数据库类>
    参数 参数_权限串 <类型 = 文本型>
    {
        取程序 ().数据库_全局Mysql库 = 参数_Mysql数据库
        取程序 ().全局_权限 = 参数_权限串
        取程序 ().窗口_进货下单.创建主窗口 (, , , , )

    }

    #
}

类 类_窗口位置数据 <公开 @视窗.结构类 = 0>
{
    变量 成员_left_左边 <公开 类型 = 整数>
    变量 成员_top_上边 <公开 类型 = 整数>
    变量 成员_right_右边 <公开 类型 = 整数>
    变量 成员_bottom_底边 <公开 类型 = 整数>

    #
}

类 类_进货管理 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 768\"" 底色 = 0xFFFFFF 窗口边框 = 普通可调边框>
{
    变量 树形框_进货日程 <类型 = 树形框 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"10, 175, 315, 576\""
            字体 = ", 14, 0, 0, 0, 0, 0" 显示根部线 = 真 显示连线 = 真 显示加减框 = 真 是否有检查框 = 假
            图片组 = "..\\..\\相关素材\\col_icons.png">
    变量 ""
    变量 标签_橙色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"10, 13, 210, 50\"" 标题 = "订单总数"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_橙色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"10, 63, 210, 50\"" 标题 = "52"
            背景颜色 = 0x0080FF 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"273, 13, 210, 50\"" 标题 = "30天内新增"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_蓝色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"273, 63, 210, 50\"" 标题 = "38"
            背景颜色 = 0xC06000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"536, 13, 210, 50\"" 标题 = "60天内新增"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_绿色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"536, 63, 210, 50\"" 标题 = "14"
            背景颜色 = 0x80E000 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"799, 13, 210, 50\"" 标题 = "半年新增"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 18, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 标签_紫色2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"799, 63, 210, 50\"" 标题 = "16"
            背景颜色 = 0xFF0090 字体 = "方正小标宋简体, 30, 0, 0, 0, 0, 0" 文本颜色 = 0xFFFFFF 横向对齐方式 = 居中 纵向对齐方式 = 居中>
    变量 超级列表框_单据列表 <公开 类型 = 超级列表框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"341, 175, 674, 176\""
            "类型" = 报表列表框
            报表列 = "0\n-1\n0\n200\n单据号\n0\n-1\n0\n100\n供应商名称\n0\n-1\n0\n100\n存放仓库\n0\n-1\n0\n110\n进货日期\n0\n-1\n0\n80\n合计金额\n0\n-1\n0\n80\n经手人"
            整行选择 = 真 显示表格线 = 真 字体 = ", 12, 0, 0, 0, 0, 0">
    变量 超级按钮_查询 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"461, 131, 96, 32\"" 标题 = "查询"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_打印 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"917, 131, 96, 32\"" 标题 = "打印"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_删除 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"803, 131, 96, 32\"" 标题 = "删除"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_修改 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"689, 131, 96, 32\"" 标题 = "修改"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_进货 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"575, 131, 96, 32\"" 标题 = "进货"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_关键字 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"10, 131, 311, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 选择框_模糊查找 <类型 = 选择框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"333, 131, 112, 32\"" 标题 = "模糊查找"
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 背景颜色 = 0xFFFFFF>
    变量 ""
    变量 成员_当前状态 <公开 静态 类型 = 文本型>
    变量 成员_商品类别 <公开 静态 类型 = 文本型>
    变量 成员_商品类别ID <公开 静态 类型 = 文本型>
    变量 "//窗口_商品信息" <公开 类型 = 类_商品信息>
    变量 表格1 <类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 118\r\npos = \"341, 360, 664, 376\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 1 表头列数 = 0 是否可编辑 = 假 行数 = 1 列数 = 7 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 窗口_进货下单 <公开 类型 = 类_进货下单>

    方法 类_进货管理_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_进货管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        变量 ""
        // 方法_连接Mysql数据库 ()

        如果真 (寻找文本 (取程序 ().全局_权限, ",0.1003.01,", , ) == -1)
        {
            超级按钮_查询.禁止 = 真
            编辑框_关键字.禁止 = 真
            选择框_模糊查找.禁止 = 真


        }
        如果真 (寻找文本 (取程序 ().全局_权限, ",0.1003.02,", , ) == -1)
        {
            超级按钮_进货.禁止 = 真
        }

        // "CREATE TABLE `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin"
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("CREATE TABLE if not exists `splb` (  `ID` BIGINT(11) NOT NULL AUTO_INCREMENT,  `上级ID` BIGINT(11) NOT NULL,  `类别名称` VARCHAR(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` DATETIME DEFAULT NULL,  `修改时间` DATETIME DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MYISAM AUTO_INCREMENT=1 DEFAULT CHARSET=gbk COLLATE=gbk_bin") == 假)
        {
            信息框 ("创建分类表失败", , )
            销毁 ()
            返回 (0)

        }
        // 信息框 ("创建分类表成功", , )
        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` (`上级ID`,`类别名称` ,  `添加时间`) VALUES (1,'啤酒类',NOW()) ") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
        }

        // 如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("INSERT INTO `splb` set `上级ID`=1,`类别名称` ='白酒类',`添加时间`=NOW()") == 假)
        {
            // 信息框 ("执行插入语句失败", , )
            // 销毁 ()
            // 返回 (0)
        }

        方法_显示进货日程 (树形框_进货日程, -1)
        树形框_进货日程.扩展 (0)
        方法_统计进货 ()


        表格1.列数 = 7
        表格1.列宽 = 120
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "进货数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "进货价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置数据 (0, 6, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (6, 0)
        表格1.置列宽 (2, 80)
        表格1.置列宽 (3, 80)
        表格1.置列宽 (4, 80)
        表格1.置列宽 (5, 80)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置列类型 (5, 表格常量.货币型)
        表格1.置计算公式 (3, 4, 表格常量.乘, 5)
        返回 (0)





        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `splb`") == 假)
        {
            信息框 ("查询失败", , )
            销毁 ()
            返回 (0)
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)

        // 判断循环 (局部_记录集.到下一行 ())
        {
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))

        }
        // 局部_记录集.关闭 ()
        // 返回 (0)

        // 局部_记录集.到指定行 (0)
        // 表格1.行数 = 1
        // 表格1.列数 = 8
        // 表格1.列宽 = 100
        // 表格1.置数据 (0, 0, 表格常量.文本值型, "商品名称")
        // 表格1.置数据 (0, 1, 表格常量.文本值型, "规格型号")
        // 表格1.置数据 (0, 2, 表格常量.文本值型, "进货数量")
        // 表格1.置数据 (0, 3, 表格常量.文本值型, "进货价格")
        // 表格1.置数据 (0, 4, 表格常量.文本值型, "合计金额")
        表格1.列数 = 6
        表格1.列宽 = 120
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "进货数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "进货价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置列宽 (2, 80)
        表格1.置列宽 (3, 80)
        表格1.置列宽 (4, 80)
        表格1.置列宽 (5, 80)

        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            调试输出 (局部_记录集.读文本数据 ("类别名称"))
            // 表格1.置数据 (0, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("类别名称"))
            表格1.插入行 (局部_记录集.读文本数据 ("类别名称"), )


        }
        局部_记录集.关闭 ()
        表格1.置列类型 (5, 表格常量.选择型)
        表格1.置列类型 (6, 表格常量.图片型)
        表格1.添加下拉列表内容 ("1")
        表格1.添加下拉列表内容 ("2")
        表格1.清空下拉列表 ()
        表格1.添加下拉列表内容 ("330ml")
        表格1.添加下拉列表内容 ("500ml")
        表格1.添加下拉列表内容 ("2000ml")
        表格1.置列类型 (1, 表格常量.列表型)
        表格1.置列类型 (2, 表格常量.数值型)
        表格1.置列类型 (3, 表格常量.货币型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置计算公式 (2, 3, 表格常量.乘, 4)
        表格1.插入行 ("合计", )
        表格1.置累加公式 (2, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.置累加公式 (3, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.置累加公式 (4, 1, 表格1.行数 - 2, 表格1.行数 - 1)
        表格1.合并 (表格1.行数 - 1, 0, 表格1.行数 - 1, 1)
        表格1.置对齐方式 (表格1.行数 - 1, 0, 表格1.行数 - 1, 0, 表格常量.居中对齐)




        // 调试输出 (表格1.取文本数据 (0, 3))
        // 表格1.行数 = 表格1.行数 + 1





        // 表格1.取图片数据

        返回 (0)
    }

    方法 方法_统计进货
    {
        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select count(ID) as `总数` from `jhb`") == 假)
        {
            信息框 ("查询失败", , )
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_橙色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `jhb`  WHERE TIMESTAMPDIFF(DAY,`进货日期`,NOW())>=0 AND  TIMESTAMPDIFF(DAY,`进货日期`,NOW())<=30") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_蓝色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()


        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `jhb`  WHERE TIMESTAMPDIFF(DAY,`进货日期`,NOW())>=0 AND  TIMESTAMPDIFF(DAY,`进货日期`,NOW())<=60") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_绿色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT count(ID) as `总数`  FROM `jhb`  WHERE TIMESTAMPDIFF(MONTH,`进货日期`,NOW())>=0 AND  TIMESTAMPDIFF(MONTH,`进货日期`,NOW())<=6") == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        如果真 (局部_记录集.到下一行 ())
        {
            标签_紫色2.标题 = 到文本 (局部_记录集.读整数数据 ("总数"))
            // 调试输出 (局部_记录集.读文本数据 ("类别名称"))
        }
        局部_记录集.关闭 ()

    }

    方法 方法_显示进货单据列表
    参数 参数_日期 <类型 = 文本型>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        变量 局部_位置 <类型 = 整数>
        变量 局部_语句 <类型 = 文本型>
        局部_语句 = "SELECT `jhb`.`ID` AS `ID` ,`jhb`.`单据号` AS `单据号` ,`gys`.`供应商名称` AS `供应商名称` ,`jhb`.`存放仓库` AS `存放仓库` ,`jhb`.`进货日期` AS `进货日期` ,`jhb`.`合计金额` AS `合计金额`  ,`jhb`.`经手人` AS `经手人`   FROM `gys`,`jhb` WHERE gys.`ID`=jhb.`供应商ID` AND YEAR(`jhb`.`进货日期`)*10000+MONTH(`jhb`.`进货日期`)*100+DAY(`jhb`.`进货日期`) =" + 参数_日期

        调试输出 (局部_语句)

        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
        {
            信息框 ("查询失败", , )

            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        超级列表框_单据列表.全部删除 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            局部_位置 = 超级列表框_单据列表.插入表项 (, , , , , 局部_记录集.读整数数据 ("ID"))
            超级列表框_单据列表.置标题 (局部_位置, 0, 局部_记录集.读文本数据 ("单据号"))
            如果 (寻找文本 (取程序 ().全局_权限, ",0.1003.01.01,", , ) == -1)
            {
                超级列表框_单据列表.置标题 (局部_位置, 1, "*无权查看*")
            }
            否则
            {
                超级列表框_单据列表.置标题 (局部_位置, 1, 局部_记录集.读文本数据 ("供应商名称"))


            }
            超级列表框_单据列表.置标题 (局部_位置, 2, 局部_记录集.读文本数据 ("存放仓库"))
            超级列表框_单据列表.置标题 (局部_位置, 3, 局部_记录集.读文本数据 ("进货日期"))

            如果 (寻找文本 (取程序 ().全局_权限, ",0.1003.01.02,", , ) == -1)
            {
                超级列表框_单据列表.置标题 (局部_位置, 4, "*无权查看*")

            }
            否则
            {
                超级列表框_单据列表.置标题 (局部_位置, 4, 到文本 (局部_记录集.读小数数据 ("合计金额")))

            }
            如果 (寻找文本 (取程序 ().全局_权限, ",0.1003.01.03,", , ) == -1)
            {
                超级列表框_单据列表.置标题 (局部_位置, 5, "*无权查看*")
            }
            否则
            {
                超级列表框_单据列表.置标题 (局部_位置, 5, 局部_记录集.读文本数据 ("经手人"))

            }

        }
        局部_记录集.关闭 ()



        // Create Table
        // CREATE TABLE `jhb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `供应商ID` bigint(11) DEFAULT NULL,  `存放仓库` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `进货日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT '0.00',  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM AUTO_INCREMENT=11 DEFAULT CHARSET=gbk COLLATE=gbk_bin

    }

    方法 方法_显示进货日程
    参数 参数_树型框 <类型 = 树形框>
    参数 参数_当前选中项 <类型 = 整数 @默认值 = -1>
    {
        变量 局部_索引 <类型 = 整数>

        变量 局部_语句 <类型 = 文本型>
        如果真 (参数_当前选中项 != -1)
        {
            判断循环 (树形框_进货日程.取父项目 (参数_当前选中项 + 1) == 参数_当前选中项)
            {
                树形框_进货日程.删除项目 (参数_当前选中项 + 1)
            }

        }
        如果 (参数_当前选中项 == -1)
        {
            局部_索引 = 树形框_进货日程.加入项目 (, "进货日程", , , -1, , )
            树形框_进货日程.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

        }
        否则
        {
            如果 (树形框_进货日程.取缩进层次 (参数_当前选中项) == 1)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`进货日期`) AS `年份` FROM `jhb` ORDER BY `年份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("年份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  YEAR(`进货日期`)*100+month(`进货日期`) AS `月份` FROM `jhb`  where YEAR(`进货日期`) =" + 局部_记录集.读文本数据 ("年份") + " ORDER BY `月份` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()


            }
            否则 (树形框_进货日程.取缩进层次 (参数_当前选中项) == 2)
            {
                局部_语句 = "SELECT DISTINCT  YEAR(`进货日期`)*100+month(`进货日期`) AS `月份` FROM `jhb`  where YEAR(`进货日期`) =" + 树形框_进货日程.取项目文本 (参数_当前选中项) + " ORDER BY `月份` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("月份"), 2, 2, , , )
                    变量 局部_记录集1 <类型 = Mysql记录集类>
                    如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("SELECT DISTINCT  (YEAR(`进货日期`)*10000+MONTH(`进货日期`)*100+DAY(`进货日期`)) AS `日`  FROM `jhb`  where YEAR(`进货日期`)*100+month(`进货日期`) =" + 局部_记录集.读文本数据 ("月份") + " ORDER BY `日` asc") == 假)
                    {
                        信息框 ("查询失败2", , )
                        销毁 ()
                        返回
                    }
                    局部_记录集1 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                    调试输出 (局部_记录集1.行数)
                    如果真 (局部_记录集1.行数 > 0)
                    {
                        参数_树型框.加入项目 (局部_索引, "正在载入中...", 2, 2, -999, , )

                    }
                    局部_记录集1.关闭 ()

                }
                局部_记录集.关闭 ()



            }
            否则 (树形框_进货日程.取缩进层次 (参数_当前选中项) == 3)
            {
                局部_语句 = "SELECT DISTINCT  (YEAR(`进货日期`)*10000+MONTH(`进货日期`)*100+DAY(`进货日期`)) AS `日`  FROM `jhb`  where YEAR(`进货日期`)*100+month(`进货日期`) =" + 树形框_进货日程.取项目文本 (参数_当前选中项) + " ORDER BY `日` asc"
                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("查询失败1", , )
                    销毁 ()
                    返回
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)
                计次循环 ((整数)局部_记录集.行数)
                {
                    局部_记录集.到下一行 ()
                    局部_索引 = 参数_树型框.加入项目 (参数_当前选中项, 局部_记录集.读文本数据 ("日"), 2, 2, , , )

                }
                局部_记录集.关闭 ()



            }


        }
        调试输出 (局部_语句)

        返回







    }

    方法 表格_光标位置改变 <接收事件 类型 = 整数 注释 = "当用户更改了当前被选择单元时会产生本事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {

        }
        返回 (0)
    }

    方法 树形框_即将扩展 <接收事件 类型 = 整数 注释 = "当某项目即将被展开以显示出下属子项目时产生本事件,返回1中止展开,返回0则允许.">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 项目索引 <类型 = 整数 注释 = "提供即将扩展显示下属子项目的项目索引,从0开始.">
    {
        如果 (来源对象 == 树形框_进货日程)
        {
            方法_显示进货日程 (树形框_进货日程, 项目索引)
        }
        返回 (0)
    }

    方法 树形框_项目被选择 <接收事件 类型 = 整数 注释 = "当前选择项目被改变时产生此事件">
    参数 来源对象 <类型 = 树形框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    参数 选择方式 <类型 = 整数 注释 = "提供是如何操作导致当前选择项目被改变的:  0:键盘; 1:鼠标;  2:其它">
    {
        如果 (来源对象 == 树形框_进货日程)
        {
            如果真 (来源对象.取缩进层次 (来源对象.现行选中项) == 4)
            {
                方法_显示进货单据列表 (来源对象.取项目文本 (来源对象.现行选中项))


            }

        }
        返回 (0)
    }

    方法 超级列表框_左键单击表项 <接收事件 类型 = 整数 注释 = "  当用鼠标左键单击某表项时即产生此事件,接收到此事件后读取" 注释 = "\"现行选中项\"属性即可获得被单击表项的索引.">
    参数 来源对象 <类型 = 超级列表框 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级列表框_单据列表)
        {
            表格1.行数 = 1
            // SELECT `jhmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`jhmxb`.`进货数量` AS `进货数量` ,`jhmxb`.`进货价格` AS `进货价格` ,`jhmxb`.`合计金额` AS `合计金额`   FROM `jhmxb`,`spxx` WHERE spxx.`ID`=jhmxb.`商品ID` AND `jhmxb`.`单据ID`=7

            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            // SELECT `jhmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`jhmxb`.`进货数量` AS `进货数量` ,`jhmxb`.`进货价格` AS `进货价格` ,`jhmxb`.`合计金额` AS `合计金额`   FROM `jhmxb`,`spxx` WHERE spxx.`ID`=jhmxb.`商品ID` AND `jhmxb`.`单据ID`=7
            局部_语句 = "SELECT `jhmxb`.`ID` AS `ID` ,`spxx`.`商品编码` AS `商品编码` ,`spxx`.`商品名称` AS `商品名称` ,`spxx`.`规格型号` AS `规格型号` ,`jhmxb`.`进货数量` AS `进货数量` ,`jhmxb`.`进货价格` AS `进货价格` ,`jhmxb`.`合计金额` AS `合计金额`   FROM `jhmxb`,`spxx` WHERE spxx.`ID`=jhmxb.`商品ID` AND `jhmxb`.`单据ID`=" + 到文本 (超级列表框_单据列表.取表项数值 (超级列表框_单据列表.现行选中项))

            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            计次循环 ((整数)局部_记录集.行数)
            {
                局部_记录集.到下一行 ()
                表格1.行数 = 表格1.行数 + 1
                表格1.置数据 (表格1.行数 - 1, 0, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品编码"))
                表格1.置数据 (表格1.行数 - 1, 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
                表格1.置数据 (表格1.行数 - 1, 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
                表格1.置数据 (表格1.行数 - 1, 3, 表格常量.文本值型, 局部_记录集.读文本数据 ("进货数量"))
                表格1.置数据 (表格1.行数 - 1, 4, 表格常量.文本值型, 局部_记录集.读文本数据 ("进货价格"))
                表格1.置数据 (表格1.行数 - 1, 5, 表格常量.文本值型, 局部_记录集.读文本数据 ("合计金额"))

            }
            局部_记录集.关闭 ()


        }
        返回 (0)

    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_进货)
        {
            窗口_进货下单.创建窗口 (, , , , )


        }
        返回 (0)
    }

    方法 类_进货管理_尺寸被改变 <接收事件 类型 = 整数 注释 = "当本组件的尺寸被改变后发送此事件">
    参数 来源对象 <类型 = 类_进货管理 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        // 信息框 (到文本 (取程序 ().成员_宽度) + "---" + 到文本 (取程序 ().成员_高度), , )

        超级列表框_单据列表.宽度 = 取用户区宽度 () - 超级列表框_单据列表.左边 - 20
        树形框_进货日程.高度 = 取用户区高度 () - 树形框_进货日程.顶边 - 30
        表格1.左边 = 超级列表框_单据列表.左边
        表格1.宽度 = 超级列表框_单据列表.宽度
        表格1.顶边 = 超级列表框_单据列表.高度 + 超级列表框_单据列表.顶边 + 10
        表格1.高度 = 树形框_进货日程.高度 - 超级列表框_单据列表.高度 - 10
        标签_紫色1.宽度 = (整数)((取用户区宽度 () - 标签_橙色1.左边 - 20 - 40 * 3) / 4.0)
        标签_紫色2.宽度 = 标签_紫色1.宽度
        标签_绿色1.宽度 = 标签_紫色1.宽度
        标签_绿色2.宽度 = 标签_紫色1.宽度
        标签_蓝色1.宽度 = 标签_紫色1.宽度
        标签_蓝色2.宽度 = 标签_紫色1.宽度
        标签_橙色1.宽度 = 标签_紫色1.宽度
        标签_橙色2.宽度 = 标签_紫色1.宽度
        标签_蓝色1.左边 = 标签_橙色1.左边 + 标签_橙色1.宽度 + 40
        标签_蓝色2.左边 = 标签_蓝色1.左边
        标签_绿色1.左边 = 标签_蓝色1.左边 + 标签_蓝色1.宽度 + 40
        标签_绿色2.左边 = 标签_绿色1.左边
        标签_紫色1.左边 = 取用户区宽度 () - 标签_紫色1.宽度 - 20
        标签_紫色2.左边 = 标签_紫色1.左边

        返回 (0)
    }
}

类 类_进货下单 <公开 基础类 = 窗口 隐藏值属性 = "0" @视窗.布局 = "client_size = \"1024, 516\"">
{
    变量 超级按钮_关闭 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 101\r\npos = \"920, 447, 96, 32\"" 标题 = "关闭"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_保存 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 102\r\npos = \"794, 447, 96, 32\"" 标题 = "保存"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 编辑框_存放仓库 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 103\r\npos = \"448, 55, 568, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签1 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 104\r\npos = \"8, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "单据号">
    变量 编辑框_经手人 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 105\r\npos = \"807, 15, 209, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 标签2 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 106\r\npos = \"701, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "经手人">
    变量 标签4 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 107\r\npos = \"341, 15, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "供应商">
    变量 组合框_供应商 <类型 = 组合框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 108\r\npos = \"448, 15, 224, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" "类型" = 不可编辑下拉式>
    变量 标签5 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 109\r\npos = \"8, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "进货日期">
    变量 日期框_进货日期 <类型 = 日期框 隐藏值属性 = "0" @视窗.布局 = "id = 110\r\npos = \"124, 55, 193, 32\"">
    变量 编辑框_合计金额 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 111\r\npos = \"242, 447, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 假 输入方式 = 只读方式>
    变量 标签7 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 112\r\npos = \"341, 55, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "存放仓库">
    变量 表格1 <类型 = 表格 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 113\r\npos = \"8, 103, 1008, 336\"" 表格线颜色 = 0xFF8800
            背景颜色 = 0xFFFFFF 表头行数 = 1 表头列数 = 0 是否可编辑 = 真 行数 = 1 列数 = 8 列宽 = 80 行高 = 30 显示表格线 = 横纵线 选择整行 = 真>
    变量 标签8 <类型 = 标签 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 114\r\npos = \"125, 447, 104, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 标题 = "合计金额">
    变量 编辑框_单据号 <类型 = 编辑框 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 115\r\npos = \"124, 15, 193, 32\""
            字体 = "微软雅黑, 16, 0, 0, 0, 0, 0" 禁止 = 真>
    变量 超级按钮_删除行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 116\r\npos = \"53, 447, 32, 32\"" 标题 = "－"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">
    变量 超级按钮_添加行 <类型 = 超级按钮 折叠2 隐藏值属性 = "0" @视窗.布局 = "id = 117\r\npos = \"8, 447, 32, 32\"" 标题 = "＋"
            使用默认色 = 假 通常前景色 = 0xFFFFFF 通常背景色 = 0xA78227 点燃背景色 = 0xCF8227 焦点背景色 = 0xBB8227 点燃前景色 = 0x00FFFF
            焦点前景色 = 0x00D8D8 字体 = "微软雅黑, 16, 0, 0, 0, 0, 0">

    #

    方法 类_进货下单_创建完毕 <接收事件 类型 = 整数 注释 = "当本组件及其中所有子组件均被创建完毕后发送此事件.">
    参数 来源对象 <类型 = 类_进货下单 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {

        变量 局部_语句 <类型 = 文本型>
        变量 局部_语句1 <类型 = 文本型>
        变量 局部_文件 <类型 = 视窗文件资源 值 = "..\\..\\tmp.bmp">
        局部_语句 = "INSERT INTO `kh` set `客户名称`='测试',`客户LOGO`='%s',`添加时间`=now()"
        调试输出 (局部_语句)

        加入格式文本 (局部_语句1, 局部_语句, 取程序 ().数据库_全局Mysql库.到Mysql数据 (到字节集 (局部_文件)))
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句1) == 假)
        {
            信息框 ("保存客户失败", , )
            返回 (0)

        }



        返回 (0)











        方法_获取供应商 (组合框_供应商)
        编辑框_单据号.内容 = 方法_生成单据号 ()

        表格1.列数 = 7
        表格1.列宽 = 150
        表格1.置数据 (0, 0, 表格常量.文本值型, "商品编码")
        表格1.置数据 (0, 1, 表格常量.文本值型, "商品名称")
        表格1.置数据 (0, 2, 表格常量.文本值型, "规格型号")
        表格1.置数据 (0, 3, 表格常量.文本值型, "进货数量")
        表格1.置数据 (0, 4, 表格常量.文本值型, "进货价格")
        表格1.置数据 (0, 5, 表格常量.文本值型, "合计金额")
        表格1.置数据 (0, 6, 表格常量.文本值型, "商品ID")
        表格1.置列宽 (6, 0)

        表格1.置列类型 (3, 表格常量.数值型)
        表格1.置列类型 (4, 表格常量.货币型)
        表格1.置列类型 (5, 表格常量.货币型)
        表格1.置计算公式 (3, 4, 表格常量.乘, 5)


        返回 (0)
    }

    方法 方法_获取供应商
    参数 参数_组合框 <类型 = 组合框>
    {

        变量 局部_记录集 <类型 = Mysql记录集类>
        如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select * from `gys`") == 假)
        {
            信息框 ("查询失败", , )
            销毁 ()
            返回
        }
        局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
        调试输出 (局部_记录集.行数)
        参数_组合框.清空 ()
        计次循环 ((整数)局部_记录集.行数)
        {
            局部_记录集.到下一行 ()
            调试输出 (局部_记录集.读文本数据 ("供应商名称"))
            参数_组合框.加入项目 (局部_记录集.读文本数据 ("供应商名称"), 局部_记录集.读整数数据 ("ID"))

        }
        局部_记录集.关闭 ()




    }

    方法 方法_生成单据号 <类型 = 文本型>
    {
        变量 局部_单据号 <类型 = 文本型>
        局部_单据号 = 到文本 (取年份 (取现行时间 ())) + 取文本右边 ("0" + 到文本 (取月份 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取日 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取小时 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取分钟 (取现行时间 ())), 2) + 取文本右边 ("0" + 到文本 (取秒 (取现行时间 ())), 2) + 到文本 (取随机数 (10000, 99999))

        返回 (局部_单据号)
    }

    方法 超级按钮_被单击 <接收事件 类型 = 整数 注释 = "当按钮被单击后发送此事件">
    参数 来源对象 <类型 = 超级按钮 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 超级按钮_删除行)
        {

            表格1.删除行 (表格1.取光标行号 ())

        }
        否则 (来源对象 == 超级按钮_添加行)
        {
            表格1.行数 = 表格1.行数 + 1

        }
        否则 (来源对象 == 超级按钮_保存)
        {

            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "INSERT INTO `jhb` set `单据号`='" + 编辑框_单据号.内容 + "',`供应商ID`=" + 到文本 (组合框_供应商.取项目数值 (组合框_供应商.现行选中项)) + ",`存放仓库`='" + 编辑框_存放仓库.内容 + "',`进货日期`='" + 到文本 (取年份 (日期框_进货日期.今天)) + 取文本右边 ("0" + 到文本 (取月份 (日期框_进货日期.今天)), 2) + 取文本右边 ("0" + 到文本 (取日 (日期框_进货日期.今天)), 2) + "',`合计金额`=" + 到文本 (文本到整数 (编辑框_合计金额.内容)) + ",`经手人`='" + 编辑框_经手人.内容 + "',`添加时间`=now()"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("保存入库单失败", , )
                返回 (0)

            }
            变量 局部_单据ID <类型 = 长整数>
            局部_单据ID = 取程序 ().数据库_全局Mysql库.取自增值 ()

            // select last_insert_id()
            计次循环 (表格1.行数 - 1)
            {
                局部_语句 = "INSERT INTO `jhmxb` set `单据ID`=" + 到文本 (局部_单据ID) + ",`商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6)) + ",`进货数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`进货价格`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 4)) + ",`合计金额`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 5))
                调试输出 (局部_语句)

                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("保存入库单明细失败", , )
                    返回 (0)
                }


                变量 局部_记录集 <类型 = Mysql记录集类>
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 ("select ID as `总数` from `kcb` where `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6))) == 假)
                {
                    信息框 ("查询失败", , )
                    返回 (0)
                }
                局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
                调试输出 (局部_记录集.行数)

                如果 (局部_记录集.行数 == 0)
                {
                    局部_语句 = "INSERT INTO `kcb` set `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6)) + ",`入库数`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`库存数量`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`添加时间`=now()"
                }
                否则
                {
                    局部_语句 = "update  `kcb` set `入库数`=`入库数`+" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`库存数量`=`库存数量`+" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 3)) + ",`修改时间`=now() where `商品ID`=" + 到文本 (表格1.取文本数据 (取循环索引 () + 1, 6))

                }
                局部_记录集.关闭 ()

                调试输出 (局部_语句)
                如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
                {
                    信息框 ("保存库存信息失败", , )
                    返回 (0)
                }

                // Create Table
                // CREATE TABLE `jhmxb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据ID` bigint(11) DEFAULT NULL,  `商品ID` bigint(11) DEFAULT NULL,  `进货数量` bigint(11) DEFAULT NULL,  `进货价格` double(8,2) DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  PRIMARY KEY (`ID`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin


            }
            信息框 ("保存进货订单成功", , )
            编辑框_单据号.内容 = 方法_生成单据号 ()
            返回 (0)

            // Create Table
            // CREATE TABLE `jhb` (  `ID` bigint(11) NOT NULL AUTO_INCREMENT,  `单据号` varchar(255) COLLATE gbk_bin NOT NULL,  `供应商ID` bigint(11) DEFAULT NULL,  `存放仓库` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `进货日期` date DEFAULT NULL,  `合计金额` double(8,2) DEFAULT NULL,  `经手人` varchar(255) COLLATE gbk_bin DEFAULT NULL,  `添加时间` datetime DEFAULT NULL,  `修改时间` datetime DEFAULT NULL,  `备注` text COLLATE gbk_bin,  PRIMARY KEY (`ID`,`单据号`)) ENGINE=MyISAM DEFAULT CHARSET=gbk COLLATE=gbk_bin




        }
        否则 (来源对象 == 超级按钮_关闭)
        {
            销毁 ()

        }
        返回 (0)
    }

    方法 表格_结束编辑 <接收事件 类型 = 整数 注释 = "当单元格编辑结束之后产生此事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {
            // 6954767410388
            变量 局部_记录集 <类型 = Mysql记录集类>
            变量 局部_语句 <类型 = 文本型>
            局部_语句 = "select * from `spxx` where `商品编码`='" + 表格1.取文本数据 (表格1.取光标行号 (), 表格1.取光标列号 ()) + "'"
            调试输出 (局部_语句)
            如果真 (取程序 ().数据库_全局Mysql库.执行SQL语句 (局部_语句) == 假)
            {
                信息框 ("查询失败", , )
                返回 (0)
            }
            局部_记录集 = 取程序 ().数据库_全局Mysql库.取记录集 ()
            调试输出 (局部_记录集.行数)
            如果真 (局部_记录集.行数 == 1)
            {
                局部_记录集.到下一行 ()
                表格1.置数据 (表格1.取光标行号 (), 1, 表格常量.文本值型, 局部_记录集.读文本数据 ("商品名称"))
                表格1.置数据 (表格1.取光标行号 (), 2, 表格常量.文本值型, 局部_记录集.读文本数据 ("规格型号"))
                表格1.置数据 (表格1.取光标行号 (), 6, 表格常量.文本值型, 到文本 (局部_记录集.读整数数据 ("ID")))
                表格1.置数据 (表格1.取光标行号 (), 4, 表格常量.文本值型, 到文本 (局部_记录集.读小数数据 ("入库价")))

            }
            局部_记录集.关闭 ()
            变量 局部_合计 <类型 = 小数>
            计次循环 (表格1.行数 - 1)
            {
                局部_合计 = 局部_合计 + 文本到小数 (表格1.取文本数据 (取循环索引 () + 1, 5))
            }
            编辑框_合计金额.内容 = 到文本 (局部_合计)


        }
        返回 (0)
    }

    方法 表格_光标位置改变 <接收事件 类型 = 整数 注释 = "当用户更改了当前被选择单元时会产生本事件">
    参数 来源对象 <类型 = 表格 注释 = "提供事件产生的具体来源对象">
    参数 标记值 <类型 = 整数 注释 = "用户调用\"挂接事件\"命令时所提供的\"标记值\"参数值,非此方式挂接事件则本参数值固定为0.">
    {
        如果 (来源对象 == 表格1)
        {

        }
        返回 (0)
    }
}
